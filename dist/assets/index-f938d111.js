function Tx(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function xx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Kf={},bx={get exports(){return Kf},set exports(t){Kf=t}},Hc={},J={},Sx={get exports(){return J},set exports(t){J=t}},Y={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sa=Symbol.for("react.element"),Px=Symbol.for("react.portal"),Ax=Symbol.for("react.fragment"),Cx=Symbol.for("react.strict_mode"),Lx=Symbol.for("react.profiler"),Mx=Symbol.for("react.provider"),Ix=Symbol.for("react.context"),Rx=Symbol.for("react.forward_ref"),Ox=Symbol.for("react.suspense"),kx=Symbol.for("react.memo"),Nx=Symbol.for("react.lazy"),Yp=Symbol.iterator;function Fx(t){return t===null||typeof t!="object"?null:(t=Yp&&t[Yp]||t["@@iterator"],typeof t=="function"?t:null)}var Zv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kv=Object.assign,Qv={};function Es(t,e,n){this.props=t,this.context=e,this.refs=Qv,this.updater=n||Zv}Es.prototype.isReactComponent={};Es.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Es.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jv(){}Jv.prototype=Es.prototype;function Rd(t,e,n){this.props=t,this.context=e,this.refs=Qv,this.updater=n||Zv}var Od=Rd.prototype=new Jv;Od.constructor=Rd;Kv(Od,Es.prototype);Od.isPureReactComponent=!0;var qp=Array.isArray,e_=Object.prototype.hasOwnProperty,kd={current:null},t_={key:!0,ref:!0,__self:!0,__source:!0};function n_(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)e_.call(e,r)&&!t_.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:sa,type:t,key:s,ref:o,props:i,_owner:kd.current}}function Dx(t,e){return{$$typeof:sa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Nd(t){return typeof t=="object"&&t!==null&&t.$$typeof===sa}function zx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Zp=/\/+/g;function Gu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?zx(""+t.key):e.toString(36)}function xl(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case sa:case Px:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Gu(o,0):r,qp(i)?(n="",t!=null&&(n=t.replace(Zp,"$&/")+"/"),xl(i,e,n,"",function(c){return c})):i!=null&&(Nd(i)&&(i=Dx(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Zp,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",qp(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Gu(s,a);o+=xl(s,e,n,l,i)}else if(l=Fx(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Gu(s,a++),o+=xl(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Oa(t,e,n){if(t==null)return t;var r=[],i=0;return xl(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Ux(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var at={current:null},bl={transition:null},Bx={ReactCurrentDispatcher:at,ReactCurrentBatchConfig:bl,ReactCurrentOwner:kd};Y.Children={map:Oa,forEach:function(t,e,n){Oa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Oa(t,function(){e++}),e},toArray:function(t){return Oa(t,function(e){return e})||[]},only:function(t){if(!Nd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Y.Component=Es;Y.Fragment=Ax;Y.Profiler=Lx;Y.PureComponent=Rd;Y.StrictMode=Cx;Y.Suspense=Ox;Y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bx;Y.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Kv({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=kd.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)e_.call(e,l)&&!t_.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:sa,type:t.type,key:i,ref:s,props:r,_owner:o}};Y.createContext=function(t){return t={$$typeof:Ix,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Mx,_context:t},t.Consumer=t};Y.createElement=n_;Y.createFactory=function(t){var e=n_.bind(null,t);return e.type=t,e};Y.createRef=function(){return{current:null}};Y.forwardRef=function(t){return{$$typeof:Rx,render:t}};Y.isValidElement=Nd;Y.lazy=function(t){return{$$typeof:Nx,_payload:{_status:-1,_result:t},_init:Ux}};Y.memo=function(t,e){return{$$typeof:kx,type:t,compare:e===void 0?null:e}};Y.startTransition=function(t){var e=bl.transition;bl.transition={};try{t()}finally{bl.transition=e}};Y.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Y.useCallback=function(t,e){return at.current.useCallback(t,e)};Y.useContext=function(t){return at.current.useContext(t)};Y.useDebugValue=function(){};Y.useDeferredValue=function(t){return at.current.useDeferredValue(t)};Y.useEffect=function(t,e){return at.current.useEffect(t,e)};Y.useId=function(){return at.current.useId()};Y.useImperativeHandle=function(t,e,n){return at.current.useImperativeHandle(t,e,n)};Y.useInsertionEffect=function(t,e){return at.current.useInsertionEffect(t,e)};Y.useLayoutEffect=function(t,e){return at.current.useLayoutEffect(t,e)};Y.useMemo=function(t,e){return at.current.useMemo(t,e)};Y.useReducer=function(t,e,n){return at.current.useReducer(t,e,n)};Y.useRef=function(t){return at.current.useRef(t)};Y.useState=function(t){return at.current.useState(t)};Y.useSyncExternalStore=function(t,e,n){return at.current.useSyncExternalStore(t,e,n)};Y.useTransition=function(){return at.current.useTransition()};Y.version="18.2.0";(function(t){t.exports=Y})(Sx);const Vx=xx(J);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jx=J,Gx=Symbol.for("react.element"),Wx=Symbol.for("react.fragment"),Hx=Object.prototype.hasOwnProperty,$x=jx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xx={key:!0,ref:!0,__self:!0,__source:!0};function r_(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Hx.call(e,r)&&!Xx.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Gx,type:t,key:s,ref:o,props:i,_owner:$x.current}}Hc.Fragment=Wx;Hc.jsx=r_;Hc.jsxs=r_;(function(t){t.exports=Hc})(bx);const Zt=Kf.jsx;var Qf={},Jf={},Yx={get exports(){return Jf},set exports(t){Jf=t}},At={},eh={},qx={get exports(){return eh},set exports(t){eh=t}},i_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,j){var W=D.length;D.push(j);e:for(;0<W;){var ge=W-1>>>1,fe=D[ge];if(0<i(fe,j))D[ge]=j,D[W]=fe,W=ge;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var j=D[0],W=D.pop();if(W!==j){D[0]=W;e:for(var ge=0,fe=D.length,hi=fe>>>1;ge<hi;){var Vt=2*(ge+1)-1,Ls=D[Vt],Tn=Vt+1,be=D[Tn];if(0>i(Ls,W))Tn<fe&&0>i(be,Ls)?(D[ge]=be,D[Tn]=W,ge=Tn):(D[ge]=Ls,D[Vt]=W,ge=Vt);else if(Tn<fe&&0>i(be,W))D[ge]=be,D[Tn]=W,ge=Tn;else break e}}return j}function i(D,j){var W=D.sortIndex-j.sortIndex;return W!==0?W:D.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,f=null,h=3,d=!1,p=!1,m=!1,T=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(D){for(var j=n(c);j!==null;){if(j.callback===null)r(c);else if(j.startTime<=D)r(c),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(c)}}function x(D){if(m=!1,w(D),!p)if(n(l)!==null)p=!0,Cs(S);else{var j=n(c);j!==null&&fi(x,j.startTime-D)}}function S(D,j){p=!1,m&&(m=!1,v(M),M=-1),d=!0;var W=h;try{for(w(j),f=n(l);f!==null&&(!(f.expirationTime>j)||D&&!B());){var ge=f.callback;if(typeof ge=="function"){f.callback=null,h=f.priorityLevel;var fe=ge(f.expirationTime<=j);j=t.unstable_now(),typeof fe=="function"?f.callback=fe:f===n(l)&&r(l),w(j)}else r(l);f=n(l)}if(f!==null)var hi=!0;else{var Vt=n(c);Vt!==null&&fi(x,Vt.startTime-j),hi=!1}return hi}finally{f=null,h=W,d=!1}}var P=!1,C=null,M=-1,O=5,I=-1;function B(){return!(t.unstable_now()-I<O)}function G(){if(C!==null){var D=t.unstable_now();I=D;var j=!0;try{j=C(!0,D)}finally{j?V():(P=!1,C=null)}}else P=!1}var V;if(typeof y=="function")V=function(){y(G)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,Bt=q.port2;q.port1.onmessage=G,V=function(){Bt.postMessage(null)}}else V=function(){T(G,0)};function Cs(D){C=D,P||(P=!0,V())}function fi(D,j){M=T(function(){D(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){p||d||(p=!0,Cs(S))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(D){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var W=h;h=j;try{return D()}finally{h=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,j){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var W=h;h=D;try{return j()}finally{h=W}},t.unstable_scheduleCallback=function(D,j,W){var ge=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ge+W:ge):W=ge,D){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=W+fe,D={id:u++,callback:j,priorityLevel:D,startTime:W,expirationTime:fe,sortIndex:-1},W>ge?(D.sortIndex=W,e(c,D),n(l)===null&&D===n(c)&&(m?(v(M),M=-1):m=!0,fi(x,W-ge))):(D.sortIndex=fe,e(l,D),p||d||(p=!0,Cs(S))),D},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(D){var j=h;return function(){var W=h;h=j;try{return D.apply(this,arguments)}finally{h=W}}}})(i_);(function(t){t.exports=i_})(qx);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s_=J,Pt=eh;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o_=new Set,Ao={};function ri(t,e){ss(t,e),ss(t+"Capture",e)}function ss(t,e){for(Ao[t]=e,t=0;t<e.length;t++)o_.add(e[t])}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),th=Object.prototype.hasOwnProperty,Zx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Kp={},Qp={};function Kx(t){return th.call(Qp,t)?!0:th.call(Kp,t)?!1:Zx.test(t)?Qp[t]=!0:(Kp[t]=!0,!1)}function Qx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Jx(t,e,n,r){if(e===null||typeof e>"u"||Qx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function lt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var We={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){We[t]=new lt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];We[e]=new lt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){We[t]=new lt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){We[t]=new lt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){We[t]=new lt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){We[t]=new lt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){We[t]=new lt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){We[t]=new lt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){We[t]=new lt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Fd=/[\-:]([a-z])/g;function Dd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Fd,Dd);We[e]=new lt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Fd,Dd);We[e]=new lt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Fd,Dd);We[e]=new lt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){We[t]=new lt(t,1,!1,t.toLowerCase(),null,!1,!1)});We.xlinkHref=new lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){We[t]=new lt(t,1,!1,t.toLowerCase(),null,!0,!0)});function zd(t,e,n,r){var i=We.hasOwnProperty(e)?We[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Jx(e,n,i,r)&&(n=null),r||i===null?Kx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var $n=s_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ka=Symbol.for("react.element"),Mi=Symbol.for("react.portal"),Ii=Symbol.for("react.fragment"),Ud=Symbol.for("react.strict_mode"),nh=Symbol.for("react.profiler"),a_=Symbol.for("react.provider"),l_=Symbol.for("react.context"),Bd=Symbol.for("react.forward_ref"),rh=Symbol.for("react.suspense"),ih=Symbol.for("react.suspense_list"),Vd=Symbol.for("react.memo"),rr=Symbol.for("react.lazy"),c_=Symbol.for("react.offscreen"),Jp=Symbol.iterator;function Ds(t){return t===null||typeof t!="object"?null:(t=Jp&&t[Jp]||t["@@iterator"],typeof t=="function"?t:null)}var ve=Object.assign,Wu;function no(t){if(Wu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wu=e&&e[1]||""}return`
`+Wu+t}var Hu=!1;function $u(t,e){if(!t||Hu)return"";Hu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Hu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?no(t):""}function eb(t){switch(t.tag){case 5:return no(t.type);case 16:return no("Lazy");case 13:return no("Suspense");case 19:return no("SuspenseList");case 0:case 2:case 15:return t=$u(t.type,!1),t;case 11:return t=$u(t.type.render,!1),t;case 1:return t=$u(t.type,!0),t;default:return""}}function sh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ii:return"Fragment";case Mi:return"Portal";case nh:return"Profiler";case Ud:return"StrictMode";case rh:return"Suspense";case ih:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case l_:return(t.displayName||"Context")+".Consumer";case a_:return(t._context.displayName||"Context")+".Provider";case Bd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Vd:return e=t.displayName||null,e!==null?e:sh(t.type)||"Memo";case rr:e=t._payload,t=t._init;try{return sh(t(e))}catch{}}return null}function tb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sh(e);case 8:return e===Ud?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function u_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function nb(t){var e=u_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Na(t){t._valueTracker||(t._valueTracker=nb(t))}function f_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=u_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ql(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function oh(t,e){var n=e.checked;return ve({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function em(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=wr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function h_(t,e){e=e.checked,e!=null&&zd(t,"checked",e,!1)}function ah(t,e){h_(t,e);var n=wr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?lh(t,e.type,n):e.hasOwnProperty("defaultValue")&&lh(t,e.type,wr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function tm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function lh(t,e,n){(e!=="number"||Ql(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ro=Array.isArray;function Yi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+wr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ch(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return ve({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function nm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(ro(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:wr(n)}}function d_(t,e){var n=wr(e.value),r=wr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function rm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function g_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?g_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fa,p_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Fa=Fa||document.createElement("div"),Fa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Co(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var co={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rb=["Webkit","ms","Moz","O"];Object.keys(co).forEach(function(t){rb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),co[e]=co[t]})});function m_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||co.hasOwnProperty(t)&&co[t]?(""+e).trim():e+"px"}function y_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=m_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var ib=ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fh(t,e){if(e){if(ib[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function hh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dh=null;function jd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gh=null,qi=null,Zi=null;function im(t){if(t=la(t)){if(typeof gh!="function")throw Error(R(280));var e=t.stateNode;e&&(e=Zc(e),gh(t.stateNode,t.type,e))}}function v_(t){qi?Zi?Zi.push(t):Zi=[t]:qi=t}function __(){if(qi){var t=qi,e=Zi;if(Zi=qi=null,im(t),e)for(t=0;t<e.length;t++)im(e[t])}}function w_(t,e){return t(e)}function E_(){}var Xu=!1;function T_(t,e,n){if(Xu)return t(e,n);Xu=!0;try{return w_(t,e,n)}finally{Xu=!1,(qi!==null||Zi!==null)&&(E_(),__())}}function Lo(t,e){var n=t.stateNode;if(n===null)return null;var r=Zc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var ph=!1;if(Fn)try{var zs={};Object.defineProperty(zs,"passive",{get:function(){ph=!0}}),window.addEventListener("test",zs,zs),window.removeEventListener("test",zs,zs)}catch{ph=!1}function sb(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var uo=!1,Jl=null,ec=!1,mh=null,ob={onError:function(t){uo=!0,Jl=t}};function ab(t,e,n,r,i,s,o,a,l){uo=!1,Jl=null,sb.apply(ob,arguments)}function lb(t,e,n,r,i,s,o,a,l){if(ab.apply(this,arguments),uo){if(uo){var c=Jl;uo=!1,Jl=null}else throw Error(R(198));ec||(ec=!0,mh=c)}}function ii(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function x_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function sm(t){if(ii(t)!==t)throw Error(R(188))}function cb(t){var e=t.alternate;if(!e){if(e=ii(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return sm(i),t;if(s===r)return sm(i),e;s=s.sibling}throw Error(R(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(R(189))}}if(n.alternate!==r)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function b_(t){return t=cb(t),t!==null?S_(t):null}function S_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=S_(t);if(e!==null)return e;t=t.sibling}return null}var P_=Pt.unstable_scheduleCallback,om=Pt.unstable_cancelCallback,ub=Pt.unstable_shouldYield,fb=Pt.unstable_requestPaint,xe=Pt.unstable_now,hb=Pt.unstable_getCurrentPriorityLevel,Gd=Pt.unstable_ImmediatePriority,A_=Pt.unstable_UserBlockingPriority,tc=Pt.unstable_NormalPriority,db=Pt.unstable_LowPriority,C_=Pt.unstable_IdlePriority,$c=null,yn=null;function gb(t){if(yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot($c,t,void 0,(t.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:yb,pb=Math.log,mb=Math.LN2;function yb(t){return t>>>=0,t===0?32:31-(pb(t)/mb|0)|0}var Da=64,za=4194304;function io(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function nc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=io(a):(s&=o,s!==0&&(r=io(s)))}else o=n&~i,o!==0?r=io(o):s!==0&&(r=io(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Kt(e),i=1<<n,r|=t[n],e&=~i;return r}function vb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _b(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Kt(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=vb(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function yh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function L_(){var t=Da;return Da<<=1,!(Da&4194240)&&(Da=64),t}function Yu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function oa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kt(e),t[e]=n}function wb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Kt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Wd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Kt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ne=0;function M_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var I_,Hd,R_,O_,k_,vh=!1,Ua=[],fr=null,hr=null,dr=null,Mo=new Map,Io=new Map,sr=[],Eb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function am(t,e){switch(t){case"focusin":case"focusout":fr=null;break;case"dragenter":case"dragleave":hr=null;break;case"mouseover":case"mouseout":dr=null;break;case"pointerover":case"pointerout":Mo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Io.delete(e.pointerId)}}function Us(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=la(e),e!==null&&Hd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Tb(t,e,n,r,i){switch(e){case"focusin":return fr=Us(fr,t,e,n,r,i),!0;case"dragenter":return hr=Us(hr,t,e,n,r,i),!0;case"mouseover":return dr=Us(dr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Mo.set(s,Us(Mo.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Io.set(s,Us(Io.get(s)||null,t,e,n,r,i)),!0}return!1}function N_(t){var e=zr(t.target);if(e!==null){var n=ii(e);if(n!==null){if(e=n.tag,e===13){if(e=x_(n),e!==null){t.blockedOn=e,k_(t.priority,function(){R_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=_h(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);dh=r,n.target.dispatchEvent(r),dh=null}else return e=la(n),e!==null&&Hd(e),t.blockedOn=n,!1;e.shift()}return!0}function lm(t,e,n){Sl(t)&&n.delete(e)}function xb(){vh=!1,fr!==null&&Sl(fr)&&(fr=null),hr!==null&&Sl(hr)&&(hr=null),dr!==null&&Sl(dr)&&(dr=null),Mo.forEach(lm),Io.forEach(lm)}function Bs(t,e){t.blockedOn===e&&(t.blockedOn=null,vh||(vh=!0,Pt.unstable_scheduleCallback(Pt.unstable_NormalPriority,xb)))}function Ro(t){function e(i){return Bs(i,t)}if(0<Ua.length){Bs(Ua[0],t);for(var n=1;n<Ua.length;n++){var r=Ua[n];r.blockedOn===t&&(r.blockedOn=null)}}for(fr!==null&&Bs(fr,t),hr!==null&&Bs(hr,t),dr!==null&&Bs(dr,t),Mo.forEach(e),Io.forEach(e),n=0;n<sr.length;n++)r=sr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<sr.length&&(n=sr[0],n.blockedOn===null);)N_(n),n.blockedOn===null&&sr.shift()}var Ki=$n.ReactCurrentBatchConfig,rc=!0;function bb(t,e,n,r){var i=ne,s=Ki.transition;Ki.transition=null;try{ne=1,$d(t,e,n,r)}finally{ne=i,Ki.transition=s}}function Sb(t,e,n,r){var i=ne,s=Ki.transition;Ki.transition=null;try{ne=4,$d(t,e,n,r)}finally{ne=i,Ki.transition=s}}function $d(t,e,n,r){if(rc){var i=_h(t,e,n,r);if(i===null)sf(t,e,r,ic,n),am(t,r);else if(Tb(i,t,e,n,r))r.stopPropagation();else if(am(t,r),e&4&&-1<Eb.indexOf(t)){for(;i!==null;){var s=la(i);if(s!==null&&I_(s),s=_h(t,e,n,r),s===null&&sf(t,e,r,ic,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else sf(t,e,r,null,n)}}var ic=null;function _h(t,e,n,r){if(ic=null,t=jd(r),t=zr(t),t!==null)if(e=ii(t),e===null)t=null;else if(n=e.tag,n===13){if(t=x_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ic=t,null}function F_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hb()){case Gd:return 1;case A_:return 4;case tc:case db:return 16;case C_:return 536870912;default:return 16}default:return 16}}var ar=null,Xd=null,Pl=null;function D_(){if(Pl)return Pl;var t,e=Xd,n=e.length,r,i="value"in ar?ar.value:ar.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Pl=i.slice(t,1<r?1-r:void 0)}function Al(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ba(){return!0}function cm(){return!1}function Ct(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ba:cm,this.isPropagationStopped=cm,this}return ve(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),e}var Ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yd=Ct(Ts),aa=ve({},Ts,{view:0,detail:0}),Pb=Ct(aa),qu,Zu,Vs,Xc=ve({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Vs&&(Vs&&t.type==="mousemove"?(qu=t.screenX-Vs.screenX,Zu=t.screenY-Vs.screenY):Zu=qu=0,Vs=t),qu)},movementY:function(t){return"movementY"in t?t.movementY:Zu}}),um=Ct(Xc),Ab=ve({},Xc,{dataTransfer:0}),Cb=Ct(Ab),Lb=ve({},aa,{relatedTarget:0}),Ku=Ct(Lb),Mb=ve({},Ts,{animationName:0,elapsedTime:0,pseudoElement:0}),Ib=Ct(Mb),Rb=ve({},Ts,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ob=Ct(Rb),kb=ve({},Ts,{data:0}),fm=Ct(kb),Nb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Db={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Db[t])?!!e[t]:!1}function qd(){return zb}var Ub=ve({},aa,{key:function(t){if(t.key){var e=Nb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Al(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Fb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qd,charCode:function(t){return t.type==="keypress"?Al(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Al(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Bb=Ct(Ub),Vb=ve({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hm=Ct(Vb),jb=ve({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qd}),Gb=Ct(jb),Wb=ve({},Ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hb=Ct(Wb),$b=ve({},Xc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Xb=Ct($b),Yb=[9,13,27,32],Zd=Fn&&"CompositionEvent"in window,fo=null;Fn&&"documentMode"in document&&(fo=document.documentMode);var qb=Fn&&"TextEvent"in window&&!fo,z_=Fn&&(!Zd||fo&&8<fo&&11>=fo),dm=String.fromCharCode(32),gm=!1;function U_(t,e){switch(t){case"keyup":return Yb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function B_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ri=!1;function Zb(t,e){switch(t){case"compositionend":return B_(e);case"keypress":return e.which!==32?null:(gm=!0,dm);case"textInput":return t=e.data,t===dm&&gm?null:t;default:return null}}function Kb(t,e){if(Ri)return t==="compositionend"||!Zd&&U_(t,e)?(t=D_(),Pl=Xd=ar=null,Ri=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return z_&&e.locale!=="ko"?null:e.data;default:return null}}var Qb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Qb[t.type]:e==="textarea"}function V_(t,e,n,r){v_(r),e=sc(e,"onChange"),0<e.length&&(n=new Yd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ho=null,Oo=null;function Jb(t){Q_(t,0)}function Yc(t){var e=Ni(t);if(f_(e))return t}function eS(t,e){if(t==="change")return e}var j_=!1;if(Fn){var Qu;if(Fn){var Ju="oninput"in document;if(!Ju){var mm=document.createElement("div");mm.setAttribute("oninput","return;"),Ju=typeof mm.oninput=="function"}Qu=Ju}else Qu=!1;j_=Qu&&(!document.documentMode||9<document.documentMode)}function ym(){ho&&(ho.detachEvent("onpropertychange",G_),Oo=ho=null)}function G_(t){if(t.propertyName==="value"&&Yc(Oo)){var e=[];V_(e,Oo,t,jd(t)),T_(Jb,e)}}function tS(t,e,n){t==="focusin"?(ym(),ho=e,Oo=n,ho.attachEvent("onpropertychange",G_)):t==="focusout"&&ym()}function nS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Yc(Oo)}function rS(t,e){if(t==="click")return Yc(e)}function iS(t,e){if(t==="input"||t==="change")return Yc(e)}function sS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var en=typeof Object.is=="function"?Object.is:sS;function ko(t,e){if(en(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!th.call(e,i)||!en(t[i],e[i]))return!1}return!0}function vm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function _m(t,e){var n=vm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=vm(n)}}function W_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?W_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function H_(){for(var t=window,e=Ql();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ql(t.document)}return e}function Kd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function oS(t){var e=H_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&W_(n.ownerDocument.documentElement,n)){if(r!==null&&Kd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=_m(n,s);var o=_m(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var aS=Fn&&"documentMode"in document&&11>=document.documentMode,Oi=null,wh=null,go=null,Eh=!1;function wm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Eh||Oi==null||Oi!==Ql(r)||(r=Oi,"selectionStart"in r&&Kd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),go&&ko(go,r)||(go=r,r=sc(wh,"onSelect"),0<r.length&&(e=new Yd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Oi)))}function Va(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ki={animationend:Va("Animation","AnimationEnd"),animationiteration:Va("Animation","AnimationIteration"),animationstart:Va("Animation","AnimationStart"),transitionend:Va("Transition","TransitionEnd")},ef={},$_={};Fn&&($_=document.createElement("div").style,"AnimationEvent"in window||(delete ki.animationend.animation,delete ki.animationiteration.animation,delete ki.animationstart.animation),"TransitionEvent"in window||delete ki.transitionend.transition);function qc(t){if(ef[t])return ef[t];if(!ki[t])return t;var e=ki[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in $_)return ef[t]=e[n];return t}var X_=qc("animationend"),Y_=qc("animationiteration"),q_=qc("animationstart"),Z_=qc("transitionend"),K_=new Map,Em="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sr(t,e){K_.set(t,e),ri(e,[t])}for(var tf=0;tf<Em.length;tf++){var nf=Em[tf],lS=nf.toLowerCase(),cS=nf[0].toUpperCase()+nf.slice(1);Sr(lS,"on"+cS)}Sr(X_,"onAnimationEnd");Sr(Y_,"onAnimationIteration");Sr(q_,"onAnimationStart");Sr("dblclick","onDoubleClick");Sr("focusin","onFocus");Sr("focusout","onBlur");Sr(Z_,"onTransitionEnd");ss("onMouseEnter",["mouseout","mouseover"]);ss("onMouseLeave",["mouseout","mouseover"]);ss("onPointerEnter",["pointerout","pointerover"]);ss("onPointerLeave",["pointerout","pointerover"]);ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ri("onBeforeInput",["compositionend","keypress","textInput","paste"]);ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var so="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uS=new Set("cancel close invalid load scroll toggle".split(" ").concat(so));function Tm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,lb(r,e,void 0,t),t.currentTarget=null}function Q_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Tm(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Tm(i,a,c),s=l}}}if(ec)throw t=mh,ec=!1,mh=null,t}function le(t,e){var n=e[Ph];n===void 0&&(n=e[Ph]=new Set);var r=t+"__bubble";n.has(r)||(J_(e,t,2,!1),n.add(r))}function rf(t,e,n){var r=0;e&&(r|=4),J_(n,t,r,e)}var ja="_reactListening"+Math.random().toString(36).slice(2);function No(t){if(!t[ja]){t[ja]=!0,o_.forEach(function(n){n!=="selectionchange"&&(uS.has(n)||rf(n,!1,t),rf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ja]||(e[ja]=!0,rf("selectionchange",!1,e))}}function J_(t,e,n,r){switch(F_(e)){case 1:var i=bb;break;case 4:i=Sb;break;default:i=$d}n=i.bind(null,e,n,t),i=void 0,!ph||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function sf(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=zr(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}T_(function(){var c=s,u=jd(n),f=[];e:{var h=K_.get(t);if(h!==void 0){var d=Yd,p=t;switch(t){case"keypress":if(Al(n)===0)break e;case"keydown":case"keyup":d=Bb;break;case"focusin":p="focus",d=Ku;break;case"focusout":p="blur",d=Ku;break;case"beforeblur":case"afterblur":d=Ku;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=um;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=Cb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=Gb;break;case X_:case Y_:case q_:d=Ib;break;case Z_:d=Hb;break;case"scroll":d=Pb;break;case"wheel":d=Xb;break;case"copy":case"cut":case"paste":d=Ob;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=hm}var m=(e&4)!==0,T=!m&&t==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,w;y!==null;){w=y;var x=w.stateNode;if(w.tag===5&&x!==null&&(w=x,v!==null&&(x=Lo(y,v),x!=null&&m.push(Fo(y,x,w)))),T)break;y=y.return}0<m.length&&(h=new d(h,p,null,n,u),f.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",h&&n!==dh&&(p=n.relatedTarget||n.fromElement)&&(zr(p)||p[Dn]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(p=n.relatedTarget||n.toElement,d=c,p=p?zr(p):null,p!==null&&(T=ii(p),p!==T||p.tag!==5&&p.tag!==6)&&(p=null)):(d=null,p=c),d!==p)){if(m=um,x="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=hm,x="onPointerLeave",v="onPointerEnter",y="pointer"),T=d==null?h:Ni(d),w=p==null?h:Ni(p),h=new m(x,y+"leave",d,n,u),h.target=T,h.relatedTarget=w,x=null,zr(u)===c&&(m=new m(v,y+"enter",p,n,u),m.target=w,m.relatedTarget=T,x=m),T=x,d&&p)t:{for(m=d,v=p,y=0,w=m;w;w=gi(w))y++;for(w=0,x=v;x;x=gi(x))w++;for(;0<y-w;)m=gi(m),y--;for(;0<w-y;)v=gi(v),w--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=gi(m),v=gi(v)}m=null}else m=null;d!==null&&xm(f,h,d,m,!1),p!==null&&T!==null&&xm(f,T,p,m,!0)}}e:{if(h=c?Ni(c):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var S=eS;else if(pm(h))if(j_)S=iS;else{S=nS;var P=tS}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=rS);if(S&&(S=S(t,c))){V_(f,S,n,u);break e}P&&P(t,h,c),t==="focusout"&&(P=h._wrapperState)&&P.controlled&&h.type==="number"&&lh(h,"number",h.value)}switch(P=c?Ni(c):window,t){case"focusin":(pm(P)||P.contentEditable==="true")&&(Oi=P,wh=c,go=null);break;case"focusout":go=wh=Oi=null;break;case"mousedown":Eh=!0;break;case"contextmenu":case"mouseup":case"dragend":Eh=!1,wm(f,n,u);break;case"selectionchange":if(aS)break;case"keydown":case"keyup":wm(f,n,u)}var C;if(Zd)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Ri?U_(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(z_&&n.locale!=="ko"&&(Ri||M!=="onCompositionStart"?M==="onCompositionEnd"&&Ri&&(C=D_()):(ar=u,Xd="value"in ar?ar.value:ar.textContent,Ri=!0)),P=sc(c,M),0<P.length&&(M=new fm(M,t,null,n,u),f.push({event:M,listeners:P}),C?M.data=C:(C=B_(n),C!==null&&(M.data=C)))),(C=qb?Zb(t,n):Kb(t,n))&&(c=sc(c,"onBeforeInput"),0<c.length&&(u=new fm("onBeforeInput","beforeinput",null,n,u),f.push({event:u,listeners:c}),u.data=C))}Q_(f,e)})}function Fo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function sc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Lo(t,n),s!=null&&r.unshift(Fo(t,s,i)),s=Lo(t,e),s!=null&&r.push(Fo(t,s,i))),t=t.return}return r}function gi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function xm(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Lo(n,s),l!=null&&o.unshift(Fo(n,l,a))):i||(l=Lo(n,s),l!=null&&o.push(Fo(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var fS=/\r\n?/g,hS=/\u0000|\uFFFD/g;function bm(t){return(typeof t=="string"?t:""+t).replace(fS,`
`).replace(hS,"")}function Ga(t,e,n){if(e=bm(e),bm(t)!==e&&n)throw Error(R(425))}function oc(){}var Th=null,xh=null;function bh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sh=typeof setTimeout=="function"?setTimeout:void 0,dS=typeof clearTimeout=="function"?clearTimeout:void 0,Sm=typeof Promise=="function"?Promise:void 0,gS=typeof queueMicrotask=="function"?queueMicrotask:typeof Sm<"u"?function(t){return Sm.resolve(null).then(t).catch(pS)}:Sh;function pS(t){setTimeout(function(){throw t})}function of(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ro(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ro(e)}function gr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Pm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var xs=Math.random().toString(36).slice(2),gn="__reactFiber$"+xs,Do="__reactProps$"+xs,Dn="__reactContainer$"+xs,Ph="__reactEvents$"+xs,mS="__reactListeners$"+xs,yS="__reactHandles$"+xs;function zr(t){var e=t[gn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Dn]||n[gn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Pm(t);t!==null;){if(n=t[gn])return n;t=Pm(t)}return e}t=n,n=t.parentNode}return null}function la(t){return t=t[gn]||t[Dn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ni(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function Zc(t){return t[Do]||null}var Ah=[],Fi=-1;function Pr(t){return{current:t}}function ue(t){0>Fi||(t.current=Ah[Fi],Ah[Fi]=null,Fi--)}function oe(t,e){Fi++,Ah[Fi]=t.current,t.current=e}var Er={},et=Pr(Er),ht=Pr(!1),$r=Er;function os(t,e){var n=t.type.contextTypes;if(!n)return Er;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function dt(t){return t=t.childContextTypes,t!=null}function ac(){ue(ht),ue(et)}function Am(t,e,n){if(et.current!==Er)throw Error(R(168));oe(et,e),oe(ht,n)}function e1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(R(108,tb(t)||"Unknown",i));return ve({},n,r)}function lc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Er,$r=et.current,oe(et,t),oe(ht,ht.current),!0}function Cm(t,e,n){var r=t.stateNode;if(!r)throw Error(R(169));n?(t=e1(t,e,$r),r.__reactInternalMemoizedMergedChildContext=t,ue(ht),ue(et),oe(et,t)):ue(ht),oe(ht,n)}var Ln=null,Kc=!1,af=!1;function t1(t){Ln===null?Ln=[t]:Ln.push(t)}function vS(t){Kc=!0,t1(t)}function Ar(){if(!af&&Ln!==null){af=!0;var t=0,e=ne;try{var n=Ln;for(ne=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ln=null,Kc=!1}catch(i){throw Ln!==null&&(Ln=Ln.slice(t+1)),P_(Gd,Ar),i}finally{ne=e,af=!1}}return null}var Di=[],zi=0,cc=null,uc=0,Ot=[],kt=0,Xr=null,In=1,Rn="";function Nr(t,e){Di[zi++]=uc,Di[zi++]=cc,cc=t,uc=e}function n1(t,e,n){Ot[kt++]=In,Ot[kt++]=Rn,Ot[kt++]=Xr,Xr=t;var r=In;t=Rn;var i=32-Kt(r)-1;r&=~(1<<i),n+=1;var s=32-Kt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,In=1<<32-Kt(e)+i|n<<i|r,Rn=s+t}else In=1<<s|n<<i|r,Rn=t}function Qd(t){t.return!==null&&(Nr(t,1),n1(t,1,0))}function Jd(t){for(;t===cc;)cc=Di[--zi],Di[zi]=null,uc=Di[--zi],Di[zi]=null;for(;t===Xr;)Xr=Ot[--kt],Ot[kt]=null,Rn=Ot[--kt],Ot[kt]=null,In=Ot[--kt],Ot[kt]=null}var xt=null,Tt=null,de=!1,$t=null;function r1(t,e){var n=Nt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Lm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xt=t,Tt=gr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xt=t,Tt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xr!==null?{id:In,overflow:Rn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Nt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,xt=t,Tt=null,!0):!1;default:return!1}}function Ch(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Lh(t){if(de){var e=Tt;if(e){var n=e;if(!Lm(t,e)){if(Ch(t))throw Error(R(418));e=gr(n.nextSibling);var r=xt;e&&Lm(t,e)?r1(r,n):(t.flags=t.flags&-4097|2,de=!1,xt=t)}}else{if(Ch(t))throw Error(R(418));t.flags=t.flags&-4097|2,de=!1,xt=t}}}function Mm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xt=t}function Wa(t){if(t!==xt)return!1;if(!de)return Mm(t),de=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!bh(t.type,t.memoizedProps)),e&&(e=Tt)){if(Ch(t))throw i1(),Error(R(418));for(;e;)r1(t,e),e=gr(e.nextSibling)}if(Mm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Tt=gr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Tt=null}}else Tt=xt?gr(t.stateNode.nextSibling):null;return!0}function i1(){for(var t=Tt;t;)t=gr(t.nextSibling)}function as(){Tt=xt=null,de=!1}function eg(t){$t===null?$t=[t]:$t.push(t)}var _S=$n.ReactCurrentBatchConfig;function Wt(t,e){if(t&&t.defaultProps){e=ve({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var fc=Pr(null),hc=null,Ui=null,tg=null;function ng(){tg=Ui=hc=null}function rg(t){var e=fc.current;ue(fc),t._currentValue=e}function Mh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Qi(t,e){hc=t,tg=Ui=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ft=!0),t.firstContext=null)}function zt(t){var e=t._currentValue;if(tg!==t)if(t={context:t,memoizedValue:e,next:null},Ui===null){if(hc===null)throw Error(R(308));Ui=t,hc.dependencies={lanes:0,firstContext:t}}else Ui=Ui.next=t;return e}var Ur=null;function ig(t){Ur===null?Ur=[t]:Ur.push(t)}function s1(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,ig(e)):(n.next=i.next,i.next=n),e.interleaved=n,zn(t,r)}function zn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ir=!1;function sg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function o1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function kn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function pr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,K&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,zn(t,n)}return i=r.interleaved,i===null?(e.next=e,ig(r)):(e.next=i.next,i.next=e),r.interleaved=e,zn(t,n)}function Cl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wd(t,n)}}function Im(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function dc(t,e,n,r){var i=t.updateQueue;ir=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,u=c=l=null,a=s;do{var h=a.lane,d=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,d=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(d,f,h):p,h==null)break e;f=ve({},f,h);break e;case 2:ir=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else d={eventTime:d,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=d,l=f):u=u.next=d,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);qr|=o,t.lanes=o,t.memoizedState=f}}function Rm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(R(191,i));i.call(r)}}}var a1=new s_.Component().refs;function Ih(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ve({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Qc={isMounted:function(t){return(t=t._reactInternals)?ii(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=st(),i=yr(t),s=kn(r,i);s.payload=e,n!=null&&(s.callback=n),e=pr(t,s,i),e!==null&&(Qt(e,t,i,r),Cl(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=st(),i=yr(t),s=kn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=pr(t,s,i),e!==null&&(Qt(e,t,i,r),Cl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=st(),r=yr(t),i=kn(n,r);i.tag=2,e!=null&&(i.callback=e),e=pr(t,i,r),e!==null&&(Qt(e,t,r,n),Cl(e,t,r))}};function Om(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!ko(n,r)||!ko(i,s):!0}function l1(t,e,n){var r=!1,i=Er,s=e.contextType;return typeof s=="object"&&s!==null?s=zt(s):(i=dt(e)?$r:et.current,r=e.contextTypes,s=(r=r!=null)?os(t,i):Er),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function km(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Qc.enqueueReplaceState(e,e.state,null)}function Rh(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=a1,sg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=zt(s):(s=dt(e)?$r:et.current,i.context=os(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ih(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Qc.enqueueReplaceState(i,i.state,null),dc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function js(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var r=n.stateNode}if(!r)throw Error(R(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===a1&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function Ha(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Nm(t){var e=t._init;return e(t._payload)}function c1(t){function e(v,y){if(t){var w=v.deletions;w===null?(v.deletions=[y],v.flags|=16):w.push(y)}}function n(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=vr(v,y),v.index=0,v.sibling=null,v}function s(v,y,w){return v.index=w,t?(w=v.alternate,w!==null?(w=w.index,w<y?(v.flags|=2,y):w):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,y,w,x){return y===null||y.tag!==6?(y=gf(w,v.mode,x),y.return=v,y):(y=i(y,w),y.return=v,y)}function l(v,y,w,x){var S=w.type;return S===Ii?u(v,y,w.props.children,x,w.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===rr&&Nm(S)===y.type)?(x=i(y,w.props),x.ref=js(v,y,w),x.return=v,x):(x=kl(w.type,w.key,w.props,null,v.mode,x),x.ref=js(v,y,w),x.return=v,x)}function c(v,y,w,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=pf(w,v.mode,x),y.return=v,y):(y=i(y,w.children||[]),y.return=v,y)}function u(v,y,w,x,S){return y===null||y.tag!==7?(y=Gr(w,v.mode,x,S),y.return=v,y):(y=i(y,w),y.return=v,y)}function f(v,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=gf(""+y,v.mode,w),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ka:return w=kl(y.type,y.key,y.props,null,v.mode,w),w.ref=js(v,null,y),w.return=v,w;case Mi:return y=pf(y,v.mode,w),y.return=v,y;case rr:var x=y._init;return f(v,x(y._payload),w)}if(ro(y)||Ds(y))return y=Gr(y,v.mode,w,null),y.return=v,y;Ha(v,y)}return null}function h(v,y,w,x){var S=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:a(v,y,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ka:return w.key===S?l(v,y,w,x):null;case Mi:return w.key===S?c(v,y,w,x):null;case rr:return S=w._init,h(v,y,S(w._payload),x)}if(ro(w)||Ds(w))return S!==null?null:u(v,y,w,x,null);Ha(v,w)}return null}function d(v,y,w,x,S){if(typeof x=="string"&&x!==""||typeof x=="number")return v=v.get(w)||null,a(y,v,""+x,S);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ka:return v=v.get(x.key===null?w:x.key)||null,l(y,v,x,S);case Mi:return v=v.get(x.key===null?w:x.key)||null,c(y,v,x,S);case rr:var P=x._init;return d(v,y,w,P(x._payload),S)}if(ro(x)||Ds(x))return v=v.get(w)||null,u(y,v,x,S,null);Ha(y,x)}return null}function p(v,y,w,x){for(var S=null,P=null,C=y,M=y=0,O=null;C!==null&&M<w.length;M++){C.index>M?(O=C,C=null):O=C.sibling;var I=h(v,C,w[M],x);if(I===null){C===null&&(C=O);break}t&&C&&I.alternate===null&&e(v,C),y=s(I,y,M),P===null?S=I:P.sibling=I,P=I,C=O}if(M===w.length)return n(v,C),de&&Nr(v,M),S;if(C===null){for(;M<w.length;M++)C=f(v,w[M],x),C!==null&&(y=s(C,y,M),P===null?S=C:P.sibling=C,P=C);return de&&Nr(v,M),S}for(C=r(v,C);M<w.length;M++)O=d(C,v,M,w[M],x),O!==null&&(t&&O.alternate!==null&&C.delete(O.key===null?M:O.key),y=s(O,y,M),P===null?S=O:P.sibling=O,P=O);return t&&C.forEach(function(B){return e(v,B)}),de&&Nr(v,M),S}function m(v,y,w,x){var S=Ds(w);if(typeof S!="function")throw Error(R(150));if(w=S.call(w),w==null)throw Error(R(151));for(var P=S=null,C=y,M=y=0,O=null,I=w.next();C!==null&&!I.done;M++,I=w.next()){C.index>M?(O=C,C=null):O=C.sibling;var B=h(v,C,I.value,x);if(B===null){C===null&&(C=O);break}t&&C&&B.alternate===null&&e(v,C),y=s(B,y,M),P===null?S=B:P.sibling=B,P=B,C=O}if(I.done)return n(v,C),de&&Nr(v,M),S;if(C===null){for(;!I.done;M++,I=w.next())I=f(v,I.value,x),I!==null&&(y=s(I,y,M),P===null?S=I:P.sibling=I,P=I);return de&&Nr(v,M),S}for(C=r(v,C);!I.done;M++,I=w.next())I=d(C,v,M,I.value,x),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?M:I.key),y=s(I,y,M),P===null?S=I:P.sibling=I,P=I);return t&&C.forEach(function(G){return e(v,G)}),de&&Nr(v,M),S}function T(v,y,w,x){if(typeof w=="object"&&w!==null&&w.type===Ii&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ka:e:{for(var S=w.key,P=y;P!==null;){if(P.key===S){if(S=w.type,S===Ii){if(P.tag===7){n(v,P.sibling),y=i(P,w.props.children),y.return=v,v=y;break e}}else if(P.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===rr&&Nm(S)===P.type){n(v,P.sibling),y=i(P,w.props),y.ref=js(v,P,w),y.return=v,v=y;break e}n(v,P);break}else e(v,P);P=P.sibling}w.type===Ii?(y=Gr(w.props.children,v.mode,x,w.key),y.return=v,v=y):(x=kl(w.type,w.key,w.props,null,v.mode,x),x.ref=js(v,y,w),x.return=v,v=x)}return o(v);case Mi:e:{for(P=w.key;y!==null;){if(y.key===P)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){n(v,y.sibling),y=i(y,w.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else e(v,y);y=y.sibling}y=pf(w,v.mode,x),y.return=v,v=y}return o(v);case rr:return P=w._init,T(v,y,P(w._payload),x)}if(ro(w))return p(v,y,w,x);if(Ds(w))return m(v,y,w,x);Ha(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(n(v,y.sibling),y=i(y,w),y.return=v,v=y):(n(v,y),y=gf(w,v.mode,x),y.return=v,v=y),o(v)):n(v,y)}return T}var ls=c1(!0),u1=c1(!1),ca={},vn=Pr(ca),zo=Pr(ca),Uo=Pr(ca);function Br(t){if(t===ca)throw Error(R(174));return t}function og(t,e){switch(oe(Uo,e),oe(zo,t),oe(vn,ca),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:uh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=uh(e,t)}ue(vn),oe(vn,e)}function cs(){ue(vn),ue(zo),ue(Uo)}function f1(t){Br(Uo.current);var e=Br(vn.current),n=uh(e,t.type);e!==n&&(oe(zo,t),oe(vn,n))}function ag(t){zo.current===t&&(ue(vn),ue(zo))}var pe=Pr(0);function gc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var lf=[];function lg(){for(var t=0;t<lf.length;t++)lf[t]._workInProgressVersionPrimary=null;lf.length=0}var Ll=$n.ReactCurrentDispatcher,cf=$n.ReactCurrentBatchConfig,Yr=0,ye=null,Ie=null,ke=null,pc=!1,po=!1,Bo=0,wS=0;function He(){throw Error(R(321))}function cg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!en(t[n],e[n]))return!1;return!0}function ug(t,e,n,r,i,s){if(Yr=s,ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ll.current=t===null||t.memoizedState===null?bS:SS,t=n(r,i),po){s=0;do{if(po=!1,Bo=0,25<=s)throw Error(R(301));s+=1,ke=Ie=null,e.updateQueue=null,Ll.current=PS,t=n(r,i)}while(po)}if(Ll.current=mc,e=Ie!==null&&Ie.next!==null,Yr=0,ke=Ie=ye=null,pc=!1,e)throw Error(R(300));return t}function fg(){var t=Bo!==0;return Bo=0,t}function hn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ke===null?ye.memoizedState=ke=t:ke=ke.next=t,ke}function Ut(){if(Ie===null){var t=ye.alternate;t=t!==null?t.memoizedState:null}else t=Ie.next;var e=ke===null?ye.memoizedState:ke.next;if(e!==null)ke=e,Ie=t;else{if(t===null)throw Error(R(310));Ie=t,t={memoizedState:Ie.memoizedState,baseState:Ie.baseState,baseQueue:Ie.baseQueue,queue:Ie.queue,next:null},ke===null?ye.memoizedState=ke=t:ke=ke.next=t}return ke}function Vo(t,e){return typeof e=="function"?e(t):e}function uf(t){var e=Ut(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=Ie,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Yr&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,ye.lanes|=u,qr|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,en(r,e.memoizedState)||(ft=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ye.lanes|=s,qr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ff(t){var e=Ut(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);en(s,e.memoizedState)||(ft=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function h1(){}function d1(t,e){var n=ye,r=Ut(),i=e(),s=!en(r.memoizedState,i);if(s&&(r.memoizedState=i,ft=!0),r=r.queue,hg(m1.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||ke!==null&&ke.memoizedState.tag&1){if(n.flags|=2048,jo(9,p1.bind(null,n,r,i,e),void 0,null),Fe===null)throw Error(R(349));Yr&30||g1(n,e,i)}return i}function g1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ye.updateQueue,e===null?(e={lastEffect:null,stores:null},ye.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function p1(t,e,n,r){e.value=n,e.getSnapshot=r,y1(e)&&v1(t)}function m1(t,e,n){return n(function(){y1(e)&&v1(t)})}function y1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!en(t,n)}catch{return!0}}function v1(t){var e=zn(t,1);e!==null&&Qt(e,t,1,-1)}function Fm(t){var e=hn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vo,lastRenderedState:t},e.queue=t,t=t.dispatch=xS.bind(null,ye,t),[e.memoizedState,t]}function jo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ye.updateQueue,e===null?(e={lastEffect:null,stores:null},ye.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function _1(){return Ut().memoizedState}function Ml(t,e,n,r){var i=hn();ye.flags|=t,i.memoizedState=jo(1|e,n,void 0,r===void 0?null:r)}function Jc(t,e,n,r){var i=Ut();r=r===void 0?null:r;var s=void 0;if(Ie!==null){var o=Ie.memoizedState;if(s=o.destroy,r!==null&&cg(r,o.deps)){i.memoizedState=jo(e,n,s,r);return}}ye.flags|=t,i.memoizedState=jo(1|e,n,s,r)}function Dm(t,e){return Ml(8390656,8,t,e)}function hg(t,e){return Jc(2048,8,t,e)}function w1(t,e){return Jc(4,2,t,e)}function E1(t,e){return Jc(4,4,t,e)}function T1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function x1(t,e,n){return n=n!=null?n.concat([t]):null,Jc(4,4,T1.bind(null,e,t),n)}function dg(){}function b1(t,e){var n=Ut();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&cg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function S1(t,e){var n=Ut();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&cg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function P1(t,e,n){return Yr&21?(en(n,e)||(n=L_(),ye.lanes|=n,qr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ft=!0),t.memoizedState=n)}function ES(t,e){var n=ne;ne=n!==0&&4>n?n:4,t(!0);var r=cf.transition;cf.transition={};try{t(!1),e()}finally{ne=n,cf.transition=r}}function A1(){return Ut().memoizedState}function TS(t,e,n){var r=yr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},C1(t))L1(e,n);else if(n=s1(t,e,n,r),n!==null){var i=st();Qt(n,t,r,i),M1(n,e,r)}}function xS(t,e,n){var r=yr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(C1(t))L1(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,en(a,o)){var l=e.interleaved;l===null?(i.next=i,ig(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=s1(t,e,i,r),n!==null&&(i=st(),Qt(n,t,r,i),M1(n,e,r))}}function C1(t){var e=t.alternate;return t===ye||e!==null&&e===ye}function L1(t,e){po=pc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function M1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wd(t,n)}}var mc={readContext:zt,useCallback:He,useContext:He,useEffect:He,useImperativeHandle:He,useInsertionEffect:He,useLayoutEffect:He,useMemo:He,useReducer:He,useRef:He,useState:He,useDebugValue:He,useDeferredValue:He,useTransition:He,useMutableSource:He,useSyncExternalStore:He,useId:He,unstable_isNewReconciler:!1},bS={readContext:zt,useCallback:function(t,e){return hn().memoizedState=[t,e===void 0?null:e],t},useContext:zt,useEffect:Dm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ml(4194308,4,T1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ml(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ml(4,2,t,e)},useMemo:function(t,e){var n=hn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=hn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=TS.bind(null,ye,t),[r.memoizedState,t]},useRef:function(t){var e=hn();return t={current:t},e.memoizedState=t},useState:Fm,useDebugValue:dg,useDeferredValue:function(t){return hn().memoizedState=t},useTransition:function(){var t=Fm(!1),e=t[0];return t=ES.bind(null,t[1]),hn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ye,i=hn();if(de){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),Fe===null)throw Error(R(349));Yr&30||g1(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Dm(m1.bind(null,r,s,t),[t]),r.flags|=2048,jo(9,p1.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=hn(),e=Fe.identifierPrefix;if(de){var n=Rn,r=In;n=(r&~(1<<32-Kt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},SS={readContext:zt,useCallback:b1,useContext:zt,useEffect:hg,useImperativeHandle:x1,useInsertionEffect:w1,useLayoutEffect:E1,useMemo:S1,useReducer:uf,useRef:_1,useState:function(){return uf(Vo)},useDebugValue:dg,useDeferredValue:function(t){var e=Ut();return P1(e,Ie.memoizedState,t)},useTransition:function(){var t=uf(Vo)[0],e=Ut().memoizedState;return[t,e]},useMutableSource:h1,useSyncExternalStore:d1,useId:A1,unstable_isNewReconciler:!1},PS={readContext:zt,useCallback:b1,useContext:zt,useEffect:hg,useImperativeHandle:x1,useInsertionEffect:w1,useLayoutEffect:E1,useMemo:S1,useReducer:ff,useRef:_1,useState:function(){return ff(Vo)},useDebugValue:dg,useDeferredValue:function(t){var e=Ut();return Ie===null?e.memoizedState=t:P1(e,Ie.memoizedState,t)},useTransition:function(){var t=ff(Vo)[0],e=Ut().memoizedState;return[t,e]},useMutableSource:h1,useSyncExternalStore:d1,useId:A1,unstable_isNewReconciler:!1};function us(t,e){try{var n="",r=e;do n+=eb(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function hf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Oh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var AS=typeof WeakMap=="function"?WeakMap:Map;function I1(t,e,n){n=kn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){vc||(vc=!0,Gh=r),Oh(t,e)},n}function R1(t,e,n){n=kn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Oh(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Oh(t,e),typeof r!="function"&&(mr===null?mr=new Set([this]):mr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function zm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new AS;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=VS.bind(null,t,e,n),e.then(t,t))}function Um(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Bm(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=kn(-1,1),e.tag=2,pr(n,e,1))),n.lanes|=1),t)}var CS=$n.ReactCurrentOwner,ft=!1;function nt(t,e,n,r){e.child=t===null?u1(e,null,n,r):ls(e,t.child,n,r)}function Vm(t,e,n,r,i){n=n.render;var s=e.ref;return Qi(e,i),r=ug(t,e,n,r,s,i),n=fg(),t!==null&&!ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Un(t,e,i)):(de&&n&&Qd(e),e.flags|=1,nt(t,e,r,i),e.child)}function jm(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Eg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,O1(t,e,s,r,i)):(t=kl(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ko,n(o,r)&&t.ref===e.ref)return Un(t,e,i)}return e.flags|=1,t=vr(s,r),t.ref=e.ref,t.return=e,e.child=t}function O1(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ko(s,r)&&t.ref===e.ref)if(ft=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(ft=!0);else return e.lanes=t.lanes,Un(t,e,i)}return kh(t,e,n,r,i)}function k1(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},oe(Vi,_t),_t|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,oe(Vi,_t),_t|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,oe(Vi,_t),_t|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,oe(Vi,_t),_t|=r;return nt(t,e,i,n),e.child}function N1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function kh(t,e,n,r,i){var s=dt(n)?$r:et.current;return s=os(e,s),Qi(e,i),n=ug(t,e,n,r,s,i),r=fg(),t!==null&&!ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Un(t,e,i)):(de&&r&&Qd(e),e.flags|=1,nt(t,e,n,i),e.child)}function Gm(t,e,n,r,i){if(dt(n)){var s=!0;lc(e)}else s=!1;if(Qi(e,i),e.stateNode===null)Il(t,e),l1(e,n,r),Rh(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=zt(c):(c=dt(n)?$r:et.current,c=os(e,c));var u=n.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&km(e,o,r,c),ir=!1;var h=e.memoizedState;o.state=h,dc(e,r,o,i),l=e.memoizedState,a!==r||h!==l||ht.current||ir?(typeof u=="function"&&(Ih(e,n,u,r),l=e.memoizedState),(a=ir||Om(e,n,a,r,h,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,o1(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Wt(e.type,a),o.props=c,f=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=zt(l):(l=dt(n)?$r:et.current,l=os(e,l));var d=n.getDerivedStateFromProps;(u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==l)&&km(e,o,r,l),ir=!1,h=e.memoizedState,o.state=h,dc(e,r,o,i);var p=e.memoizedState;a!==f||h!==p||ht.current||ir?(typeof d=="function"&&(Ih(e,n,d,r),p=e.memoizedState),(c=ir||Om(e,n,c,r,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Nh(t,e,n,r,s,i)}function Nh(t,e,n,r,i,s){N1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Cm(e,n,!1),Un(t,e,s);r=e.stateNode,CS.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ls(e,t.child,null,s),e.child=ls(e,null,a,s)):nt(t,e,a,s),e.memoizedState=r.state,i&&Cm(e,n,!0),e.child}function F1(t){var e=t.stateNode;e.pendingContext?Am(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Am(t,e.context,!1),og(t,e.containerInfo)}function Wm(t,e,n,r,i){return as(),eg(i),e.flags|=256,nt(t,e,n,r),e.child}var Fh={dehydrated:null,treeContext:null,retryLane:0};function Dh(t){return{baseLanes:t,cachePool:null,transitions:null}}function D1(t,e,n){var r=e.pendingProps,i=pe.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),oe(pe,i&1),t===null)return Lh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=nu(o,r,0,null),t=Gr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Dh(n),e.memoizedState=Fh,t):gg(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return LS(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=vr(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=vr(a,s):(s=Gr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Dh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Fh,r}return s=t.child,t=s.sibling,r=vr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function gg(t,e){return e=nu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $a(t,e,n,r){return r!==null&&eg(r),ls(e,t.child,null,n),t=gg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function LS(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=hf(Error(R(422))),$a(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=nu({mode:"visible",children:r.children},i,0,null),s=Gr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ls(e,t.child,null,o),e.child.memoizedState=Dh(o),e.memoizedState=Fh,s);if(!(e.mode&1))return $a(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(R(419)),r=hf(s,r,void 0),$a(t,e,o,r)}if(a=(o&t.childLanes)!==0,ft||a){if(r=Fe,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,zn(t,i),Qt(r,t,i,-1))}return wg(),r=hf(Error(R(421))),$a(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=jS.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Tt=gr(i.nextSibling),xt=e,de=!0,$t=null,t!==null&&(Ot[kt++]=In,Ot[kt++]=Rn,Ot[kt++]=Xr,In=t.id,Rn=t.overflow,Xr=e),e=gg(e,r.children),e.flags|=4096,e)}function Hm(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Mh(t.return,e,n)}function df(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function z1(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(nt(t,e,r.children,n),r=pe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Hm(t,n,e);else if(t.tag===19)Hm(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(oe(pe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&gc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),df(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&gc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}df(e,!0,n,null,s);break;case"together":df(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Il(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Un(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),qr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=vr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function MS(t,e,n){switch(e.tag){case 3:F1(e),as();break;case 5:f1(e);break;case 1:dt(e.type)&&lc(e);break;case 4:og(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;oe(fc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(oe(pe,pe.current&1),e.flags|=128,null):n&e.child.childLanes?D1(t,e,n):(oe(pe,pe.current&1),t=Un(t,e,n),t!==null?t.sibling:null);oe(pe,pe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return z1(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),oe(pe,pe.current),r)break;return null;case 22:case 23:return e.lanes=0,k1(t,e,n)}return Un(t,e,n)}var U1,zh,B1,V1;U1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zh=function(){};B1=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Br(vn.current);var s=null;switch(n){case"input":i=oh(t,i),r=oh(t,r),s=[];break;case"select":i=ve({},i,{value:void 0}),r=ve({},r,{value:void 0}),s=[];break;case"textarea":i=ch(t,i),r=ch(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=oc)}fh(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ao.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ao.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&le("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};V1=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gs(t,e){if(!de)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function $e(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function IS(t,e,n){var r=e.pendingProps;switch(Jd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $e(e),null;case 1:return dt(e.type)&&ac(),$e(e),null;case 3:return r=e.stateNode,cs(),ue(ht),ue(et),lg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$t!==null&&($h($t),$t=null))),zh(t,e),$e(e),null;case 5:ag(e);var i=Br(Uo.current);if(n=e.type,t!==null&&e.stateNode!=null)B1(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(R(166));return $e(e),null}if(t=Br(vn.current),Wa(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[gn]=e,r[Do]=s,t=(e.mode&1)!==0,n){case"dialog":le("cancel",r),le("close",r);break;case"iframe":case"object":case"embed":le("load",r);break;case"video":case"audio":for(i=0;i<so.length;i++)le(so[i],r);break;case"source":le("error",r);break;case"img":case"image":case"link":le("error",r),le("load",r);break;case"details":le("toggle",r);break;case"input":em(r,s),le("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},le("invalid",r);break;case"textarea":nm(r,s),le("invalid",r)}fh(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ga(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ga(r.textContent,a,t),i=["children",""+a]):Ao.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&le("scroll",r)}switch(n){case"input":Na(r),tm(r,s,!0);break;case"textarea":Na(r),rm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=oc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=g_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[gn]=e,t[Do]=r,U1(t,e,!1,!1),e.stateNode=t;e:{switch(o=hh(n,r),n){case"dialog":le("cancel",t),le("close",t),i=r;break;case"iframe":case"object":case"embed":le("load",t),i=r;break;case"video":case"audio":for(i=0;i<so.length;i++)le(so[i],t);i=r;break;case"source":le("error",t),i=r;break;case"img":case"image":case"link":le("error",t),le("load",t),i=r;break;case"details":le("toggle",t),i=r;break;case"input":em(t,r),i=oh(t,r),le("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ve({},r,{value:void 0}),le("invalid",t);break;case"textarea":nm(t,r),i=ch(t,r),le("invalid",t);break;default:i=r}fh(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?y_(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&p_(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Co(t,l):typeof l=="number"&&Co(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ao.hasOwnProperty(s)?l!=null&&s==="onScroll"&&le("scroll",t):l!=null&&zd(t,s,l,o))}switch(n){case"input":Na(t),tm(t,r,!1);break;case"textarea":Na(t),rm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+wr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Yi(t,!!r.multiple,s,!1):r.defaultValue!=null&&Yi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=oc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $e(e),null;case 6:if(t&&e.stateNode!=null)V1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(R(166));if(n=Br(Uo.current),Br(vn.current),Wa(e)){if(r=e.stateNode,n=e.memoizedProps,r[gn]=e,(s=r.nodeValue!==n)&&(t=xt,t!==null))switch(t.tag){case 3:Ga(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ga(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gn]=e,e.stateNode=r}return $e(e),null;case 13:if(ue(pe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(de&&Tt!==null&&e.mode&1&&!(e.flags&128))i1(),as(),e.flags|=98560,s=!1;else if(s=Wa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(R(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(R(317));s[gn]=e}else as(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$e(e),s=!1}else $t!==null&&($h($t),$t=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||pe.current&1?Re===0&&(Re=3):wg())),e.updateQueue!==null&&(e.flags|=4),$e(e),null);case 4:return cs(),zh(t,e),t===null&&No(e.stateNode.containerInfo),$e(e),null;case 10:return rg(e.type._context),$e(e),null;case 17:return dt(e.type)&&ac(),$e(e),null;case 19:if(ue(pe),s=e.memoizedState,s===null)return $e(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Gs(s,!1);else{if(Re!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=gc(t),o!==null){for(e.flags|=128,Gs(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return oe(pe,pe.current&1|2),e.child}t=t.sibling}s.tail!==null&&xe()>fs&&(e.flags|=128,r=!0,Gs(s,!1),e.lanes=4194304)}else{if(!r)if(t=gc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!de)return $e(e),null}else 2*xe()-s.renderingStartTime>fs&&n!==1073741824&&(e.flags|=128,r=!0,Gs(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=xe(),e.sibling=null,n=pe.current,oe(pe,r?n&1|2:n&1),e):($e(e),null);case 22:case 23:return _g(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?_t&1073741824&&($e(e),e.subtreeFlags&6&&(e.flags|=8192)):$e(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function RS(t,e){switch(Jd(e),e.tag){case 1:return dt(e.type)&&ac(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return cs(),ue(ht),ue(et),lg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ag(e),null;case 13:if(ue(pe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));as()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ue(pe),null;case 4:return cs(),null;case 10:return rg(e.type._context),null;case 22:case 23:return _g(),null;case 24:return null;default:return null}}var Xa=!1,Ke=!1,OS=typeof WeakSet=="function"?WeakSet:Set,z=null;function Bi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Te(t,e,r)}else n.current=null}function Uh(t,e,n){try{n()}catch(r){Te(t,e,r)}}var $m=!1;function kS(t,e){if(Th=rc,t=H_(),Kd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,f=t,h=null;t:for(;;){for(var d;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===t)break t;if(h===n&&++c===i&&(a=o),h===s&&++u===r&&(l=o),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(xh={focusedElem:t,selectionRange:n},rc=!1,z=e;z!==null;)if(e=z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,z=t;else for(;z!==null;){e=z;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,T=p.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:Wt(e.type,m),T);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(x){Te(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,z=t;break}z=e.return}return p=$m,$m=!1,p}function mo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Uh(e,n,s)}i=i.next}while(i!==r)}}function eu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Bh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function j1(t){var e=t.alternate;e!==null&&(t.alternate=null,j1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gn],delete e[Do],delete e[Ph],delete e[mS],delete e[yS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function G1(t){return t.tag===5||t.tag===3||t.tag===4}function Xm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||G1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=oc));else if(r!==4&&(t=t.child,t!==null))for(Vh(t,e,n),t=t.sibling;t!==null;)Vh(t,e,n),t=t.sibling}function jh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(jh(t,e,n),t=t.sibling;t!==null;)jh(t,e,n),t=t.sibling}var Ue=null,Ht=!1;function Zn(t,e,n){for(n=n.child;n!==null;)W1(t,e,n),n=n.sibling}function W1(t,e,n){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount($c,n)}catch{}switch(n.tag){case 5:Ke||Bi(n,e);case 6:var r=Ue,i=Ht;Ue=null,Zn(t,e,n),Ue=r,Ht=i,Ue!==null&&(Ht?(t=Ue,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ue.removeChild(n.stateNode));break;case 18:Ue!==null&&(Ht?(t=Ue,n=n.stateNode,t.nodeType===8?of(t.parentNode,n):t.nodeType===1&&of(t,n),Ro(t)):of(Ue,n.stateNode));break;case 4:r=Ue,i=Ht,Ue=n.stateNode.containerInfo,Ht=!0,Zn(t,e,n),Ue=r,Ht=i;break;case 0:case 11:case 14:case 15:if(!Ke&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Uh(n,e,o),i=i.next}while(i!==r)}Zn(t,e,n);break;case 1:if(!Ke&&(Bi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Te(n,e,a)}Zn(t,e,n);break;case 21:Zn(t,e,n);break;case 22:n.mode&1?(Ke=(r=Ke)||n.memoizedState!==null,Zn(t,e,n),Ke=r):Zn(t,e,n);break;default:Zn(t,e,n)}}function Ym(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new OS),e.forEach(function(r){var i=GS.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Gt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ue=a.stateNode,Ht=!1;break e;case 3:Ue=a.stateNode.containerInfo,Ht=!0;break e;case 4:Ue=a.stateNode.containerInfo,Ht=!0;break e}a=a.return}if(Ue===null)throw Error(R(160));W1(s,o,i),Ue=null,Ht=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Te(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)H1(e,t),e=e.sibling}function H1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Gt(e,t),an(t),r&4){try{mo(3,t,t.return),eu(3,t)}catch(m){Te(t,t.return,m)}try{mo(5,t,t.return)}catch(m){Te(t,t.return,m)}}break;case 1:Gt(e,t),an(t),r&512&&n!==null&&Bi(n,n.return);break;case 5:if(Gt(e,t),an(t),r&512&&n!==null&&Bi(n,n.return),t.flags&32){var i=t.stateNode;try{Co(i,"")}catch(m){Te(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&h_(i,s),hh(a,o);var c=hh(a,s);for(o=0;o<l.length;o+=2){var u=l[o],f=l[o+1];u==="style"?y_(i,f):u==="dangerouslySetInnerHTML"?p_(i,f):u==="children"?Co(i,f):zd(i,u,f,c)}switch(a){case"input":ah(i,s);break;case"textarea":d_(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Yi(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?Yi(i,!!s.multiple,s.defaultValue,!0):Yi(i,!!s.multiple,s.multiple?[]:"",!1))}i[Do]=s}catch(m){Te(t,t.return,m)}}break;case 6:if(Gt(e,t),an(t),r&4){if(t.stateNode===null)throw Error(R(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Te(t,t.return,m)}}break;case 3:if(Gt(e,t),an(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ro(e.containerInfo)}catch(m){Te(t,t.return,m)}break;case 4:Gt(e,t),an(t);break;case 13:Gt(e,t),an(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(yg=xe())),r&4&&Ym(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Ke=(c=Ke)||u,Gt(e,t),Ke=c):Gt(e,t),an(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(z=t,u=t.child;u!==null;){for(f=z=u;z!==null;){switch(h=z,d=h.child,h.tag){case 0:case 11:case 14:case 15:mo(4,h,h.return);break;case 1:Bi(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Te(r,n,m)}}break;case 5:Bi(h,h.return);break;case 22:if(h.memoizedState!==null){Zm(f);continue}}d!==null?(d.return=h,z=d):Zm(f)}u=u.sibling}e:for(u=null,f=t;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=m_("display",o))}catch(m){Te(t,t.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){Te(t,t.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Gt(e,t),an(t),r&4&&Ym(t);break;case 21:break;default:Gt(e,t),an(t)}}function an(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(G1(n)){var r=n;break e}n=n.return}throw Error(R(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Co(i,""),r.flags&=-33);var s=Xm(t);jh(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Xm(t);Vh(t,a,o);break;default:throw Error(R(161))}}catch(l){Te(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function NS(t,e,n){z=t,$1(t)}function $1(t,e,n){for(var r=(t.mode&1)!==0;z!==null;){var i=z,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Xa;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Ke;a=Xa;var c=Ke;if(Xa=o,(Ke=l)&&!c)for(z=i;z!==null;)o=z,l=o.child,o.tag===22&&o.memoizedState!==null?Km(i):l!==null?(l.return=o,z=l):Km(i);for(;s!==null;)z=s,$1(s),s=s.sibling;z=i,Xa=a,Ke=c}qm(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,z=s):qm(t)}}function qm(t){for(;z!==null;){var e=z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ke||eu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ke)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Wt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Rm(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Rm(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Ro(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}Ke||e.flags&512&&Bh(e)}catch(h){Te(e,e.return,h)}}if(e===t){z=null;break}if(n=e.sibling,n!==null){n.return=e.return,z=n;break}z=e.return}}function Zm(t){for(;z!==null;){var e=z;if(e===t){z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,z=n;break}z=e.return}}function Km(t){for(;z!==null;){var e=z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{eu(4,e)}catch(l){Te(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Te(e,i,l)}}var s=e.return;try{Bh(e)}catch(l){Te(e,s,l)}break;case 5:var o=e.return;try{Bh(e)}catch(l){Te(e,o,l)}}}catch(l){Te(e,e.return,l)}if(e===t){z=null;break}var a=e.sibling;if(a!==null){a.return=e.return,z=a;break}z=e.return}}var FS=Math.ceil,yc=$n.ReactCurrentDispatcher,pg=$n.ReactCurrentOwner,Ft=$n.ReactCurrentBatchConfig,K=0,Fe=null,Ae=null,Ge=0,_t=0,Vi=Pr(0),Re=0,Go=null,qr=0,tu=0,mg=0,yo=null,ut=null,yg=0,fs=1/0,Cn=null,vc=!1,Gh=null,mr=null,Ya=!1,lr=null,_c=0,vo=0,Wh=null,Rl=-1,Ol=0;function st(){return K&6?xe():Rl!==-1?Rl:Rl=xe()}function yr(t){return t.mode&1?K&2&&Ge!==0?Ge&-Ge:_S.transition!==null?(Ol===0&&(Ol=L_()),Ol):(t=ne,t!==0||(t=window.event,t=t===void 0?16:F_(t.type)),t):1}function Qt(t,e,n,r){if(50<vo)throw vo=0,Wh=null,Error(R(185));oa(t,n,r),(!(K&2)||t!==Fe)&&(t===Fe&&(!(K&2)&&(tu|=n),Re===4&&or(t,Ge)),gt(t,r),n===1&&K===0&&!(e.mode&1)&&(fs=xe()+500,Kc&&Ar()))}function gt(t,e){var n=t.callbackNode;_b(t,e);var r=nc(t,t===Fe?Ge:0);if(r===0)n!==null&&om(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&om(n),e===1)t.tag===0?vS(Qm.bind(null,t)):t1(Qm.bind(null,t)),gS(function(){!(K&6)&&Ar()}),n=null;else{switch(M_(r)){case 1:n=Gd;break;case 4:n=A_;break;case 16:n=tc;break;case 536870912:n=C_;break;default:n=tc}n=ew(n,X1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function X1(t,e){if(Rl=-1,Ol=0,K&6)throw Error(R(327));var n=t.callbackNode;if(Ji()&&t.callbackNode!==n)return null;var r=nc(t,t===Fe?Ge:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=wc(t,r);else{e=r;var i=K;K|=2;var s=q1();(Fe!==t||Ge!==e)&&(Cn=null,fs=xe()+500,jr(t,e));do try{US();break}catch(a){Y1(t,a)}while(1);ng(),yc.current=s,K=i,Ae!==null?e=0:(Fe=null,Ge=0,e=Re)}if(e!==0){if(e===2&&(i=yh(t),i!==0&&(r=i,e=Hh(t,i))),e===1)throw n=Go,jr(t,0),or(t,r),gt(t,xe()),n;if(e===6)or(t,r);else{if(i=t.current.alternate,!(r&30)&&!DS(i)&&(e=wc(t,r),e===2&&(s=yh(t),s!==0&&(r=s,e=Hh(t,s))),e===1))throw n=Go,jr(t,0),or(t,r),gt(t,xe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(R(345));case 2:Fr(t,ut,Cn);break;case 3:if(or(t,r),(r&130023424)===r&&(e=yg+500-xe(),10<e)){if(nc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){st(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Sh(Fr.bind(null,t,ut,Cn),e);break}Fr(t,ut,Cn);break;case 4:if(or(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Kt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=xe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*FS(r/1960))-r,10<r){t.timeoutHandle=Sh(Fr.bind(null,t,ut,Cn),r);break}Fr(t,ut,Cn);break;case 5:Fr(t,ut,Cn);break;default:throw Error(R(329))}}}return gt(t,xe()),t.callbackNode===n?X1.bind(null,t):null}function Hh(t,e){var n=yo;return t.current.memoizedState.isDehydrated&&(jr(t,e).flags|=256),t=wc(t,e),t!==2&&(e=ut,ut=n,e!==null&&$h(e)),t}function $h(t){ut===null?ut=t:ut.push.apply(ut,t)}function DS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!en(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function or(t,e){for(e&=~mg,e&=~tu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Kt(e),r=1<<n;t[n]=-1,e&=~r}}function Qm(t){if(K&6)throw Error(R(327));Ji();var e=nc(t,0);if(!(e&1))return gt(t,xe()),null;var n=wc(t,e);if(t.tag!==0&&n===2){var r=yh(t);r!==0&&(e=r,n=Hh(t,r))}if(n===1)throw n=Go,jr(t,0),or(t,e),gt(t,xe()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fr(t,ut,Cn),gt(t,xe()),null}function vg(t,e){var n=K;K|=1;try{return t(e)}finally{K=n,K===0&&(fs=xe()+500,Kc&&Ar())}}function Zr(t){lr!==null&&lr.tag===0&&!(K&6)&&Ji();var e=K;K|=1;var n=Ft.transition,r=ne;try{if(Ft.transition=null,ne=1,t)return t()}finally{ne=r,Ft.transition=n,K=e,!(K&6)&&Ar()}}function _g(){_t=Vi.current,ue(Vi)}function jr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,dS(n)),Ae!==null)for(n=Ae.return;n!==null;){var r=n;switch(Jd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ac();break;case 3:cs(),ue(ht),ue(et),lg();break;case 5:ag(r);break;case 4:cs();break;case 13:ue(pe);break;case 19:ue(pe);break;case 10:rg(r.type._context);break;case 22:case 23:_g()}n=n.return}if(Fe=t,Ae=t=vr(t.current,null),Ge=_t=e,Re=0,Go=null,mg=tu=qr=0,ut=yo=null,Ur!==null){for(e=0;e<Ur.length;e++)if(n=Ur[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ur=null}return t}function Y1(t,e){do{var n=Ae;try{if(ng(),Ll.current=mc,pc){for(var r=ye.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}pc=!1}if(Yr=0,ke=Ie=ye=null,po=!1,Bo=0,pg.current=null,n===null||n.return===null){Re=1,Go=e,Ae=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Ge,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=Um(o);if(d!==null){d.flags&=-257,Bm(d,o,a,s,e),d.mode&1&&zm(s,c,e),e=d,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){zm(s,c,e),wg();break e}l=Error(R(426))}}else if(de&&a.mode&1){var T=Um(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Bm(T,o,a,s,e),eg(us(l,a));break e}}s=l=us(l,a),Re!==4&&(Re=2),yo===null?yo=[s]:yo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=I1(s,l,e);Im(s,v);break e;case 1:a=l;var y=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(mr===null||!mr.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var x=R1(s,a,e);Im(s,x);break e}}s=s.return}while(s!==null)}K1(n)}catch(S){e=S,Ae===n&&n!==null&&(Ae=n=n.return);continue}break}while(1)}function q1(){var t=yc.current;return yc.current=mc,t===null?mc:t}function wg(){(Re===0||Re===3||Re===2)&&(Re=4),Fe===null||!(qr&268435455)&&!(tu&268435455)||or(Fe,Ge)}function wc(t,e){var n=K;K|=2;var r=q1();(Fe!==t||Ge!==e)&&(Cn=null,jr(t,e));do try{zS();break}catch(i){Y1(t,i)}while(1);if(ng(),K=n,yc.current=r,Ae!==null)throw Error(R(261));return Fe=null,Ge=0,Re}function zS(){for(;Ae!==null;)Z1(Ae)}function US(){for(;Ae!==null&&!ub();)Z1(Ae)}function Z1(t){var e=J1(t.alternate,t,_t);t.memoizedProps=t.pendingProps,e===null?K1(t):Ae=e,pg.current=null}function K1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=RS(n,e),n!==null){n.flags&=32767,Ae=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Re=6,Ae=null;return}}else if(n=IS(n,e,_t),n!==null){Ae=n;return}if(e=e.sibling,e!==null){Ae=e;return}Ae=e=t}while(e!==null);Re===0&&(Re=5)}function Fr(t,e,n){var r=ne,i=Ft.transition;try{Ft.transition=null,ne=1,BS(t,e,n,r)}finally{Ft.transition=i,ne=r}return null}function BS(t,e,n,r){do Ji();while(lr!==null);if(K&6)throw Error(R(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(wb(t,s),t===Fe&&(Ae=Fe=null,Ge=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ya||(Ya=!0,ew(tc,function(){return Ji(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ft.transition,Ft.transition=null;var o=ne;ne=1;var a=K;K|=4,pg.current=null,kS(t,n),H1(n,t),oS(xh),rc=!!Th,xh=Th=null,t.current=n,NS(n),fb(),K=a,ne=o,Ft.transition=s}else t.current=n;if(Ya&&(Ya=!1,lr=t,_c=i),s=t.pendingLanes,s===0&&(mr=null),gb(n.stateNode),gt(t,xe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(vc)throw vc=!1,t=Gh,Gh=null,t;return _c&1&&t.tag!==0&&Ji(),s=t.pendingLanes,s&1?t===Wh?vo++:(vo=0,Wh=t):vo=0,Ar(),null}function Ji(){if(lr!==null){var t=M_(_c),e=Ft.transition,n=ne;try{if(Ft.transition=null,ne=16>t?16:t,lr===null)var r=!1;else{if(t=lr,lr=null,_c=0,K&6)throw Error(R(331));var i=K;for(K|=4,z=t.current;z!==null;){var s=z,o=s.child;if(z.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(z=c;z!==null;){var u=z;switch(u.tag){case 0:case 11:case 15:mo(8,u,s)}var f=u.child;if(f!==null)f.return=u,z=f;else for(;z!==null;){u=z;var h=u.sibling,d=u.return;if(j1(u),u===c){z=null;break}if(h!==null){h.return=d,z=h;break}z=d}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var T=m.sibling;m.sibling=null,m=T}while(m!==null)}}z=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,z=o;else e:for(;z!==null;){if(s=z,s.flags&2048)switch(s.tag){case 0:case 11:case 15:mo(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,z=v;break e}z=s.return}}var y=t.current;for(z=y;z!==null;){o=z;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,z=w;else e:for(o=y;z!==null;){if(a=z,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:eu(9,a)}}catch(S){Te(a,a.return,S)}if(a===o){z=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,z=x;break e}z=a.return}}if(K=i,Ar(),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot($c,t)}catch{}r=!0}return r}finally{ne=n,Ft.transition=e}}return!1}function Jm(t,e,n){e=us(n,e),e=I1(t,e,1),t=pr(t,e,1),e=st(),t!==null&&(oa(t,1,e),gt(t,e))}function Te(t,e,n){if(t.tag===3)Jm(t,t,n);else for(;e!==null;){if(e.tag===3){Jm(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(mr===null||!mr.has(r))){t=us(n,t),t=R1(e,t,1),e=pr(e,t,1),t=st(),e!==null&&(oa(e,1,t),gt(e,t));break}}e=e.return}}function VS(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=st(),t.pingedLanes|=t.suspendedLanes&n,Fe===t&&(Ge&n)===n&&(Re===4||Re===3&&(Ge&130023424)===Ge&&500>xe()-yg?jr(t,0):mg|=n),gt(t,e)}function Q1(t,e){e===0&&(t.mode&1?(e=za,za<<=1,!(za&130023424)&&(za=4194304)):e=1);var n=st();t=zn(t,e),t!==null&&(oa(t,e,n),gt(t,n))}function jS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Q1(t,n)}function GS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(R(314))}r!==null&&r.delete(e),Q1(t,n)}var J1;J1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ht.current)ft=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ft=!1,MS(t,e,n);ft=!!(t.flags&131072)}else ft=!1,de&&e.flags&1048576&&n1(e,uc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Il(t,e),t=e.pendingProps;var i=os(e,et.current);Qi(e,n),i=ug(null,e,r,t,i,n);var s=fg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,dt(r)?(s=!0,lc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,sg(e),i.updater=Qc,e.stateNode=i,i._reactInternals=e,Rh(e,r,t,n),e=Nh(null,e,r,!0,s,n)):(e.tag=0,de&&s&&Qd(e),nt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Il(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=HS(r),t=Wt(r,t),i){case 0:e=kh(null,e,r,t,n);break e;case 1:e=Gm(null,e,r,t,n);break e;case 11:e=Vm(null,e,r,t,n);break e;case 14:e=jm(null,e,r,Wt(r.type,t),n);break e}throw Error(R(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wt(r,i),kh(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wt(r,i),Gm(t,e,r,i,n);case 3:e:{if(F1(e),t===null)throw Error(R(387));r=e.pendingProps,s=e.memoizedState,i=s.element,o1(t,e),dc(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=us(Error(R(423)),e),e=Wm(t,e,r,n,i);break e}else if(r!==i){i=us(Error(R(424)),e),e=Wm(t,e,r,n,i);break e}else for(Tt=gr(e.stateNode.containerInfo.firstChild),xt=e,de=!0,$t=null,n=u1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(as(),r===i){e=Un(t,e,n);break e}nt(t,e,r,n)}e=e.child}return e;case 5:return f1(e),t===null&&Lh(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,bh(r,i)?o=null:s!==null&&bh(r,s)&&(e.flags|=32),N1(t,e),nt(t,e,o,n),e.child;case 6:return t===null&&Lh(e),null;case 13:return D1(t,e,n);case 4:return og(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ls(e,null,r,n):nt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wt(r,i),Vm(t,e,r,i,n);case 7:return nt(t,e,e.pendingProps,n),e.child;case 8:return nt(t,e,e.pendingProps.children,n),e.child;case 12:return nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,oe(fc,r._currentValue),r._currentValue=o,s!==null)if(en(s.value,o)){if(s.children===i.children&&!ht.current){e=Un(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=kn(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Mh(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(R(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Mh(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}nt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Qi(e,n),i=zt(i),r=r(i),e.flags|=1,nt(t,e,r,n),e.child;case 14:return r=e.type,i=Wt(r,e.pendingProps),i=Wt(r.type,i),jm(t,e,r,i,n);case 15:return O1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Wt(r,i),Il(t,e),e.tag=1,dt(r)?(t=!0,lc(e)):t=!1,Qi(e,n),l1(e,r,i),Rh(e,r,i,n),Nh(null,e,r,!0,t,n);case 19:return z1(t,e,n);case 22:return k1(t,e,n)}throw Error(R(156,e.tag))};function ew(t,e){return P_(t,e)}function WS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nt(t,e,n,r){return new WS(t,e,n,r)}function Eg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function HS(t){if(typeof t=="function")return Eg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Bd)return 11;if(t===Vd)return 14}return 2}function vr(t,e){var n=t.alternate;return n===null?(n=Nt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function kl(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Eg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ii:return Gr(n.children,i,s,e);case Ud:o=8,i|=8;break;case nh:return t=Nt(12,n,e,i|2),t.elementType=nh,t.lanes=s,t;case rh:return t=Nt(13,n,e,i),t.elementType=rh,t.lanes=s,t;case ih:return t=Nt(19,n,e,i),t.elementType=ih,t.lanes=s,t;case c_:return nu(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case a_:o=10;break e;case l_:o=9;break e;case Bd:o=11;break e;case Vd:o=14;break e;case rr:o=16,r=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=Nt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Gr(t,e,n,r){return t=Nt(7,t,r,e),t.lanes=n,t}function nu(t,e,n,r){return t=Nt(22,t,r,e),t.elementType=c_,t.lanes=n,t.stateNode={isHidden:!1},t}function gf(t,e,n){return t=Nt(6,t,null,e),t.lanes=n,t}function pf(t,e,n){return e=Nt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $S(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yu(0),this.expirationTimes=Yu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Tg(t,e,n,r,i,s,o,a,l){return t=new $S(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Nt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},sg(s),t}function XS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function tw(t){if(!t)return Er;t=t._reactInternals;e:{if(ii(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(dt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if(dt(n))return e1(t,n,e)}return e}function nw(t,e,n,r,i,s,o,a,l){return t=Tg(n,r,!0,t,i,s,o,a,l),t.context=tw(null),n=t.current,r=st(),i=yr(n),s=kn(r,i),s.callback=e??null,pr(n,s,i),t.current.lanes=i,oa(t,i,r),gt(t,r),t}function ru(t,e,n,r){var i=e.current,s=st(),o=yr(i);return n=tw(n),e.context===null?e.context=n:e.pendingContext=n,e=kn(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=pr(i,e,o),t!==null&&(Qt(t,i,o,s),Cl(t,i,o)),o}function Ec(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function e0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function xg(t,e){e0(t,e),(t=t.alternate)&&e0(t,e)}function YS(){return null}var rw=typeof reportError=="function"?reportError:function(t){console.error(t)};function bg(t){this._internalRoot=t}iu.prototype.render=bg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));ru(t,e,null,null)};iu.prototype.unmount=bg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zr(function(){ru(null,t,null,null)}),e[Dn]=null}};function iu(t){this._internalRoot=t}iu.prototype.unstable_scheduleHydration=function(t){if(t){var e=O_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<sr.length&&e!==0&&e<sr[n].priority;n++);sr.splice(n,0,t),n===0&&N_(t)}};function Sg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function su(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function t0(){}function qS(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=Ec(o);s.call(c)}}var o=nw(e,r,t,0,null,!1,!1,"",t0);return t._reactRootContainer=o,t[Dn]=o.current,No(t.nodeType===8?t.parentNode:t),Zr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Ec(l);a.call(c)}}var l=Tg(t,0,!1,null,null,!1,!1,"",t0);return t._reactRootContainer=l,t[Dn]=l.current,No(t.nodeType===8?t.parentNode:t),Zr(function(){ru(e,l,n,r)}),l}function ou(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Ec(o);a.call(l)}}ru(e,o,t,i)}else o=qS(n,e,t,i,r);return Ec(o)}I_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=io(e.pendingLanes);n!==0&&(Wd(e,n|1),gt(e,xe()),!(K&6)&&(fs=xe()+500,Ar()))}break;case 13:Zr(function(){var r=zn(t,1);if(r!==null){var i=st();Qt(r,t,1,i)}}),xg(t,1)}};Hd=function(t){if(t.tag===13){var e=zn(t,134217728);if(e!==null){var n=st();Qt(e,t,134217728,n)}xg(t,134217728)}};R_=function(t){if(t.tag===13){var e=yr(t),n=zn(t,e);if(n!==null){var r=st();Qt(n,t,e,r)}xg(t,e)}};O_=function(){return ne};k_=function(t,e){var n=ne;try{return ne=t,e()}finally{ne=n}};gh=function(t,e,n){switch(e){case"input":if(ah(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Zc(r);if(!i)throw Error(R(90));f_(r),ah(r,i)}}}break;case"textarea":d_(t,n);break;case"select":e=n.value,e!=null&&Yi(t,!!n.multiple,e,!1)}};w_=vg;E_=Zr;var ZS={usingClientEntryPoint:!1,Events:[la,Ni,Zc,v_,__,vg]},Ws={findFiberByHostInstance:zr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},KS={bundleType:Ws.bundleType,version:Ws.version,rendererPackageName:Ws.rendererPackageName,rendererConfig:Ws.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$n.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=b_(t),t===null?null:t.stateNode},findFiberByHostInstance:Ws.findFiberByHostInstance||YS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qa.isDisabled&&qa.supportsFiber)try{$c=qa.inject(KS),yn=qa}catch{}}At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZS;At.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sg(e))throw Error(R(200));return XS(t,e,null,n)};At.createRoot=function(t,e){if(!Sg(t))throw Error(R(299));var n=!1,r="",i=rw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Tg(t,1,!1,null,null,n,!1,r,i),t[Dn]=e.current,No(t.nodeType===8?t.parentNode:t),new bg(e)};At.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=b_(e),t=t===null?null:t.stateNode,t};At.flushSync=function(t){return Zr(t)};At.hydrate=function(t,e,n){if(!su(e))throw Error(R(200));return ou(null,t,e,!0,n)};At.hydrateRoot=function(t,e,n){if(!Sg(t))throw Error(R(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=rw;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=nw(e,null,t,1,n??null,i,!1,s,o),t[Dn]=e.current,No(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new iu(e)};At.render=function(t,e,n){if(!su(e))throw Error(R(200));return ou(null,t,e,!1,n)};At.unmountComponentAtNode=function(t){if(!su(t))throw Error(R(40));return t._reactRootContainer?(Zr(function(){ou(null,null,t,!1,function(){t._reactRootContainer=null,t[Dn]=null})}),!0):!1};At.unstable_batchedUpdates=vg;At.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!su(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return ou(t,e,n,!1,r)};At.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=At})(Yx);var n0=Jf;Qf.createRoot=n0.createRoot,Qf.hydrateRoot=n0.hydrateRoot;function r0(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const iw=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),i0=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);i0&&parseFloat(i0[1]);const QS="3.4.4";function Bn(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Nl=typeof process!="object"||String(process)!=="[object process]"||process.browser,JS=typeof window<"u"&&typeof window.orientation<"u",s0=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);s0&&parseFloat(s0[1]);function Wo(t){return Wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wo(t)}function eP(t,e){if(Wo(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Wo(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tP(t){var e=eP(t,"string");return Wo(e)==="symbol"?e:String(e)}function g(t,e,n){return e=tP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class nP{constructor(e,n){g(this,"name",void 0),g(this,"workerThread",void 0),g(this,"isRunning",!0),g(this,"result",void 0),g(this,"_resolve",()=>{}),g(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Bn(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Bn(this.isRunning),this.isRunning=!1,this._reject(e)}}let mf=class{terminate(){}};const yf=new Map;function rP(t){Bn(t.source&&!t.url||!t.source&&t.url);let e=yf.get(t.source||t.url);return e||(t.url&&(e=iP(t.url),yf.set(t.url,e)),t.source&&(e=sw(t.source),yf.set(t.source,e))),Bn(e),e}function iP(t){if(!t.startsWith("http"))return t;const e=sP(t);return sw(e)}function sw(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function sP(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function ow(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(o0(t))r.add(t);else if(o0(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)ow(t[i],e,r)}}return n===void 0?Array.from(r):[]}function o0(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const vf=()=>{};class Xh{static isSupported(){return typeof Worker<"u"&&Nl||typeof mf<"u"&&!Nl}constructor(e){g(this,"name",void 0),g(this,"source",void 0),g(this,"url",void 0),g(this,"terminated",!1),g(this,"worker",void 0),g(this,"onMessage",void 0),g(this,"onError",void 0),g(this,"_loadableURL","");const{name:n,source:r,url:i}=e;Bn(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=vf,this.onError=s=>console.log(s),this.worker=Nl?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=vf,this.onError=vf,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,n){n=n||ow(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=rP({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new mf(r,{eval:!1})}else if(this.source)e=new mf(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class oP{static isSupported(){return Xh.isSupported()}constructor(e){g(this,"name","unnamed"),g(this,"source",void 0),g(this,"url",void 0),g(this,"maxConcurrency",1),g(this,"maxMobileConcurrency",1),g(this,"onDebug",()=>{}),g(this,"reuseWorkers",!0),g(this,"props",{}),g(this,"jobQueue",[]),g(this,"idleQueue",[]),g(this,"count",0),g(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,o,a)=>s.done(a),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,o)=>s.error(o);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new nP(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Xh({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return JS?this.maxMobileConcurrency:this.maxConcurrency}}const aP={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Mn{static isSupported(){return Xh.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Mn._workerFarm=Mn._workerFarm||new Mn({}),Mn._workerFarm.setProps(e),Mn._workerFarm}constructor(e){g(this,"props",void 0),g(this,"workerPools",new Map),this.props={...aP},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new oP({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}g(Mn,"_workerFarm",void 0);const lP="latest";function cP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=lP);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return Bn(i),i}function uP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:QS;Bn(t,"no worker provided");const n=t.version;return!(!e||!n)}function fP(t,e){return!Mn.isSupported()||!Nl&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function hP(t,e,n,r,i){const s=t.id,o=cP(t,n),l=Mn.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const c=await l.startJob("process-on-worker",dP.bind(null,i));return c.postMessage("process",{input:e,options:n,context:r}),await(await c.result).result}async function dP(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function gP(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function pP(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),i=r.reduce((a,l)=>a+l.byteLength,0),s=new Uint8Array(i);let o=0;for(const a of r)s.set(a,o),o+=a.byteLength;return s.buffer}async function mP(t){const e=[];for await(const n of t)e.push(n);return pP(...e)}let yP="";const a0={};function vP(t){for(const e in a0)if(t.startsWith(e)){const n=a0[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(yP).concat(t)),t}function _P(t){return t&&typeof t=="object"&&t.isBuffer}function aw(t){if(_P(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function lw(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function wP(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const EP=t=>typeof t=="boolean",_o=t=>typeof t=="function",ua=t=>t!==null&&typeof t=="object",l0=t=>ua(t)&&t.constructor==={}.constructor,TP=t=>t&&typeof t[Symbol.iterator]=="function",xP=t=>t&&typeof t[Symbol.asyncIterator]=="function",si=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,oi=t=>typeof Blob<"u"&&t instanceof Blob,bP=t=>t&&typeof t=="object"&&t.isBuffer,SP=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||ua(t)&&_o(t.tee)&&_o(t.cancel)&&_o(t.getReader),PP=t=>ua(t)&&_o(t.read)&&_o(t.pipe)&&EP(t.readable),cw=t=>SP(t)||PP(t),AP=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,CP=/^([-\w.]+\/[-\w.+]+)/;function LP(t){const e=CP.exec(t);return e?e[1]:t}function c0(t){const e=AP.exec(t);return e?e[1]:""}const uw=/\?.*/;function MP(t){const e=t.match(uw);return e&&e[0]}function Pg(t){return t.replace(uw,"")}function au(t){return si(t)?t.url:oi(t)?t.name||"":typeof t=="string"?t:""}function Ag(t){if(si(t)){const e=t,n=e.headers.get("content-type")||"",r=Pg(e.url);return LP(n)||c0(r)}return oi(t)?t.type||"":typeof t=="string"?c0(t):""}function IP(t){return si(t)?t.headers["content-length"]||-1:oi(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function fw(t){if(si(t))return t;const e={},n=IP(t);n>=0&&(e["content-length"]=String(n));const r=au(t),i=Ag(t);i&&(e["content-type"]=i);const s=await kP(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function RP(t){if(!t.ok){const e=await OP(t);throw new Error(e)}}async function OP(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function kP(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=NP(n);return"data:base64,".concat(r)}return null}function NP(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function u0(t,e){if(typeof t=="string"){t=vP(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await fw(t)}function FP(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&Boolean(process.versions.electron))return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function fa(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||FP()}const Za=globalThis.window||globalThis.self||globalThis.global,Hs=globalThis.process||{},hw=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";fa();function DP(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let zP=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=DP(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function UP(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function BP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function _f(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Tc;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Tc||(Tc={}));const VP=10;function f0(t){return typeof t!="string"?t:(t=t.toUpperCase(),Tc[t]||Tc.WHITE)}function jP(t,e,n){if(!fa&&typeof t=="string"){if(e){const r=f0(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=f0(n);t="\x1B[".concat(r+VP,"m").concat(t,"\x1B[49m")}}return t}function GP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const o=i[s];typeof o=="function"&&(e.find(a=>s===a)||(i[s]=o.bind(t)))}}function xc(t,e){if(!t)throw new Error(e||"Assertion failed")}function pi(){let t;if(fa()&&Za.performance){var e,n;t=Za==null||(e=Za.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Hs){var r;const i=Hs==null||(r=Hs.hrtime)===null||r===void 0?void 0:r.call(Hs);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const mi={debug:fa()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},WP={enabled:!0,level:0};function It(){}const h0={},d0={once:!0};let Cg=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=hw,this._startTs=pi(),this._deltaTs=pi(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new zP("__probe-".concat(this.id,"__"),WP),this.timeStamp("".concat(this.id," started")),GP(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((pi()-this._startTs).toPrecision(10))}getDelta(){return Number((pi()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){xc(e,n)}warn(e){return this._getLogFunction(0,e,mi.warn,arguments,d0)}error(e){return this._getLogFunction(0,e,mi.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,mi.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,mi.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,mi.debug||mi.info,arguments,d0)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||It,r&&[r],{tag:YP(n)}):It}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?fa()?XP({image:i,message:s,scale:o}):$P():It}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||It)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=g0({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||It)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=dw(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=g0({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,xc(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=pi();const o=s.tag||s.message;if(s.once&&o)if(!h0[o])h0[o]=pi();else return It;return n=HP(this.id,s.message,s),r.bind(console,n,...s.args)}return It}};Cg.VERSION=hw;function dw(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return xc(Number.isFinite(e)&&e>=0),e}function g0(t){const{logLevel:e,message:n}=t;t.logLevel=dw(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return xc(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function HP(t,e,n){if(typeof e=="string"){const r=n.time?BP(UP(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=jP(e,n.color,n.background)}return e}function $P(t){return console.warn("removed"),It}function XP(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=_f(s,n,r);console.log(...o)},s.src=e,It}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(..._f(e,n,r)),It;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(..._f(s,n,r)),s.src=e.toDataURL(),It}return It}function YP(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const p0=new Cg({id:"loaders.gl"});class qP{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class ZP{constructor(){g(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const gw={fetch:null,mimeType:void 0,nothrow:!1,log:new ZP,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:iw,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},KP={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function pw(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const mw=()=>{const t=pw();return t.globalOptions=t.globalOptions||{...gw},t.globalOptions};function QP(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],JP(t,n),t2(e,t,r)}function JP(t,e){m0(t,null,gw,KP,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};m0(r,n.id,i,s,e)}}function m0(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const l=!e&&ua(t[a]),c=a==="baseUri"&&!e,u=a==="workerUrl"&&e;if(!(a in n)&&!c&&!u){if(a in r)p0.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const f=e2(a,i);p0.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(f))()}}}}function e2(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function t2(t,e,n){const i={...t.options||{}};return n2(i,n),i.log===null&&(i.log=new qP),y0(i,mw()),y0(i,e),i}function y0(t,e){for(const n in e)if(n in e){const r=e[n];l0(r)&&l0(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function n2(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function Lg(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function Mg(t){var e,n;r0(t,"null loader"),r0(Lg(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const yw=()=>{const t=pw();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function r2(t){const e=yw();t=Array.isArray(t)?t:[t];for(const n of t){const r=Mg(n);e.find(i=>r===i)||e.unshift(r)}}function i2(){return yw()}const s2=new Cg({id:"loaders.gl"}),o2=/\.([^.]+)$/;async function a2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!vw(t))return null;let i=v0(t,e,{...n,nothrow:!0},r);if(i)return i;if(oi(t)&&(t=await t.slice(0,10).arrayBuffer(),i=v0(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(_w(t));return i}function v0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!vw(t))return null;if(e&&!Array.isArray(e))return Mg(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...i2()),c2(i);const s=l2(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(_w(t));return s}function l2(t,e,n,r){const i=au(t),s=Ag(t),o=Pg(i)||(r==null?void 0:r.url);let a=null,l="";if(n!=null&&n.mimeType&&(a=wf(e,n==null?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||u2(e,o),l=l||(a?"matched url ".concat(o):""),a=a||wf(e,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||h2(e,t),l=l||(a?"matched initial data ".concat(ww(t)):""),a=a||wf(e,n==null?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l){var c;s2.log(1,"selectLoader selected ".concat((c=a)===null||c===void 0?void 0:c.name,": ").concat(l,"."))}return a}function vw(t){return!(t instanceof Response&&t.status===204)}function _w(t){const e=au(t),n=Ag(t);let r="No valid loader found (";r+=e?"".concat(lw(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?ww(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function c2(t){for(const e of t)Mg(e)}function u2(t,e){const n=e&&o2.exec(e),r=n&&n[1];return r?f2(t,r):null}function f2(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function wf(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function h2(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(d2(e,n))return n}else if(ArrayBuffer.isView(e)){if(_0(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&_0(e,0,n))return n;return null}function d2(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function _0(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>g2(t,e,n,i))}function g2(t,e,n,r){if(r instanceof ArrayBuffer)return gP(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=Yh(t,e,r.length);return r===i;default:return!1}}function ww(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Yh(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Yh(t,0,e):""}function Yh(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const p2=256*1024;function*m2(t,e){const n=(e==null?void 0:e.chunkSize)||p2;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const y2=256*1024;function v2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=y2}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}()}const _2=1024*1024;async function*w2(t,e){const n=(e==null?void 0:e.chunkSize)||_2;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function w0(t,e){return iw?E2(t,e):T2(t)}async function*E2(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield aw(o)}}catch{n.releaseLock()}}async function*T2(t,e){for await(const n of t)yield aw(n)}function x2(t,e){if(typeof t=="string")return m2(t,e);if(t instanceof ArrayBuffer)return v2(t,e);if(oi(t))return w2(t,e);if(cw(t))return w0(t,e);if(si(t))return w0(t.body,e);throw new Error("makeIterator")}const Ew="Cannot convert supplied data type";function b2(t,e,n){if(e.text&&typeof t=="string")return t;if(bP(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(Ew)}async function S2(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return b2(t,e);if(oi(t)&&(t=await fw(t)),si(t)){const i=t;return await RP(i),e.binary?await i.arrayBuffer():await i.text()}if(cw(t)&&(t=x2(t,n)),TP(t)||xP(t))return mP(t);throw new Error(Ew)}function Tw(t,e){const n=mw(),r=t||n;return typeof r.fetch=="function"?r.fetch:ua(r.fetch)?i=>u0(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:u0}function P2(t,e,n){if(n)return n;const r={fetch:Tw(e,t),...t};if(r.url){const i=Pg(r.url);r.baseUrl=i,r.queryString=MP(r.url),r.filename=lw(i),r.baseUrl=wP(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function A2(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function Ig(t,e,n,r){Bn(!r||typeof r=="object"),e&&!Array.isArray(e)&&!Lg(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=au(t),o=A2(e,r),a=await a2(t,o,n);return a?(n=QP(n,a,o,i),r=P2({url:i,parse:Ig,loaders:o},n,r||null),await C2(a,t,n,r)):null}async function C2(t,e,n,r){if(uP(t),si(e)){const i=e,{ok:s,redirected:o,status:a,statusText:l,type:c,url:u}=i,f=Object.fromEntries(i.headers.entries());r.response={headers:f,ok:s,redirected:o,status:a,statusText:l,type:c,url:u}}if(e=await S2(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(fP(t,n))return await hP(t,e,n,r,Ig);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw Bn(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function bc(t,e,n,r){!Array.isArray(e)&&!Lg(e)&&(n=e,e=void 0);const i=Tw(n);let s=t;return typeof t=="string"&&(s=await i(t)),oi(t)&&(s=await i(t)),await Ig(s,e,n)}const L2="3.2.13";function xw(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const M2=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),E0=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);E0&&parseFloat(E0[1]);function T0(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class x0{constructor(e,n){g(this,"name",void 0),g(this,"type",void 0),g(this,"sampleSize",1),g(this,"time",void 0),g(this,"count",void 0),g(this,"samples",void 0),g(this,"lastTiming",void 0),g(this,"lastSampleTime",void 0),g(this,"lastSampleCount",void 0),g(this,"_count",0),g(this,"_time",0),g(this,"_samples",0),g(this,"_startTime",0),g(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=T0(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(T0()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class lu{constructor(e){g(this,"id",void 0),g(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof x0?this.stats[n]=e:this.stats[n]=new x0(n,r)),this.stats[n]}}const I2="Queued Requests",R2="Active Requests",O2="Cancelled Requests",k2="Queued Requests Ever",N2="Active Requests Ever",F2={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class D2{constructor(e={}){g(this,"props",void 0),g(this,"stats",void 0),g(this,"activeRequestCount",0),g(this,"requestQueue",[]),g(this,"requestMap",new Map),g(this,"deferredUpdate",null),this.props={...F2,...e},this.stats=new lu({id:this.props.id}),this.stats.get(I2),this.stats.get(R2),this.stats.get(O2),this.stats.get(k2),this.stats.get(N2)}scheduleRequest(e,n=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}const{_parseImageNode:z2}=globalThis,qh=typeof Image<"u",Zh=typeof ImageBitmap<"u",U2=Boolean(z2),Kh=M2?!0:U2;function B2(t){switch(t){case"auto":return Zh||qh||Kh;case"imagebitmap":return Zh;case"image":return qh;case"data":return Kh;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function V2(){if(Zh)return"imagebitmap";if(qh)return"image";if(Kh)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function j2(t){const e=W2(t);if(!e)throw new Error("Not an image");return e}function G2(t){switch(j2(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function W2(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const H2=/^data:image\/svg\+xml/,$2=/\.svg((\?|#).*)?$/;function Rg(t){return t&&(H2.test(t)||$2.test(t))}function X2(t,e){if(Rg(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return bw(t,e)}function bw(t,e){if(Rg(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Sw(t,e,n){const r=X2(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Y2(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Y2(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const q2={};let b0=!0;async function Z2(t,e,n){let r;Rg(n)?r=await Sw(t,e,n):r=bw(t,n);const i=e&&e.imagebitmap;return await K2(r,i)}async function K2(t,e=null){if((Q2(e)||!b0)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),b0=!1}return await createImageBitmap(t)}function Q2(t){for(const e in t||q2)return!1;return!0}const pn=!1,wo=!0;function Pw(t){const e=ha(t);return J2(e)||nA(e)||eA(e)||tA(e)}function J2(t){const e=ha(t);return e.byteLength>=24&&e.getUint32(0,pn)===2303741511?{mimeType:"image/png",width:e.getUint32(16,pn),height:e.getUint32(20,pn)}:null}function eA(t){const e=ha(t);return e.byteLength>=10&&e.getUint32(0,pn)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,wo),height:e.getUint16(8,wo)}:null}function tA(t){const e=ha(t);return e.byteLength>=14&&e.getUint16(0,pn)===16973&&e.getUint32(2,wo)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,wo),height:e.getUint32(22,wo)}:null}function nA(t){const e=ha(t);if(!(e.byteLength>=3&&e.getUint16(0,pn)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=rA();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,pn);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,pn),width:e.getUint16(s+7,pn)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,pn)}return null}function rA(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function ha(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function iA(t,e){const{mimeType:n}=Pw(t)||{},r=globalThis._parseImageNode;return xw(r),await r(t,n)}async function sA(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=oA(i);let a;switch(o){case"imagebitmap":a=await Z2(t,e,s);break;case"image":a=await Sw(t,e,s);break;case"data":a=await iA(t);break;default:xw(!1)}return i==="data"&&(a=G2(a)),a}function oA(t){switch(t){case"auto":case"data":return V2();default:return B2(t),t}}const aA=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],lA=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],cA={image:{type:"auto",decode:!0}},Aw={id:"image",module:"images",name:"Images",version:L2,mimeTypes:lA,extensions:aA,parse:sA,tests:[t=>Boolean(Pw(new DataView(t)))],options:cA};function Cw(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&Boolean(process.versions.electron))return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Xn(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||Cw()}const Fl={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Ka=Fl.window||Fl.self||Fl.global,$s=Fl.process||{},Lw=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Xn();const Ef=globalThis;function Mw(t){if(!t&&!Xn())return"Node";if(Cw(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":Ef.chrome?"Chrome":Ef.safari?"Safari":Ef.mozInnerScreenX?"Firefox":"Unknown"}function uA(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class fA{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";g(this,"storage",void 0),g(this,"id",void 0),g(this,"config",void 0),this.storage=uA(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function hA(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function dA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Tf(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Sc;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Sc||(Sc={}));function S0(t){return typeof t=="string"?Sc[t.toUpperCase()]||Sc.WHITE:t}function gA(t,e,n){return!Xn&&typeof t=="string"&&(e&&(e=S0(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=S0(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function pA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function Pc(t,e){if(!t)throw new Error(e||"Assertion failed")}function yi(){let t;if(Xn&&"performance"in Ka){var e,n;t=Ka==null||(e=Ka.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in $s){var r;const i=$s==null||(r=$s.hrtime)===null||r===void 0?void 0:r.call($s);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const vi={debug:Xn&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},mA={enabled:!0,level:0};function Rt(){}const P0={},A0={once:!0};class Og{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};g(this,"id",void 0),g(this,"VERSION",Lw),g(this,"_startTs",yi()),g(this,"_deltaTs",yi()),g(this,"_storage",void 0),g(this,"userData",{}),g(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new fA("__probe-".concat(this.id,"__"),mA),this.timeStamp("".concat(this.id," started")),pA(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((yi()-this._startTs).toPrecision(10))}getDelta(){return Number((yi()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Pc(e,n)}warn(e){return this._getLogFunction(0,e,vi.warn,arguments,A0)}error(e){return this._getLogFunction(0,e,vi.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,vi.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,vi.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,vi.debug||vi.info,arguments,A0)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Rt,r&&[r],{tag:wA(n)}):Rt}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?Xn?_A({image:i,message:s,scale:o}):vA():Rt}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Rt)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=C0({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Rt)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Iw(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=C0({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Pc(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=yi();const o=s.tag||s.message;if(s.once)if(!P0[o])P0[o]=yi();else return Rt;return n=yA(this.id,s.message,s),r.bind(console,n,...s.args)}return Rt}}g(Og,"VERSION",Lw);function Iw(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Pc(Number.isFinite(e)&&e>=0),e}function C0(t){const{logLevel:e,message:n}=t;t.logLevel=Iw(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Pc(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function yA(t,e,n){if(typeof e=="string"){const r=n.time?dA(hA(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=gA(e,n.color,n.background)}return e}function vA(t){return console.warn("removed"),Rt}function _A(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=Tf(s,n,r);console.log(...o)},s.src=e,Rt}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Tf(e,n,r)),Rt;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Tf(s,n,r)),s.src=e.toDataURL(),Rt}return Rt}function wA(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const H=new Og({id:"deck"});let Qh={};function EA(t){Qh=t}function qe(t,e,n,r){H.level>0&&Qh[t]&&Qh[t].call(null,e,n,r)}function TA(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const xA={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:TA,parseTextSync:JSON.parse},Eo="8.8.20",Dl=globalThis.deck&&globalThis.deck.VERSION;if(Dl&&Dl!==Eo)throw new Error("deck.gl - multiple versions detected: ".concat(Dl," vs ").concat(Eo));Dl||(H.log(1,"deck.gl ".concat(Eo))(),globalThis.deck={...globalThis.deck,VERSION:Eo,version:Eo,log:H,_registerLoggers:EA},r2([xA,[Aw,{imagebitmap:{premultiplyAlpha:"none"}}]]));const bA=globalThis.deck,U=new Og({id:"luma.gl"});function rt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const SA="Invalid WebGLRenderingContext",PA="Requires WebGL2";function cu(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&Number.isFinite(t._version))}function X(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function AA(t){return X(t)?t:null}function uu(t){return rt(cu(t),SA),t}function Qe(t){return rt(X(t),PA),t}const oo={};function CA(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function LA(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function MA(t,e){oo[t]=!0,e!==void 0&&CA(e)}function IA(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(oo[r]=!0);while(r!==0);for(r in oo)if(oo[r])return delete oo[r],parseInt(r,10);return 0}}const da=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};da.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};da.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const ai=function(e){const n=this;this.gl=e,IA(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const f=n.currentVertexArrayObject;f.maxAttrib=Math.max(f.maxAttrib,s);const h=f.attribs[s];return h.buffer=n.currentArrayBuffer,h.size=o,h.type=a,h.normalized=l,h.stride=c,h.offset=u,h.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{LA("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};ai.prototype.VERTEX_ARRAY_BINDING_OES=34229;ai.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new da(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};ai.prototype.createVertexArrayOES=function(){const e=new da(this);return this.vertexArrayObjects.push(e),e};ai.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};ai.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof da&&e.hasBeenBound&&e.ext===this)};ai.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){MA(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=i?i.attribs[l]:null;if((!i||c.enabled!==u.enabled)&&(c.enabled?r.enableVertexAttribArray.call(n,l):r.disableVertexAttribArray.call(n,l)),c.enabled){let f=!1;(!i||c.buffer!==u.buffer)&&(o!==c.buffer&&(r.bindBuffer.call(n,34962,c.buffer),o=c.buffer),f=!0),(f||c.cached!==u.cached)&&r.vertexAttribPointer.call(n,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function RA(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new ai(this)),this.__OESVertexArrayObject))}}const L0="OES_element_index",M0="WEBGL_draw_buffers",OA="EXT_disjoint_timer_query",kA="EXT_disjoint_timer_query_webgl2",NA="EXT_texture_filter_anisotropic",I0="WEBGL_debug_renderer_info",FA=35723,DA=4352,zA=36795,UA=34047,BA=37445,VA=37446,se=t=>X(t)?void 0:0,jA={[3074]:t=>X(t)?void 0:36064,[FA]:t=>X(t)?void 0:DA,[35977]:se,[32937]:se,[zA]:(t,e)=>{const n=X(t)?t.getExtension(kA):t.getExtension(OA);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[BA]:(t,e)=>{const n=t.getExtension(I0);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[VA]:(t,e)=>{const n=t.getExtension(I0);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[UA]:(t,e)=>{const n=t.luma.extensions[NA];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:se,[35071]:se,[37447]:se,[36063]:(t,e)=>{if(!X(t)){const n=t.getExtension(M0);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:se,[35374]:se,[35377]:se,[34852]:t=>{if(!X(t)){const e=t.getExtension(M0);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(L0)?2147483647:65535,[33001]:t=>t.getExtension(L0)?16777216:65535,[33e3]:t=>16777216,[37157]:se,[35373]:se,[35657]:se,[36183]:se,[37137]:se,[34045]:se,[35978]:se,[35979]:se,[35968]:se,[35376]:se,[35375]:se,[35659]:se,[37154]:se,[35371]:se,[35658]:se,[35076]:se,[35077]:se,[35380]:se};function GA(t,e,n){const r=jA[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const WA="OES_vertex_array_object",Rw="ANGLE_instanced_arrays",HA="WEBGL_draw_buffers",$A="EXT_disjoint_timer_query",XA="EXT_texture_filter_anisotropic",YA="VertexArray requires WebGL2 or OES_vertex_array_object extension";function qA(t,e){return{webgl2:X(t),ext:t.getExtension(e)}}const Ow={[WA]:{meta:{suffix:"OES"},createVertexArray:()=>{rt(!1,YA)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[Rw]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){rt(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[HA]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{rt(!1)}},[$A]:{meta:{suffix:"EXT"},createQuery:()=>{rt(!1)},deleteQuery:()=>{rt(!1)},beginQuery:()=>{rt(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},xf={readBuffer:(t,e,n)=>{X(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=qA(t,Rw);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!X(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!X(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[XA];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:GA,hint(t,e,n,r){return e(n,r)}};function ZA(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(RA(t),KA(t),JA(t,Ow),QA(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=ZA;function KA(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function QA(t,e){let{target:n,target2:r}=e;Object.keys(xf).forEach(i=>{if(typeof xf[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=xf[i].bind(null,t,s);n[i]=o,r[i]=o}})}function JA(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&eC(t,{extension:n,target:t.luma,target2:t})}function eC(t,e){let{extension:n,target:r,target2:i}=e;const s=Ow[n];rt(s);const{meta:o={}}=s,{suffix:a=""}=o,l=t.getExtension(n);for(const c of Object.keys(s)){const u="".concat(c).concat(a);let f=null;c==="meta"||typeof t[c]=="function"||(l&&typeof l[u]=="function"?f=function(){return l[u](...arguments)}:typeof s[c]=="function"&&(f=s[c].bind(r))),f&&(r[c]=f,i[c]=f)}}const kg={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},Kn=(t,e,n)=>e?t.enable(n):t.disable(n),R0=(t,e,n)=>t.hint(n,e),mt=(t,e,n)=>t.pixelStorei(n,e),tC=(t,e)=>{const n=X(t)?36009:36160;return t.bindFramebuffer(n,e)},nC=(t,e)=>t.bindFramebuffer(36008,e);function Xs(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const rC={[3042]:Kn,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:Kn,[2885]:(t,e)=>t.cullFace(e),[2929]:Kn,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:Kn,[35723]:R0,[36006]:tC,[2886]:(t,e)=>t.frontFace(e),[33170]:R0,[2849]:(t,e)=>t.lineWidth(e),[32823]:Kn,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:Kn,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:Kn,[3088]:(t,e)=>t.scissor(...e),[2960]:Kn,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:mt,[3317]:mt,[37440]:mt,[37441]:mt,[37443]:mt,[3330]:mt,[3332]:mt,[3331]:mt,[36010]:nC,[3314]:mt,[32878]:mt,[3316]:mt,[3315]:mt,[32877]:mt,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Xs(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Xs(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Xs(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Xs(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Xs(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function _e(t,e,n){return e[t]!==void 0?e[t]:n[t]}const iC={blendEquation:(t,e,n)=>t.blendEquationSeparate(_e(32777,e,n),_e(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(_e(32969,e,n),_e(32968,e,n),_e(32971,e,n),_e(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(_e(32824,e,n),_e(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(_e(32938,e,n),_e(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,_e(2962,e,n),_e(2967,e,n),_e(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,_e(34816,e,n),_e(36003,e,n),_e(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,_e(2964,e,n),_e(2965,e,n),_e(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,_e(34817,e,n),_e(34818,e,n),_e(34819,e,n))},O0={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},ln=(t,e)=>t.isEnabled(e),k0={[3042]:ln,[2884]:ln,[2929]:ln,[3024]:ln,[32823]:ln,[32926]:ln,[32928]:ln,[3089]:ln,[2960]:ln,[35977]:ln};function kw(t){for(const e in t)return!1;return!0}function sC(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function N0(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function oC(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:l,oldValue:c}=n(t.state._updateCache,...o);return l&&r(...o),c},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function aC(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class lC{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?uC(e):Object.assign({},kg),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){rt(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Vn(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){rt(s!==void 0);const o=e[s],a=this.cache[s];sC(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function Nw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(rt(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new lC(t,{copyState:r}),aC(t);for(const s in O0){const o=O0[s];oC(t,s,o)}N0(t,"getParameter"),N0(t,"isEnabled")}return t.state.enable=n,t}function cC(t){t.state||Nw(t,{copyState:!1}),t.state.push()}function F0(t){rt(t.state),t.state.pop()}function Vn(t,e){if(rt(cu(t),"setParameters requires a WebGL context"),kw(e))return;const n={};for(const i in e){const s=Number(i),o=rC[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=iC[i];s(t,e,r)}}function uC(t,e){if(e=e||kg,typeof e=="number"){const i=e,s=k0[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=k0[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function fC(t){Vn(t,kg)}function Dt(t,e,n){if(kw(e))return n(t);const{nocatch:r=!0}=e;cC(t),Vn(t,e);let i;if(r)i=n(t),F0(t);else try{i=n(t)}finally{F0(t)}return i}function hs(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function bf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=hs(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return dC(e,r,i,s,n)}function hC(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function dC(t,e,n,r,i){const s=D0(t[0],e,n);let o=z0(t[1],e,r,i),a=D0(t[0]+1,e,n);const l=a===n-1?a:a-1;a=z0(t[1]+1,e,r,i);let c;return i?(a=a===0?a:a+1,c=o,o=a):c=a===r-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}function D0(t,e,n){return Math.min(Math.round(t*e),n-1)}function z0(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Ng=Xn(),gC=Ng&&typeof document<"u",Fw={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Dw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};rt(Ng,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},Fw,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=vC({canvas:s,width:e,height:n,onError:r});return i=yC(o,t),i?(i=Fg(i,t),_C(i),i):null}function Fg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||wC(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Fw,e);const{manageState:n,debug:r}=e;return n&&Nw(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return U.log(1,...s)()}}),Ng&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),U.level=Math.max(U.level,1)):U.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function pC(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function mC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=hC(e.useDevicePixels);EC(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function yC(t,e){const{onError:n}=e;let r=null;const i=l=>r=l.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function vC(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(gC&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function _C(t){const e=X(t)?"WebGL2":"WebGL1",n=pC(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";U.info(1,"".concat(e).concat(i," context ").concat(r))()}function wC(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function EC(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(U.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);t.canvas.width=a,t.canvas.height=l,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==l)&&(U.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const To="8.5.18",TC="set luma.log.level=1 (or higher) to trace rendering";class xC{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new lu({id:e})),this.stats.get(e)}}const Vr=new xC;if(globalThis.luma&&globalThis.luma.VERSION!==To)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(To));globalThis.luma||(Xn()&&U.log(1,"luma.gl ".concat(To," - ").concat(TC))(),globalThis.luma=globalThis.luma||{VERSION:To,version:To,log:U,stats:Vr,globals:{modules:{},nodeIO:{}}});function bC(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function SC(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function k(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Sf(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return k(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function _r(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const Pf={};function Tr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Pf[t]=Pf[t]||1;const e=Pf[t]++;return"".concat(t,"-").concat(e)}function U0(t){return k(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function ds(t){let e=!0;for(const n in t){e=!1;break}return e}function zw(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw U.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const _i="Resource subclass must define virtual methods";let Yn=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};uu(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Tr(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Sf(this.gl,e),k(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=X(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,l="webgl2"in i?i.webgl2:i.webgl1;return s?l:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=X(this.gl),o={},a=n||Object.keys(i);for(const l of a){const c=i[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const f=r?_r(this.gl,l):l;o[f]=this.getParameter(l,e),r&&c.type==="GLenum"&&(o[f]=_r(this.gl,o[f]))}}return o}setParameter(e,n){e=Sf(this.gl,e),k(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=X(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=Sf(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return zw(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(_i)}_deleteHandle(){throw new Error(_i)}_bindHandle(e){throw new Error(_i)}_getOptsFromHandle(){throw new Error(_i)}_getParameter(e,n){throw new Error(_i)}_setParameter(e,n){throw new Error(_i)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Vr.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Vr.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Vr.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=Vr.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const PC="Failed to deduce GL constant from typed array";function Jh(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(PC)}}function Ho(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function AC(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const l=a*o,c=(r-a-1)*o;s.set(e.subarray(l,l+o)),e.copyWithin(l,c,c+o),e.set(s,c)}}function CC(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let l=0;l<i;l++)for(let c=0;c<4;c++)o[(a*i+l)*4+c]=e[(a*2*n+l*2)*4+c];return{data:o,width:i,height:s}}function ed(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const c=r[a]?"".concat(t,".").concat(r[a]):"N/A";U.removed("".concat(t,".").concat(a),c)()}for(const a in i)if(a in e){const l=i[a];U.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))()}let o=null;for(const a in s)if(a in e){const l=s[a];U.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const LC={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},MC={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class wt{static getBytesPerElement(e){return Ho(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return k(e.size),Ho(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new wt(LC,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return wt.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return wt.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=ed("Accessor",e,MC),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const B0=10,Uw={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},IC={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Uw},RC={removedProps:Uw};class re extends Yn{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/wt.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/wt.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=ed("Buffer",e,IC),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=ed("Buffer",e,RC),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new wt(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;k(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(Qe(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return Qe(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Qe(this.gl);const s=Ho(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,i||o),c=a+l);const u=Math.min(o,l);return i=i||u,k(i<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(k(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(B0,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;k(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,B0),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=Jh(e);return k(s),this.setAccessor(new wt(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;k(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Ho(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new wt(this.accessor,{type:Jh(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return U.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return U.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return U.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return U.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new wt(this.accessor,e),this}}const Dg={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},Bw={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},Vw={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function OC(t,e){const n=Dg[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=X(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function kC(t,e){const n=Dg[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const NC=[9729,9728],V0=globalThis.WebGLBuffer||function(){};class Kr extends Yn{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&OC(e,r),s=s&&(!i||kC(e,r))),s}constructor(e,n){const{id:r=Tr("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(y=>this.initialize(Object.assign({},e,{pixels:y,data:y}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u=void 0}=e;n||(n=i);let{width:f,height:h,dataFormat:d,type:p,compressed:m=!1,mipmaps:T=!0}=e;const{depth:v=0}=e;return{width:f,height:h,compressed:m,dataFormat:d,type:p}=this._deduceParameters({format:s,type:p,dataFormat:d,compressed:m,data:n,width:f,height:h}),this.width=f,this.height=h,this.depth=v,this.format=s,this.type=p,this.dataFormat=d,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),T&&this._isNPOT()&&(U.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),T=!1,this._updateForNPOT(l)),this.mipmaps=T,this.setImageData({data:n,width:f,height:h,depth:v,format:s,type:p,dataFormat:d,border:o,mipmaps:T,parameters:c,compressed:m}),T&&this.generateMipmap(),this.setParameters(l),a&&(this.data=n),r&&(this._video={video:n,parameters:l,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(U.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Dt(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:f=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:p=!1}=e;c||(c=r),{type:u,dataFormat:d,compressed:p,width:f,height:h}=this._deduceParameters({format:s,type:u,dataFormat:d,compressed:p,data:c,width:f,height:h});const{gl:m}=this;m.bindTexture(this.target,this.handle);let T=null;({data:c,dataType:T}=this._getDataType({data:c,compressed:p}));let v,y=0;if(Dt(this.gl,l,()=>{switch(T){case"null":m.texImage2D(n,i,s,f,h,o,d,u,c);break;case"typed-array":m.texImage2D(n,i,s,f,h,o,d,u,c,a);break;case"buffer":v=Qe(m),v.bindBuffer(35052,c.handle||c),v.texImage2D(n,i,s,f,h,o,d,u,a),v.bindBuffer(35052,null);break;case"browser-object":X(m)?m.texImage2D(n,i,s,f,h,o,d,u,c):m.texImage2D(n,i,s,d,u,c);break;case"compressed":for(const[w,x]of c.entries())m.compressedTexImage2D(n,w,x.format,x.width,x.height,o,x.data),y+=x.levelSize;break;default:k(!1,"Unknown image data type")}}),T==="compressed")this._trackAllocatedMemory(y,"Texture");else if(c&&c.byteLength)this._trackAllocatedMemory(c.byteLength,"Texture");else{const w=Bw[this.dataFormat]||4,x=Vw[this.type]||1;this._trackAllocatedMemory(this.width*this.height*w*x,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:c=0,format:u=this.format,type:f=this.type,dataFormat:h=this.dataFormat,compressed:d=!1,offset:p=0,border:m=this.border,parameters:T={}}=e;if({type:f,dataFormat:h,compressed:d,width:a,height:l}=this._deduceParameters({format:u,type:f,dataFormat:h,compressed:d,data:i,width:a,height:l}),k(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const v=i;i=v.data,a=v.shape[0],l=v.shape[1]}i instanceof re&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Dt(this.gl,T,()=>{if(d)this.gl.compressedTexSubImage2D(n,c,s,o,a,l,u,i);else if(i===null)this.gl.texSubImage2D(n,c,s,o,a,l,h,f,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,c,s,o,a,l,h,f,i,p);else if(i instanceof V0){const v=Qe(this.gl);v.bindBuffer(35052,i),v.texSubImage2D(n,c,s,o,a,l,h,f,p),v.bindBuffer(35052,null)}else X(this.gl)?Qe(this.gl).texSubImage2D(n,c,s,o,a,l,h,f,i):this.gl.texSubImage2D(n,c,s,o,h,f,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return U.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof re?{data:n.handle,dataType:"buffer"}:n instanceof V0?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:l}=e;const c=Dg[n];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:l,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},k(i,"Could not deduced texture size"),k(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),k(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:k(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return X(this.gl)||!this.width||!this.height?!1:!U0(this.width)||!U0(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:NC.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let FC="";function DC(t,e){return k(typeof t=="string"),t=FC+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class ot extends Kr{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Kr.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};uu(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:DC(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const td=[34069,34070,34071,34072,34073,34074];class jw extends Kr{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};uu(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:l=5121}=e;const{gl:c}=this,u=i||s,f=await Promise.all(td.map(h=>{const d=u[h];return Promise.all(Array.isArray(d)?d:[d])}));this.bind(),td.forEach((h,d)=>{f[d].length>1&&this.opts.mipmaps!==!1&&U.warn("".concat(this.id," has mipmap and multiple LODs."))(),f[d].forEach((p,m)=>{n&&r?c.texImage2D(h,m,a,n,r,o,a,l,p):c.texImage2D(h,m,a,a,l,p)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:l=6408,type:c=5121}=e,{gl:u}=this,f=s||o;return this.bind(),f instanceof Promise?f.then(h=>this.setImageDataForFace(Object.assign({},e,{face:n,data:h,pixels:h}))):this.width||this.height?u.texImage2D(n,0,l,r,i,a,l,c,f):u.texImage2D(n,0,l,l,c,f),this}}jw.FACES=td;class zC extends Kr{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return X(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qe(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:l,type:c=5121,offset:u=0,data:f,parameters:h={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Dt(this.gl,h,()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,l,c,f),f instanceof re&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,l,c,u))}),f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const d=Bw[this.dataFormat]||4,p=Vw[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*d*p,"Texture")}return this.loaded=!0,this}}const Rr="EXT_color_buffer_float",j0={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:Rr,bpp:2},[33327]:{gl2:Rr,bpp:4},[34842]:{gl2:Rr,bpp:8},[33326]:{gl2:Rr,bpp:4},[33328]:{gl2:Rr,bpp:8},[34836]:{gl2:Rr,bpp:16},[35898]:{gl2:Rr,bpp:4}};function UC(t,e,n){const r=n[e];if(!r)return!1;const i=X(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class ji extends Yn{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||UC(e,n,j0)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return k(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&X(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*j0[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const BC=256,VC=1024,jC=16384,G0=6144,W0=6145,H0=6146,$0=34041,Gw="clear: bad arguments";function zg(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=jC,n!==!0&&(s.clearColor=n)),r&&(o|=BC,r!==!0&&(s.clearDepth=r)),i&&(o|=VC,r!==!0&&(s.clearStencil=r)),k(o!==0,Gw),Dt(t,s,()=>{t.clear(o)})}function GC(t){let{framebuffer:e=null,buffer:n=G0,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qe(t),Dt(t,{framebuffer:e},()=>{switch(n){case G0:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case W0:t.clearBufferfv(W0,0,[i]);break;case H0:t.clearBufferiv(H0,0,[i]);break;case $0:const[s,o]=i;t.clearBufferfi($0,0,s,o);break;default:k(!1,Gw)}})}function WC(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return k(!1),0}}function fu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:f}=Ww(t);k(u);const{gl:h,handle:d,attachments:p}=u;a=a||u.width,l=l||u.height,s===36064&&d===null&&(s=1028),k(p[s]),c=c||p[s].type,o=$C(o,c,i,a,l),c=c||Jh(o);const m=h.bindFramebuffer(36160,d);return h.readPixels(n,r,a,l,i,c,o),h.bindFramebuffer(36160,m||null),f&&u.delete(),o}function X0(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=fu(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=CC({data:r,width:i,height:s}));AC({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),l=a.createImageData(i,s);return l.data.set(r),a.putImageData(l,0,0),o.toDataURL()}function HC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=n;let{targetX:a,targetY:l,targetZ:c,width:u,height:f}=n;const{framebuffer:h,deleteFramebuffer:d}=Ww(t);k(h);const{gl:p,handle:m}=h,T=typeof a<"u"||typeof l<"u"||typeof c<"u";a=a||0,l=l||0,c=c||0;const v=p.bindFramebuffer(36160,m);k(e);let y=null;if(e instanceof Kr&&(y=e,u=Number.isFinite(u)?u:y.width,f=Number.isFinite(f)?f:y.height,y.bind(0),e=y.target),!T)p.copyTexImage2D(e,s,o,r,i,u,f,0);else switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,s,a,l,r,i,u,f);break;case 35866:case 32879:Qe(p).copyTexSubImage3D(e,s,a,l,c,r,i,u,f);break}return y&&y.unbind(),p.bindFramebuffer(36160,v||null),d&&h.delete(),y}function Ww(t){return t instanceof Ce?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:nL(t),deleteFramebuffer:!0}}function $C(t,e,n,r,i){if(t)return t;e=e||5121;const s=Ho(e,{clamped:!1}),o=WC(n);return new s(r*i*o)}const ce={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function XC(t){const e=new ot(t,{format:6408,type:5126,dataFormat:6408}),n=new Ce(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const Hw={[ce.WEBGL2]:[!1,!0],[ce.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ce.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ce.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ce.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ce.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ce.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ce.FLOAT_BLEND]:["EXT_float_blend"],[ce.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ce.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ce.TEXTURE_FLOAT]:["OES_texture_float",!0],[ce.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ce.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ce.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ce.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ce.COLOR_ATTACHMENT_RGBA32F]:[XC,"EXT_color_buffer_float"],[ce.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ce.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ce.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ce.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ce.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ce.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},YC=2;function qC(t,e){return Ug(t,e)}function Ug(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>$w(t,n))}function ZC(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Hw)t.luma.caps[e]===void 0&&(t.luma.caps[e]=$w(t,e));return t.luma.caps}function $w(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=KC(t,e)),t.luma.caps[e]||U.log(YC,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function KC(t,e){const n=Hw[e];k(n,e);let r;const i=X(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&Boolean(t.getExtension(s))}else typeof i=="string"?r=Boolean(t.getExtension(i)):typeof i=="boolean"?r=i:k(!1);return r}const Y0="Multiple render targets not supported";class Ce extends Yn{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Ce(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Qe(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Qe(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:l=!0,readBuffer:c=void 0,drawBuffers:u=void 0}=e;if(k(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const f in i){const h=i[f];(Array.isArray(h)?h[0]:h).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:c,drawBuffers:u}),i&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,l=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,l||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return k(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&U.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){k(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),l=i[a];let c=l;if(!c)this._unattach(a);else if(c instanceof ji)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,f=0,h=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:f,level:h})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});r&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(JC(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&zg(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,l)=>{GC(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return U.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return U.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return U.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return U.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return U.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return U.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=Qe(this.gl),l=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,l),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=_r(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?_r(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?_r(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(X0(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>U.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=X0(this,{targetMaxHeight:100});return U.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new ot(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new ji(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new ji(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&k(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof ji?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Qe(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const l=QC(i);o.framebufferTexture2D(36160,n,l,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:k(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=AA(this.gl);n?n.readBuffer(e):k(e===36064||e===1029,Y0),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Qe(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):k(e.length===1&&(e[0]===36064||e[0]===1029),Y0)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=ZC(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function QC(t){return t<34069?t+34069:t}function JC(t){return(Ce.STATUS||{})[t]||"Framebuffer error ".concat(t)}const eL=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Ce.ATTACHMENT_PARAMETERS=eL;function tL(t,e){k(t instanceof ot||t instanceof jw||t instanceof zC);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=t,f=Object.assign({width:i,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},e);return new n(r,f)}function nL(t,e){const{gl:n,width:r,height:i,id:s}=t;return new Ce(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function zl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const rL=35632,iL=35633;function sL(t){switch(t){case rL:return"fragment";case iL:return"vertex";default:return"unknown type"}}function oL(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||zl(e)||"(unnamed)",l="".concat(sL(n)," shader ").concat(a);for(let u=0;u<i.length;u++){const f=i[u];if(f.length<=1)continue;const h=f.split(":"),d=h[0],p=parseInt(h[2],10);if(isNaN(p))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));d!=="WARNING"?s[p]=f:o[p]=f}const c=aL(e);return{shaderName:l,errors:q0(s,c),warnings:q0(o,c)}}function q0(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0,c=s.substring(o.join(":").length+1).trim();n+=Xw("^^^ ".concat(a,": ").concat(c,`

`),l)}}return n}function aL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),l=a.length;return Xw(a,i-l)+n+s})}function Xw(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function Yw(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const lL="Shader: GLSL source code must be a JavaScript string";class $o extends Yn{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return k(!1),"unknown"}}constructor(e,n){uu(e),k(typeof n.source=="string",lL);const r=zl(n.source,null)||n.id||Tr("unnamed ".concat($o.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=zl(n,null);r&&(this.id=Tr(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat($o.getTypeName(this.shaderType),":").concat(this.id)}getName(){return zl(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=oL(r,this.source,this.shaderType,this.id);throw U.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),U.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Af extends $o{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Cf extends $o{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const cL={[5126]:ae.bind(null,"uniform1fv",yt,1,Xe),[35664]:ae.bind(null,"uniform2fv",yt,2,Xe),[35665]:ae.bind(null,"uniform3fv",yt,3,Xe),[35666]:ae.bind(null,"uniform4fv",yt,4,Xe),[5124]:ae.bind(null,"uniform1iv",Qn,1,Xe),[35667]:ae.bind(null,"uniform2iv",Qn,2,Xe),[35668]:ae.bind(null,"uniform3iv",Qn,3,Xe),[35669]:ae.bind(null,"uniform4iv",Qn,4,Xe),[35670]:ae.bind(null,"uniform1iv",Qn,1,Xe),[35671]:ae.bind(null,"uniform2iv",Qn,2,Xe),[35672]:ae.bind(null,"uniform3iv",Qn,3,Xe),[35673]:ae.bind(null,"uniform4iv",Qn,4,Xe),[35674]:ae.bind(null,"uniformMatrix2fv",yt,4,Pn),[35675]:ae.bind(null,"uniformMatrix3fv",yt,9,Pn),[35676]:ae.bind(null,"uniformMatrix4fv",yt,16,Pn),[35678]:ze,[35680]:ze,[5125]:ae.bind(null,"uniform1uiv",Qa,1,Xe),[36294]:ae.bind(null,"uniform2uiv",Qa,2,Xe),[36295]:ae.bind(null,"uniform3uiv",Qa,3,Xe),[36296]:ae.bind(null,"uniform4uiv",Qa,4,Xe),[35685]:ae.bind(null,"uniformMatrix2x3fv",yt,6,Pn),[35686]:ae.bind(null,"uniformMatrix2x4fv",yt,8,Pn),[35687]:ae.bind(null,"uniformMatrix3x2fv",yt,6,Pn),[35688]:ae.bind(null,"uniformMatrix3x4fv",yt,12,Pn),[35689]:ae.bind(null,"uniformMatrix4x2fv",yt,8,Pn),[35690]:ae.bind(null,"uniformMatrix4x3fv",yt,12,Pn),[35678]:ze,[35680]:ze,[35679]:ze,[35682]:ze,[36289]:ze,[36292]:ze,[36293]:ze,[36298]:ze,[36299]:ze,[36300]:ze,[36303]:ze,[36306]:ze,[36307]:ze,[36308]:ze,[36311]:ze},uL={},fL={},hL={},Z0=[0];function Bg(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(Z0[0]=t,t=Z0);const i=t.length;if(i%e&&U.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function yt(t,e){return Bg(t,e,Float32Array,uL)}function Qn(t,e){return Bg(t,e,Int32Array,fL)}function Qa(t,e){return Bg(t,e,Uint32Array,hL)}function K0(t,e,n){const r=cL[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function dL(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:Boolean(n[2])}}function gL(t,e,n){for(const r in t){const i=t[r];if((!n||Boolean(n[r]))&&!pL(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function pL(t){return Array.isArray(t)||ArrayBuffer.isView(t)?yL(t):isFinite(t)||t===!0||t===!1||t instanceof Kr||t instanceof ji?!0:t instanceof Ce?Boolean(t.texture):!1}function mL(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function yL(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ze(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function ae(t,e,n,r){let i=null,s=null;return(o,a,l)=>{const c=e(l,n),u=c.length;let f=!1;if(i===null)i=new Float32Array(u),s=u,f=!0;else{k(s===u,"Uniform length cannot change.");for(let h=0;h<u;++h)if(c[h]!==i[h]){f=!0;break}}return f&&(r(o,t,a,c),i.set(c)),f}}function Xe(t,e,n,r){t[e](n,r)}function Pn(t,e,n,r){t[e](n,!1,r)}const vL=5120,_L=5121,wL=5122,EL=5123,Q0=0,Ja=1,TL=2,xL=3,el=4,bL=5,SL=6,Me=5126,PL=35664,AL=35665,CL=35666,Ys=5124,LL=35667,ML=35668,IL=35669,qs=5125,RL=36294,OL=36295,kL=36296,NL=35670,FL=35671,DL=35672,zL=35673,UL=35674,BL=35675,VL=35676,jL=35685,GL=35686,WL=35687,HL=35688,$L=35689,XL=35690,nd={[Me]:[Me,1,"float"],[PL]:[Me,2,"vec2"],[AL]:[Me,3,"vec3"],[CL]:[Me,4,"vec4"],[Ys]:[Ys,1,"int"],[LL]:[Ys,2,"ivec2"],[ML]:[Ys,3,"ivec3"],[IL]:[Ys,4,"ivec4"],[qs]:[qs,1,"uint"],[RL]:[qs,2,"uvec2"],[OL]:[qs,3,"uvec3"],[kL]:[qs,4,"uvec4"],[NL]:[Me,1,"bool"],[FL]:[Me,2,"bvec2"],[DL]:[Me,3,"bvec3"],[zL]:[Me,4,"bvec4"],[UL]:[Me,8,"mat2"],[jL]:[Me,8,"mat2x3"],[GL]:[Me,8,"mat2x4"],[BL]:[Me,12,"mat3"],[WL]:[Me,12,"mat3x2"],[HL]:[Me,12,"mat3x4"],[VL]:[Me,16,"mat4"],[$L]:[Me,16,"mat4x2"],[XL]:[Me,16,"mat4x3"]};function YL(t){switch(t){case Q0:return Q0;case Ja:return Ja;case xL:return Ja;case TL:return Ja;case el:return el;case bL:return el;case SL:return el;default:return k(!1),0}}function J0(t){const e=nd[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function qw(t,e){switch(t){case vL:case _L:case wL:case EL:t=Me;break}for(const n in nd){const[r,i,s]=nd[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class qL{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),l=n.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!X(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=J0(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const l={location:e,name:n,accessor:new wt(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=J0(r),a=new wt({type:s,size:i*o}),l={location:e,name:n,accessor:a};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const ey=4,ZL=35981,KL=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Zw extends Yn{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",KL),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=ZL}=e;return this.hash=n||"",this.vs=typeof r=="string"?new Af(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new Cf(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,k(this.vs instanceof Af),k(this.fs instanceof Cf),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Qe(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new qL(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:l=!1,indexType:c=5123,instanceCount:u=0,isInstanced:f=u>0,vertexArray:h=null,transformFeedback:d,framebuffer:p,parameters:m={},uniforms:T,samplers:v}=e;if((T||v)&&(U.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(T||{})),U.priority>=n){const y=p?p.id:"default",w="mode=".concat(_r(this.gl,r)," verts=").concat(i," ")+"instances=".concat(u," indexType=").concat(_r(this.gl,c)," ")+"isInstanced=".concat(f," isIndexed=").concat(l," ")+"Framebuffer=".concat(y);U.log(n,w)()}return k(h),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||f&&u===0?!1:(h.bindForDraw(i,u,()=>{if(p!==void 0&&(m=Object.assign({},m,{framebuffer:p})),d){const y=YL(r);d.begin(y)}this._bindTextures(),Dt(this.gl,m,()=>{l&&f?this.gl2.drawElementsInstanced(r,i,c,s,u):l&&X(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,c,s):l?this.gl.drawElements(r,i,c,s):f?this.gl2.drawArraysInstanced(r,s,i,u):this.gl.drawArrays(r,s,i)}),d&&d.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};U.priority>=2&&gL(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof Ce&&(s=s.texture),s instanceof Kr)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=i;a.bind(l),s=l,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&mL(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new Af({handle:i});break;case 35632:r.fs=new Cf({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Tr(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),U.time(ey,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),U.timeEnd(ey,"linkProgram for ".concat(this._getName()))(),e.debug||U.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=dL(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=K0(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=K0(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const QL=34918,JL=34919,e3=35007,t3=36795,n3=35976,r3=35887,i3=36202;class Ac extends Yn{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=X(e),i=Ug(e,ce.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:k(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(e3)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?i3:r3)}beginTransformFeedbackQuery(){return this.begin(n3)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,JL);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(t3)}getResult(){return this.gl2.getQueryParameter(this.handle,QL)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Ac.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class Kw extends Yn{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return X(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qe(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,ds(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,U.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof re?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let tl=null;function s3(t){return(!tl||tl.byteLength<t)&&(tl=new ArrayBuffer(t)),tl}function o3(t,e){const n=s3(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function a3(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const l3="elements must be GL.ELEMENT_ARRAY_BUFFER";class vt extends Yn{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?X(e)||Mw()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new vt(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return vt.MAX_ATTRIBUTES=vt.MAX_ATTRIBUTES||e.getParameter(34921),vt.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:vt._setConstantFloatArray(e,n,r);break;case Int32Array:vt._setConstantIntArray(e,n,r);break;case Uint32Array:vt._setConstantUintArray(e,n,r);break;default:k(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return vt.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return k(!e||e.target===34963,l3),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=r,{gl:f,gl2:h}=this;return e=Number(e),this.bind(()=>{f.bindBuffer(34962,n.handle),c?(k(X(f)),h.vertexAttribIPointer(e,i,s,o,a)):f.vertexAttribPointer(e,i,s,l,o,a),f.enableVertexAttribArray(e),h.vertexAttribDivisor(e,u||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!vt.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new re(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=o3(n.constructor,s);a3({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:k(!1)}}static _setConstantIntArray(e,n,r){switch(k(X(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:k(!1)}}static _setConstantUintArray(e,n,r){switch(k(X(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:k(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return k(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const c3="VertexArray: attributes must be Buffers or constants (i.e. typed array)",u3=/^(.+)__LOCATION_([0-9]+)$/,f3=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class h3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new vt(e),zw(this,"VertexArray","v6.0",f3),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new re(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof re&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof re&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,U.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const c=this.accessors[o]||{},u=wt.resolve(l.accessor,c,r,i),{size:f,type:h}=u;return k(Number.isFinite(f)&&Number.isFinite(h)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=u3.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof re)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof re){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof re){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(c3)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(vt.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){vt.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof re){const a=r;if(o){const l=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return U.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function d3(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=Xo(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Xo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return d3(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function ty(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;k(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,l={},c=Object.keys(a).sort();let u=0;for(const d of c)!d.match(s)&&!d.match(o)&&Lf({table:l,header:e,uniforms:r,uniformName:d,undefinedOnly:i})&&u++;for(const d of c)d.match(o)&&Lf({table:l,header:e,uniforms:r,uniformName:d,undefinedOnly:i})&&u++;for(const d of c)l[d]||Lf({table:l,header:e,uniforms:r,uniformName:d,undefinedOnly:i})&&u++;let f=0;const h={};if(!i)for(const d in r){const p=r[d];l[d]||(f++,h[d]={Type:"NOT USED: ".concat(p),[e]:Xo(p)})}return{table:l,count:u,unusedTable:h,unusedCount:f}}function Lf(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=g3(o);return!s||!a?(e[i]={[n]:a?Xo(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function g3(t){return t!=null}function p3(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=ny(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const l=e.accessors[o.location];l&&(a="".concat(s,": ").concat(m3(o.name,l))),r[a]=ny(e,i[s],l,n)}}return r}function ny(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,l=0,c,u,f;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),c=s.indexOf("nt")!==-1),e instanceof re){const h=e,{data:d,changed:p}=h.getDebugData();u=p?"*":"",f=d,l=h.byteLength,a=l/d.BYTES_PER_ELEMENT/o;let m;if(n){const T=n.divisor>0;m="".concat(T?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(l," bytes ").concat(_r(i,s),")")}else c=!0,m="".concat(l," bytes");return{[r]:"".concat(u).concat(Xo(f,{size:o,isInteger:c})),"Format ":m}}return f=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=s.indexOf("nt")!==-1,{[r]:"".concat(Xo(f,{size:o,isInteger:c})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function m3(t,e){const{type:n,size:r}=e,i=qw(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function y3(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=ry(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=ry(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function ry(t){const{type:e,size:n}=t.accessor,r=qw(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const iy=Xn()&&typeof document<"u";let v3=0;class _3{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=T=>Dw(T),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:f=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:p=Vr.get("animation-loop-".concat(v3++))}=e;let{useDevicePixels:m=!0}=e;"useDevicePixelRatio"in e&&(U.deprecated("useDevicePixelRatio","useDevicePixels")(),m=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=p,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:m}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return k(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Ac.isSupported(this.gl,["timers"])?new Ac(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return U.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=iy?new Promise((e,n)=>{if(iy&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):SC(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):bC(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?Fg(this.props.gl,e):this.onCreateContext(e),!cu(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");fC(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&mC(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Ce(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const ga="vs",Vg="fs";function bt(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Mf={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function w3(t){const e={};for(const n in t){const r=t[n],i=E3(r);e[n]=i}return e}function E3(t){let e=sy(t);return e==="object"?t?"type"in t?Object.assign({},t,Mf[t.type]):"value"in t?(e=sy(t.value),Object.assign({type:e},t,Mf[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Mf[e])}function sy(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const T3="vs",x3="fs";class oy{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:l=[],defines:c={},inject:u={},vertexShader:f,fragmentShader:h}=e;bt(typeof n=="string"),this.name=n,this.vs=r||f,this.fs=i||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=c,this.injections=b3(u),o&&(this.uniforms=w3(o))}getModuleSource(e){let n;switch(e){case T3:n=this.vs||"";break;case x3:n=this.fs||"";break;default:bt(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&bt(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function b3(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function S3(t){return P3(Jw(t))}function P3(t){const e={},n={};return Qw({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function Qw(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&Qw({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function Jw(t,e){return t.map(n=>(n instanceof oy||(bt(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),bt(n.name,"shader module has no name"),n=new oy(n),n.dependencies=Jw(n.dependencies)),n))}function A3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const C3=7936,L3=7937,M3=7938,I3=35724,jg={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Dr={};Object.keys(jg).forEach(t=>{Dr[t]=t});function R3(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function O3(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||C3),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||L3);return{gpuVendor:k3(n,r),vendor:n,renderer:r,version:t.getParameter(M3),shadingLanguageVersion:t.getParameter(I3)}}function k3(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const If={};function ay(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=jg[e];if(bt(r,e),!A3(n))return!0;if(e in If)return If[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),If[e]=l,l}function N3(t,e){const n=jg[e];bt(n,e);const r=R3(t)&&n[1]||n[0],i=typeof r=="string"?Boolean(t.getExtension(r)):r;return bt(i===!1||i===!0),i}function nl(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>N3(t,n))}function F3(t){switch(O3(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function D3(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return nl(t,Dr.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),nl(t,Dr.GLSL_DERIVATIVES)&&ay(t,Dr.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),nl(t,Dr.GLSL_FRAG_DATA)&&ay(t,Dr.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),nl(t,Dr.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const z3=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,U3=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,B3={[ga]:z3,[Vg]:U3},Ul="__LUMA_INJECT_DECLARATIONS__",ly=/void\s+main\s*\([^)]*\)\s*\{\n?/,cy=/}\n?[^{}]*$/,Rf=[];function uy(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===ga;for(const s in n){const o=n[s];o.sort((l,c)=>l.order-c.order),Rf.length=o.length;for(let l=0,c=o.length;l<c;++l)Rf[l]=o[l].injection;const a="".concat(Rf.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(Ul,a));break;case"vs:#main-start":i&&(t=t.replace(ly,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(cy,l=>a+l));break;case"fs:#decl":i||(t=t.replace(Ul,a));break;case"fs:#main-start":i||(t=t.replace(ly,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(cy,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(Ul,""),r&&(t=t.replace(/\}\s*$/,s=>s+B3[e])),t}function rd(t){const e={};return bt(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function gs(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const eE=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],V3=[...eE,[gs("attribute"),"in $1"],[gs("varying"),"out $1"]],j3=[...eE,[gs("varying"),"in $1"]],tE=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],G3=[...tE,[gs("in"),"attribute $1"],[gs("out"),"varying $1"]],W3=[...tE,[gs("in"),"varying $1"]],id="gl_FragColor",sd=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,H3=/void\s+main\s*\([^)]*\)\s*\{\n?/;function $3(t,e,n){switch(e){case 300:return n?Cc(t,V3):X3(t);case 100:return n?Cc(t,G3):Y3(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Cc(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function X3(t){t=Cc(t,j3);const e=t.match(sd);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(id,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(H3,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(id,"\\b"),"g"),n)}return t}function Y3(t){t=Cc(t,W3);const e=t.match(sd);if(e){const n=e[1];t=t.replace(sd,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),id)}return t}const q3=`

`.concat(Ul,`

`),nE={[ga]:"vertex",[Vg]:"fragment"},Z3=`precision highp float;

`;function K3(t,e){const{vs:n,fs:r}=e,i=S3(e.modules||[]);return{gl:t,vs:fy(t,Object.assign({},e,{source:n,type:ga,modules:i})),fs:fy(t,Object.assign({},e,{source:r,type:Vg,modules:i})),getUniforms:Q3(i)}}function fy(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:c=!1,prologue:u=!0,log:f}=e;bt(typeof r=="string","shader source must be a string");const h=i===ga,d=r.split(`
`);let p=100,m="",T=r;d[0].indexOf("#version ")===0?(p=300,m=d[0],T=d.slice(1).join(`
`)):m="#version ".concat(p);const v={};s.forEach(C=>{Object.assign(v,C.getDefines())}),Object.assign(v,o);let y=u?"".concat(m,`
`).concat(eM({id:n,source:r,type:i}),`
`).concat(J3({type:i}),`
`).concat(F3(t),`
`).concat(D3(t),`
`).concat(tM(v),`
`).concat(h?"":Z3,`
`):"".concat(m,`
`);const w=rM(a),x={},S={},P={};for(const C in l){const M=typeof l[C]=="string"?{injection:l[C],order:0}:l[C],O=C.match(/^(v|f)s:(#)?([\w-]+)$/);if(O){const I=O[2],B=O[3];I?B==="decl"?S[C]=[M]:P[C]=[M]:x[C]=[M]}else P[C]=[M]}for(const C of s){f&&C.checkDeprecations(T,f);const M=C.getModuleSource(i,p);y+=M;const O=C.injections[i];for(const I in O){const B=I.match(/^(v|f)s:#([\w-]+)$/);if(B){const V=B[2]==="decl"?S:P;V[I]=V[I]||[],V[I].push(O[I])}else x[I]=x[I]||[],x[I].push(O[I])}}return y+=q3,y=uy(y,i,S),y+=nM(w[i],x),y+=T,y=uy(y,i,P),y=$3(y,c?100:p,h),y}function Q3(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function J3(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(nE[e].toUpperCase(),`
`)}function eM(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(nE[r],`

`):""}function tM(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function nM(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function rM(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const iM="void main() {gl_FragColor = vec4(0);}",rE=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,sM=`#version 300 es
`.concat(rE);function iE(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function sE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?sM:e>300?"#version ".concat(e,`
`).concat(rE):iM;const s=lM(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function oM(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return bt(!1),null}}function aM(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return bt(!1),null}}function lM(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return bt(!1),null}}const cM=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,uM={name:"fp32",vs:cM,fs:null};function Yo(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const it={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function fM(t,{precision:e=it.precision}={}){return t=hM(t),"".concat(parseFloat(t.toPrecision(e)))}function Qr(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ve(t,e,n){return gM(t,r=>Math.max(e,Math.min(n,r)))}function Wr(t,e,n){return Qr(t)?t.map((r,i)=>Wr(r,e[i],n)):n*e+(1-n)*t}function _n(t,e,n){const r=it.EPSILON;n&&(it.EPSILON=n);try{if(t===e)return!0;if(Qr(t)&&Qr(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!_n(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=it.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{it.EPSILON=r}}function hM(t){return Math.round(t/it.EPSILON)*it.EPSILON}function dM(t){return t.clone?t.clone():new Array(t.length)}function gM(t,e,n){if(Qr(t)){const r=t;n=n||dM(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function pM(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class Gg extends pM(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Qr(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(it)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+fM(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!_n(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(it.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function mM(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ie(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function xo(t,e,n=""){if(it.debug&&!mM(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class oE extends Gg{get x(){return this[0]}set x(e){this[0]=ie(e)}get y(){return this[1]}set y(e){this[1]=ie(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return ie(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return ie(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Yo(e>=0&&e<this.ELEMENTS,"index is out of range"),ie(this[e])}setComponent(e,n){return Yo(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var bo=1e-6,tn=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function yM(){var t=new tn(2);return tn!=Float32Array&&(t[0]=0,t[1]=0),t}function Lc(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function aE(t,e){return t[0]=-e[0],t[1]=-e[1],t}function lE(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function vM(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function _M(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=yM();return function(e,n,r,i,s,o){var a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function wM(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function cE(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function EM(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function TM(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function uE(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}function fE(){var t=new tn(3);return tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function xM(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function hy(t,e,n){var r=new tn(3);return r[0]=t,r[1]=e,r[2]=n,r}function bM(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function SM(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function PM(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function AM(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function hE(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Bl(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function CM(t,e,n,r){var i=e[0],s=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t}function Wg(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function dE(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function gE(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],c=e[2],u=i*c-s*l,f=s*a-r*c,h=r*l-i*a,d=i*h-s*f,p=s*u-r*h,m=r*f-i*u,T=o*2;return u*=T,f*=T,h*=T,d*=2,p*=2,m*=2,t[0]=a+u+d,t[1]=l+f+p,t[2]=c+h+m,t}function LM(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function MM(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function IM(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function RM(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt(n*n+r*r+i*i),c=Math.sqrt(s*s+o*o+a*a),u=l*c,f=u&&hE(t,e)/u;return Math.acos(Math.min(Math.max(f,-1),1))}var pE=bM,mE=xM,Of=SM;(function(){var t=fE();return function(e,n,r,i,s,o){var a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const kf=[0,0,0];let rl;class F extends oE{static get ZERO(){return rl||(rl=new F(0,0,0),Object.freeze(rl)),rl}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Qr(e)?this.copy(e):(it.debug&&(ie(e),ie(n),ie(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return it.debug&&(ie(e.x),ie(e.y),ie(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ie(e)}angle(e){return RM(this,e)}cross(e){return Bl(this,this,e),this.check()}rotateX({radians:e,origin:n=kf}){return LM(this,this,n,e),this.check()}rotateY({radians:e,origin:n=kf}){return MM(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=kf}){return IM(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Wg(this,this,e),this.check()}transformAsVector(e){return cE(this,this,e),this.check()}transformByMatrix3(e){return dE(this,this,e),this.check()}transformByMatrix2(e){return EM(this,this,e),this.check()}transformByQuaternion(e){return gE(this,this,e),this.check()}}let il;class Hg extends oE{static get ZERO(){return il||(il=new Hg(0,0,0,0),Object.freeze(il)),il}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),Qr(e)&&arguments.length===1?this.copy(e):(it.debug&&(ie(e),ie(n),ie(r),ie(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return it.debug&&(ie(e.x),ie(e.y),ie(e.z),ie(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=ie(e)}get w(){return this[3]}set w(e){this[3]=ie(e)}transform(e){return Wg(this,this,e),this.check()}transformByMatrix3(e){return uE(this,this,e),this.check()}transformByMatrix2(e){return TM(this,this,e),this.check()}transformByQuaternion(e){return gE(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class yE extends Gg{toString(){let e="[";if(it.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=ie(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function OM(){var t=new tn(9);return tn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function kM(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function NM(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=u*o-a*c,h=-u*s+a*l,d=c*s-o*l,p=n*f+r*h+i*d;return p?(p=1/p,t[0]=f*p,t[1]=(-u*r+i*c)*p,t[2]=(a*r-i*o)*p,t[3]=h*p,t[4]=(u*n-i*l)*p,t[5]=(-a*n+i*s)*p,t[6]=d*p,t[7]=(-c*n+r*l)*p,t[8]=(o*n-r*s)*p,t):null}function FM(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*(c*s-o*l)+n*(-c*i+o*a)+r*(l*i-s*a)}function dy(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=n[0],d=n[1],p=n[2],m=n[3],T=n[4],v=n[5],y=n[6],w=n[7],x=n[8];return t[0]=h*r+d*o+p*c,t[1]=h*i+d*a+p*u,t[2]=h*s+d*l+p*f,t[3]=m*r+T*o+v*c,t[4]=m*i+T*a+v*u,t[5]=m*s+T*l+v*f,t[6]=y*r+w*o+x*c,t[7]=y*i+w*a+x*u,t[8]=y*s+w*l+x*f,t}function DM(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=h*r+d*o+c,t[7]=h*i+d*a+u,t[8]=h*s+d*l+f,t}function zM(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*r+h*o,t[1]=d*i+h*a,t[2]=d*s+h*l,t[3]=d*o-h*r,t[4]=d*a-h*i,t[5]=d*l-h*s,t[6]=c,t[7]=u,t[8]=f,t}function gy(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function UM(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,f=r*a,h=i*o,d=i*a,p=i*l,m=s*o,T=s*a,v=s*l;return t[0]=1-f-p,t[3]=u-v,t[6]=h+T,t[1]=u+v,t[4]=1-c-p,t[7]=d-m,t[2]=h-T,t[5]=d+m,t[8]=1-c-f,t}var od;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(od||(od={}));const BM=Object.freeze([1,0,0,0,1,0,0,0,1]);class je extends yE{static get IDENTITY(){return jM()}static get ZERO(){return VM()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return od}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(BM)}fromObject(e){return this.check()}fromQuaternion(e){return UM(this,e),this.check()}set(e,n,r,i,s,o,a,l,c){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,n,r,i,s,o,a,l,c){return this[0]=e,this[1]=i,this[2]=a,this[3]=n,this[4]=s,this[5]=l,this[6]=r,this[7]=o,this[8]=c,this.check()}determinant(){return FM(this)}transpose(){return kM(this,this),this.check()}invert(){return NM(this,this),this.check()}multiplyLeft(e){return dy(this,e,this),this.check()}multiplyRight(e){return dy(this,this,e),this.check()}rotate(e){return zM(this,this,e),this.check()}scale(e){return Array.isArray(e)?gy(this,this,e):gy(this,this,[e,e]),this.check()}translate(e){return DM(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=vM(n||[-0,-0],e,this);break;case 3:r=dE(n||[-0,-0,-0],e,this);break;case 4:r=uE(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return xo(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let sl,ol;function VM(){return sl||(sl=new je([0,0,0,0,0,0,0,0,0]),Object.freeze(sl)),sl}function jM(){return ol||(ol=new je,Object.freeze(ol)),ol}function GM(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function WM(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ad(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=e[9],h=e[10],d=e[11],p=e[12],m=e[13],T=e[14],v=e[15],y=n*a-r*o,w=n*l-i*o,x=n*c-s*o,S=r*l-i*a,P=r*c-s*a,C=i*c-s*l,M=u*m-f*p,O=u*T-h*p,I=u*v-d*p,B=f*T-h*m,G=f*v-d*m,V=h*v-d*T,q=y*V-w*G+x*B+S*I-P*O+C*M;return q?(q=1/q,t[0]=(a*V-l*G+c*B)*q,t[1]=(i*G-r*V-s*B)*q,t[2]=(m*C-T*P+v*S)*q,t[3]=(h*P-f*C-d*S)*q,t[4]=(l*I-o*V-c*O)*q,t[5]=(n*V-i*I+s*O)*q,t[6]=(T*x-p*C-v*w)*q,t[7]=(u*C-h*x+d*w)*q,t[8]=(o*G-a*I+c*M)*q,t[9]=(r*I-n*G-s*M)*q,t[10]=(p*P-m*x+v*y)*q,t[11]=(f*x-u*P-d*y)*q,t[12]=(a*O-o*B-l*M)*q,t[13]=(n*B-r*O+i*M)*q,t[14]=(m*w-p*S-T*y)*q,t[15]=(u*S-f*w+h*y)*q,t):null}function HM(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],f=t[10],h=t[11],d=t[12],p=t[13],m=t[14],T=t[15],v=e*o-n*s,y=e*a-r*s,w=e*l-i*s,x=n*a-r*o,S=n*l-i*o,P=r*l-i*a,C=c*p-u*d,M=c*m-f*d,O=c*T-h*d,I=u*m-f*p,B=u*T-h*p,G=f*T-h*m;return v*G-y*B+w*I+x*O-S*M+P*C}function Hr(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=e[9],d=e[10],p=e[11],m=e[12],T=e[13],v=e[14],y=e[15],w=n[0],x=n[1],S=n[2],P=n[3];return t[0]=w*r+x*a+S*f+P*m,t[1]=w*i+x*l+S*h+P*T,t[2]=w*s+x*c+S*d+P*v,t[3]=w*o+x*u+S*p+P*y,w=n[4],x=n[5],S=n[6],P=n[7],t[4]=w*r+x*a+S*f+P*m,t[5]=w*i+x*l+S*h+P*T,t[6]=w*s+x*c+S*d+P*v,t[7]=w*o+x*u+S*p+P*y,w=n[8],x=n[9],S=n[10],P=n[11],t[8]=w*r+x*a+S*f+P*m,t[9]=w*i+x*l+S*h+P*T,t[10]=w*s+x*c+S*d+P*v,t[11]=w*o+x*u+S*p+P*y,w=n[12],x=n[13],S=n[14],P=n[15],t[12]=w*r+x*a+S*f+P*m,t[13]=w*i+x*l+S*h+P*T,t[14]=w*s+x*c+S*d+P*v,t[15]=w*o+x*u+S*p+P*y,t}function Mc(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,l,c,u,f,h,d,p,m,T,v;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],f=e[5],h=e[6],d=e[7],p=e[8],m=e[9],T=e[10],v=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=f,t[6]=h,t[7]=d,t[8]=p,t[9]=m,t[10]=T,t[11]=v,t[12]=o*r+u*i+p*s+e[12],t[13]=a*r+f*i+m*s+e[13],t[14]=l*r+h*i+T*s+e[14],t[15]=c*r+d*i+v*s+e[15]),t}function $g(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function $M(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),l,c,u,f,h,d,p,m,T,v,y,w,x,S,P,C,M,O,I,B,G,V,q,Bt;return a<bo?null:(a=1/a,i*=a,s*=a,o*=a,l=Math.sin(n),c=Math.cos(n),u=1-c,f=e[0],h=e[1],d=e[2],p=e[3],m=e[4],T=e[5],v=e[6],y=e[7],w=e[8],x=e[9],S=e[10],P=e[11],C=i*i*u+c,M=s*i*u+o*l,O=o*i*u-s*l,I=i*s*u-o*l,B=s*s*u+c,G=o*s*u+i*l,V=i*o*u+s*l,q=s*o*u-i*l,Bt=o*o*u+c,t[0]=f*C+m*M+w*O,t[1]=h*C+T*M+x*O,t[2]=d*C+v*M+S*O,t[3]=p*C+y*M+P*O,t[4]=f*I+m*B+w*G,t[5]=h*I+T*B+x*G,t[6]=d*I+v*B+S*G,t[7]=p*I+y*B+P*G,t[8]=f*V+m*q+w*Bt,t[9]=h*V+T*q+x*Bt,t[10]=d*V+v*q+S*Bt,t[11]=p*V+y*q+P*Bt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function vE(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+u*r,t[6]=a*i+f*r,t[7]=l*i+h*r,t[8]=c*i-s*r,t[9]=u*i-o*r,t[10]=f*i-a*r,t[11]=h*i-l*r,t}function XM(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-u*r,t[2]=a*i-f*r,t[3]=l*i-h*r,t[8]=s*r+c*i,t[9]=o*r+u*i,t[10]=a*r+f*i,t[11]=l*r+h*i,t}function _E(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+u*r,t[2]=a*i+f*r,t[3]=l*i+h*r,t[4]=c*i-s*r,t[5]=u*i-o*r,t[6]=f*i-a*r,t[7]=h*i-l*r,t}function YM(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,o,a),t[2]=Math.hypot(l,c,u),t}function qM(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,f=r*a,h=i*o,d=i*a,p=i*l,m=s*o,T=s*a,v=s*l;return t[0]=1-f-p,t[1]=u+v,t[2]=h-T,t[3]=0,t[4]=u-v,t[5]=1-c-p,t[6]=d+m,t[7]=0,t[8]=h+T,t[9]=d-m,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ZM(t,e,n,r,i,s,o){var a=1/(n-e),l=1/(i-r),c=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function KM(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var QM=KM;function JM(t,e,n,r,i,s,o){var a=1/(e-n),l=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*c,t[15]=1,t}var eI=JM;function tI(t,e,n,r){var i,s,o,a,l,c,u,f,h,d,p=e[0],m=e[1],T=e[2],v=r[0],y=r[1],w=r[2],x=n[0],S=n[1],P=n[2];return Math.abs(p-x)<bo&&Math.abs(m-S)<bo&&Math.abs(T-P)<bo?GM(t):(u=p-x,f=m-S,h=T-P,d=1/Math.hypot(u,f,h),u*=d,f*=d,h*=d,i=y*h-w*f,s=w*u-v*h,o=v*f-y*u,d=Math.hypot(i,s,o),d?(d=1/d,i*=d,s*=d,o*=d):(i=0,s=0,o=0),a=f*o-h*s,l=h*i-u*o,c=u*s-f*i,d=Math.hypot(a,l,c),d?(d=1/d,a*=d,l*=d,c*=d):(a=0,l=0,c=0),t[0]=i,t[1]=a,t[2]=u,t[3]=0,t[4]=s,t[5]=l,t[6]=f,t[7]=0,t[8]=o,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+s*m+o*T),t[13]=-(a*p+l*m+c*T),t[14]=-(u*p+f*m+h*T),t[15]=1,t)}function nI(){var t=new tn(4);return tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function rI(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Xg(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function iI(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function sI(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function oI(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t}function aI(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function lI(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a),t}function bs(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}function cI(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2],c=n[3],u=c*r+a*s-l*i,f=c*i+l*r-o*s,h=c*s+o*i-a*r,d=-o*r-a*i-l*s;return t[0]=u*c+d*-o+f*-l-h*-a,t[1]=f*c+d*-a+h*-o-u*-l,t[2]=h*c+d*-l+u*-a-f*-o,t[3]=e[3],t}(function(){var t=nI();return function(e,n,r,i,s,o){var a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var ld;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(ld||(ld={}));const uI=45*Math.PI/180,fI=1,Nf=.1,Ff=500,hI=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Je extends yE{static get IDENTITY(){return gI()}static get ZERO(){return dI()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return ld}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,c,u,f,h,d,p,m,T){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=f,this[11]=h,this[12]=d,this[13]=p,this[14]=m,this[15]=T,this.check()}setRowMajor(e,n,r,i,s,o,a,l,c,u,f,h,d,p,m,T){return this[0]=e,this[1]=s,this[2]=c,this[3]=d,this[4]=n,this[5]=o,this[6]=u,this[7]=p,this[8]=r,this[9]=a,this[10]=f,this[11]=m,this[12]=i,this[13]=l,this[14]=h,this[15]=T,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(hI)}fromObject(e){return this.check()}fromQuaternion(e){return qM(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=Nf,far:a=Ff}=e;return a===1/0?pI(this,n,r,i,s,o):ZM(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return tI(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=Nf,far:a=Ff}=e;return eI(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=uI,aspect:r=fI,focalDistance:i=1,near:s=Nf,far:o=Ff}=e;py(n);const a=n/2,l=i*Math.tan(a),c=l*r;return this.ortho({left:-c,right:c,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return py(n),QM(this,n,r,i,s),this.check()}determinant(){return HM(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return WM(this,this),this.check()}invert(){return ad(this,this),this.check()}multiplyLeft(e){return Hr(this,e,this),this.check()}multiplyRight(e){return Hr(this,this,e),this.check()}rotateX(e){return vE(this,this,e),this.check()}rotateY(e){return XM(this,this,e),this.check()}rotateZ(e){return _E(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return $M(this,this,e,n),this.check()}scale(e){return $g(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Mc(this,this,e),this.check()}transform(e,n){return e.length===4?(n=bs(n||[-0,-0,-0,-0],e,this),xo(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=_M(n||[-0,-0],e,this);break;case 3:i=Wg(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return xo(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=wM(n||[-0,-0],e,this);break;case 3:r=cE(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return xo(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let al,ll;function dI(){return al||(al=new Je([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(al)),al}function gI(){return ll||(ll=new Je,Object.freeze(ll)),ll}function py(t){if(t>Math.PI*2)throw Error("expected radians")}function pI(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),c=(i+r)/(i-r),u=-1,f=-1,h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=u,t[11]=f,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}function my(){var t=new tn(4);return tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function mI(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function wE(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function yy(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=n[0],l=n[1],c=n[2],u=n[3];return t[0]=r*u+o*a+i*c-s*l,t[1]=i*u+o*l+s*a-r*c,t[2]=s*u+o*c+r*l-i*a,t[3]=o*u-r*a-i*l-s*c,t}function yI(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+o*a,t[1]=i*l+s*a,t[2]=s*l-i*a,t[3]=o*l-r*a,t}function vI(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l-s*a,t[1]=i*l+o*a,t[2]=s*l+r*a,t[3]=o*l-i*a,t}function _I(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*a,t[1]=i*l-r*a,t[2]=s*l+o*a,t[3]=o*l-s*a,t}function wI(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Vl(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3],l=n[0],c=n[1],u=n[2],f=n[3],h,d,p,m,T;return d=i*l+s*c+o*u+a*f,d<0&&(d=-d,l=-l,c=-c,u=-u,f=-f),1-d>bo?(h=Math.acos(d),p=Math.sin(h),m=Math.sin((1-r)*h)/p,T=Math.sin(r*h)/p):(m=1-r,T=r),t[0]=m*i+T*l,t[1]=m*s+T*c,t[2]=m*o+T*u,t[3]=m*a+T*f,t}function EI(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=s*a,t}function TI(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function EE(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[o*3+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+o]-e[o*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[o]=(e[o*3+i]+e[i*3+o])*r}return t}var xI=rI,bI=Xg,SI=aI,PI=lI,AI=iI,CI=sI,TE=oI,LI=function(){var t=fE(),e=hy(1,0,0),n=hy(0,1,0);return function(r,i,s){var o=hE(i,s);return o<-.999999?(Bl(t,e,i),mE(t)<1e-6&&Bl(t,n,i),AM(t,t),wE(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Bl(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,TE(r,r))}}();(function(){var t=my(),e=my();return function(n,r,i,s,o,a){return Vl(t,r,o,a),Vl(e,i,s,a),Vl(n,t,e,2*a*(1-a)),n}})();(function(){var t=OM();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],TE(e,EE(e,t))}})();const MI=[0,0,0,1];class vy extends Gg{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return EE(this,e),this.check()}fromAxisRotation(e,n){return wE(this,e,n),this.check()}identity(){return mI(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=ie(e)}get y(){return this[1]}set y(e){this[1]=ie(e)}get z(){return this[2]}set z(e){this[2]=ie(e)}get w(){return this[3]}set w(e){this[3]=ie(e)}len(){return AI(this)}lengthSquared(){return CI(this)}dot(e){return SI(this,e)}rotationTo(e,n){return LI(this,e,n),this.check()}add(e){return xI(this,this,e),this.check()}calculateW(){return wI(this,this),this.check()}conjugate(){return TI(this,this),this.check()}invert(){return EI(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(PI(this,e,n,r),this.check())}multiplyRight(e){return yy(this,this,e),this.check()}multiplyLeft(e){return yy(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return yI(this,this,e),this.check()}rotateY(e){return vI(this,this,e),this.check()}rotateZ(e){return _I(this,this,e),this.check()}scale(e){return bI(this,this,e),this.check()}slerp(e,n,r){let i,s,o;switch(arguments.length){case 1:({start:i=MI,target:s,ratio:o}=e);break;case 2:i=this,s=e,o=n;break;default:i=e,s=n,o=r}return Vl(this,i,s,o),this.check()}transformVector4(e,n=new Hg){return cI(n,e,this),xo(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const xE={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},_y=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,II={lightSources:{}};function Df(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function RI(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Df(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,o)=>{i["lighting_uPointLight[".concat(o,"].color")]=Df(s),i["lighting_uPointLight[".concat(o,"].position")]=s.position,i["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,o)=>{i["lighting_uDirectionalLight[".concat(o,"].color")]=Df(s),i["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function bE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:II;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},RI({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return bE({lightSources:e})}return{}}const OI={name:"lights",vs:_y,fs:_y,getUniforms:bE,defines:{MAX_LIGHTS:3}},kI=new Uint8Array([0,255,255,255]),NI={pickingSelectedColor:null,pickingHighlightColor:kI,pickingActive:!1,pickingAttribute:!1};function FI(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NI;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}const DI=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,zI=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,UI={name:"picking",vs:DI,fs:zI,getUniforms:FI},BI=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,VI={};function jI(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function GI(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:VI;if(!("material"in t))return{};const{material:e}=t;return e?jI(e):{lighting_uEnabled:!1}}const WI={name:"gouraud-lighting",dependencies:[OI],vs:BI,defines:{LIGHTING_VERTEX:1},getUniforms:GI},HI=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,$I={name:"transform",vs:HI,fs:null};class pa{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new pa(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(n),f=this._getHash(r),h=c.map(w=>this._getHash(w.name)).sort(),d=o.map(w=>this._getHash(w)),p=Object.keys(i).sort(),m=Object.keys(s).sort(),T=[],v=[];for(const w of p)T.push(this._getHash(w)),T.push(this._getHash(i[w]));for(const w of m)v.push(this._getHash(w)),v.push(this._getHash(s[w]));const y="".concat(u,"/").concat(f,"D").concat(T.join("/"),"M").concat(h.join("/"),"I").concat(v.join("/"),"V").concat(d.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[y]){const w=K3(this.gl,{vs:n,fs:r,modules:c,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[y]=new Zw(this.gl,{hash:y,vs:w.vs,fs:w.fs,varyings:o,bufferMode:a}),this._getUniforms[y]=w.getUniforms||(x=>{}),this._useCounts[y]=0}return this._useCounts[y]++,this._programCache[y]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,n}}const XI={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function YI(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=qI(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const l=o.value,c={...o};delete c.value,r[a]=[new re(t,l),c],ZI(s,c)}}if(i){const s=i.value||i;k(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new re(t,{data:s,target:34963}),o]}return r}function qI(t,e){const{attributeMap:n=XI}=e||{};return n&&n[t]||t}function ZI(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}k(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const wi=2,KI=1e4,QI="Model needs drawMode and vertexCount",wy=()=>{},JI={};class jn{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Tr("model")}=n;k(cu(e)),this.id=r,this.gl=e,this.id=n.id||Tr("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||pa.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},k(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),QI)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return k(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return k(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=YI(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ds(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return zg(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let c;U.priority>=wi&&(c=this._logDrawCallStart(wi));const u=this.vertexArray.getDrawParams(),{isIndexed:f=u.isIndexed,indexType:h=u.indexType,indexOffset:d=u.indexOffset,vertexArrayInstanced:p=u.isInstanced}=this.props;p&&!this.isInstanced&&U.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:m,instanceCount:T}=this,{onBeforeRender:v=wy,onAfterRender:y=wy}=this.props;v(),this.program.setUniforms(this.uniforms);const w=this.program.draw(Object.assign(JI,e,{logPriority:c,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:f,indexType:h,isInstanced:m,instanceCount:T,offset:f?d:0}));return y(),U.priority>=wi&&this._logDrawCallEnd(c,l,r),w}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return U.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}k(n instanceof Zw,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new h3(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof re&&n.delete()}}_setAnimationProps(e){this.animated&&k(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ds(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new Kw(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:KI;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),U.group(wi,">>> DRAWING MODEL ".concat(this.id),{collapsed:U.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=p3({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=ty({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:c,count:u}=ty({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});u>0&&U.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&U.log("UNUSED UNIFORMS",Object.keys(a))();const f=y3(this.vertexArray.configuration);U.table(e,s)(),U.table(e,o)(),U.table(e+1,f)(),i&&i.log({logLevel:wi,message:"Rendered to ".concat(i.id)}),U.groupEnd(wi)()}}class eR{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof re?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&k(X(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:l,accessor:c}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:l,accessor:c})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new Kw(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],k(r[s]instanceof re)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new re(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const tR="transform_uSampler_",Ic="transform_uSize_",Ey="transform_position";function nR(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const l={};let c=e,u={};if(o>0||r){const f=c.split(`
`),h=f.slice();if(f.forEach((d,p,m)=>{if(o>0){const T=aR(d,n);if(T){const{updatedLine:v,inject:y}=T;h[p]=v,u=rd([u,y]),Object.assign(l,T.samplerTextureMap),o--}}r&&!a&&(a=oR(d,r))}),r){k(i);const d="".concat(Ic).concat(r),p="uniform vec2 ".concat(d,`;
`),m="     vec2 ".concat(Ey," = transform_getPos(").concat(d,`);
     gl_Position = vec4(`).concat(Ey,`, 0, 1.);
`);u=rd([u,{"vs:#decl":p,"vs:#main-start":m}])}c=h.join(`
`)}return{vs:c,targetTextureType:a,inject:u,samplerTextureMap:l}}function rR(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(Ic).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(Ic).concat(a)]=[s,o];return i}function iR(t){return iE(t,["attribute","in"])}function sR(t){const e="".concat(tR).concat(t),n="".concat(Ic).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function oR(t,e){const n=iE(t,["varying","out"]);return n&&n.name===e?n.type:null}function aR(t,e){const n={},r=iR(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:l,uniformDeclerations:c}=sR(s),u=oM(i),f="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(l,").").concat(u,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":f},samplerTextureMap:n}}return null}const lR={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},cR="transform_output";class uR{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const f in this.samplerTextureMap){const h=this.samplerTextureMap[f];a[f]=r[h]}this._setSourceTextureParameters();const u=rR({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:c,parameters:l}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=fu(n);if(!e)return r;const i=r.constructor,s=aM(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let l=0;l<r.length;l+=4)for(let c=0;c<s;c++)o[a++]=r[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof ot)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new re(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{[36064]:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Ce(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{[36064]:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(lR)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=tL(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=nR({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),c=rd([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=l;const u=e._fs||sE({version:Yw(i),input:this.targetTextureVarying,inputType:o,output:cR}),f=this.hasSourceTextures||this.targetTextureVarying?[$I].concat(e.modules||[]):e.modules;return{vs:i,fs:u,modules:f,uniforms:s,inject:c}}}class Yg{static isSupported(e){return X(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();k(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new jn(n,Object.assign({},e,{fs:e.fs||sE({version:Yw(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){fR(n)&&(this.bufferTransform=new eR(e,n)),hR(n)&&(this.textureTransform=new uR(e,n)),k(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function fR(t){return!!(!ds(t.feedbackBuffers)||!ds(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function hR(t){return!!(!ds(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const Ty={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class li{static get DRAW_MODE(){return Ty}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Tr("geometry"),drawMode:r=Ty.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,k(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(k(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(r=Math.min(r,o.length/a))}return k(Number.isFinite(r)),r}}let dR=1,gR=1;class SE{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=dR++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=gR++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const PE="#define SMOOTH_EDGE_RADIUS 0.5",pR=`
`.concat(PE,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),mR=`
`.concat(PE,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),yR={name:"geometry",vs:pR,fs:mR},Z={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Z,"IDENTITY",{get:()=>(H.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Xt={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},xr={common:0,meters:1,pixels:2},xy={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},ma={DRAW:"draw",MASK:"mask"},vR=Object.keys(Z).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Z[t],";")).join(""),_R=Object.keys(Xt).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Xt[t],";")).join(""),wR=Object.keys(xr).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(xr[t],";")).join(""),ER="".concat(vR,`
`).concat(_R,`
`).concat(wR,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0; // meters
const float GLOBE_RADIUS = 256.0;

// returns an adjustment factor for uCommonUnitsPerMeter
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {

    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear
    // Adjust by 1 / cos(latitude)
    // If geometry.position (vertex in common space) is populated, use it
    // Otherwise use geometry.worldPosition (anchor in world space)
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }

    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)
    // Taylor series of 1 / cos(latitude)
    // Max error < 0.003
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}

//
// Scaling offsets - scales meters to "world distance"
// Note the scalar version of project_size is for scaling the z component only
//
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}

// Get rotation matrix that aligns the z axis with the given up vector
// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  // Tangent on XY plane
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}

//
// Projecting normal - transform deltas from current coordinate system to
// normals in the worldspace
//
vec3 project_normal(vec3 vector) {
  // Apply model matrix
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

//
// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]
//
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

//
// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)
//
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;

  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        // Too far from the projection center for offset mode to be accurate
        // Only use high parts
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.
    position_world.xyz -= project_uCoordinateOrigin;
  }

  // Translation is already added to the high parts
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}

//
// Projects from common space coordinates to clip space.
// Uses project_uViewProjectionMatrix
//
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}

// Returns a clip space offset that corresponds to a given number of screen pixels
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  // UNIT_PIXELS
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function TR(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function ya(t){let e={},n;return r=>{for(const i in r)if(!TR(r[i],e[i])){n=t(r),e=r;break}return n}}const by=[0,0,0,0],xR=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],AE=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],bR=[0,0,0],CE=[0,0,0],SR=ya(CR);function LE(t,e,n=CE){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===Z.LNGLAT_OFFSETS||e===Z.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Xt.WEB_MERCATOR:(e===Z.LNGLAT||e===Z.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Xt.WEB_MERCATOR_AUTO_OFFSET:e===Z.LNGLAT?r=i:e===Z.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Xt.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Xt.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function PR(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=by,l=by,c=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:f,offsetMode:h}=LE(t,e,n);return h&&(l=t.projectPosition(u||f),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=bs([],l,o),s=r||s,o=Hr([],i,s),o=Hr([],o,xR)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:u}}function AR({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Z.DEFAULT,coordinateOrigin:i=CE,autoWrapLongitude:s=!1}){r===Z.DEFAULT&&(r=t.isGeospatial?Z.LNGLAT:Z.CARTESIAN);const o=SR({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||AE,o}function CR({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=PR(t,n,r),u=t.getDistanceScales(),f=[t.width*e,t.height*e],h=bs([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,d={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:bR,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:AE,project_uCameraPosition:a};if(c){const p=t.getDistanceScales(c);switch(n){case Z.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=p.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=p.unitsPerMeter2;break;case Z.LNGLAT:case Z.LNGLAT_OFFSETS:t._pseudoMeters||(d.project_uCommonUnitsPerMeter=p.unitsPerMeter),d.project_uCommonUnitsPerWorldUnit=p.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=p.unitsPerDegree2;break;case Z.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,p.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,p.unitsPerMeter2[2]];break}}return d}const LR={};function MR(t=LR){return"viewport"in t?AR(t):{}}const qg={name:"project",dependencies:[uM,yR],vs:ER,getUniforms:MR},IR=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,ci={name:"project32",dependencies:[qg],vs:IR};function RR(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function es(t,e){const n=bs([],e,t);return Xg(n,n,1/n[3]),n}function Sy(t,e){const n=t%e;return n<0?e+n:n}function cd(t,e,n){return t<e?e:t>n?n:t}function OR(t){return Math.log(t)*Math.LOG2E}const Zg=Math.log2||OR;function Gn(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Yt=Math.PI,ME=Yt/4,Jt=Yt/180,ud=180/Yt,qo=512,fd=4003e4,cl=85.051129,kR=1.5;function NR(t){return Zg(t)}function br(t){const[e,n]=t;Gn(Number.isFinite(e)),Gn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Jt,i=n*Jt,s=qo*(r+Yt)/(2*Yt),o=qo*(Yt+Math.log(Math.tan(ME+i*.5)))/(2*Yt);return[s,o]}function ps(t){const[e,n]=t,r=e/qo*(2*Yt)-Yt,i=2*(Math.atan(Math.exp(n/qo*(2*Yt)-Yt))-ME);return[r*ud,i*ud]}function FR(t){const{latitude:e}=t;Gn(Number.isFinite(e));const n=Math.cos(e*Jt);return NR(fd*n)-9}function hd(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Gn(Number.isFinite(e)&&Number.isFinite(n));const i=qo,s=Math.cos(e*Jt),o=i/360,a=o/s,l=i/fd/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const u=Jt*Math.tan(e*Jt)/s,f=o*u/2,h=i/fd*u,d=h/a*l;c.unitsPerDegree2=[0,f,h],c.unitsPerMeter2=[d,0,d]}return c}function IE(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=hd({longitude:n,latitude:r,highPrecision:!0}),u=br(t);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const f=ps(u),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[f[0],f[1],h]:f}function DR(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=RR();Mc(a,a,[0,0,-i]),vE(a,a,-n*Jt),_E(a,a,r*Jt);const l=s/e;return $g(a,a,[l,l,l]),o&&Mc(a,a,PM([],o)),a}function zR(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=t;let{fovy:u=Rc(kR)}=t;r!==void 0&&(u=Rc(r));const f=u*Jt,h=i*Jt,d=RE(u);let p=d;o&&(p+=o[2]*a/Math.cos(h)/n);const m=f*(.5+(s?s[1]:0)/n),T=Math.sin(m)*p/Math.sin(cd(Math.PI/2-h-m,.01,Math.PI-.01)),v=Math.sin(h)*T+p,y=p*10,w=Math.min(v*c,y);return{fov:f,aspect:e/n,focalDistance:d,near:l,far:w}}function Rc(t){return 2*Math.atan(.5/t)*ud}function RE(t){return .5/Math.tan(.5*t*Jt)}function OE(t,e){const[n,r,i=0]=t;return Gn(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),es(e,[n,r,i,1])}function hu(t,e,n=0){const[r,i,s]=t;if(Gn(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return es(e,[r,i,s,1]);const o=es(e,[r,i,0,1]),a=es(e,[r,i,1,1]),l=o[2],c=a[2],u=l===c?0:((n||0)-l)/(c-l);return lE([],o,a,u)}function kE(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[c,u]]=r,f=UR(t.padding),h=br([a,cd(u,-cl,cl)]),d=br([c,cd(l,-cl,cl)]),p=[Math.max(Math.abs(d[0]-h[0]),i),Math.max(Math.abs(d[1]-h[1]),i)],m=[e-f.left-f.right-Math.abs(o[0])*2,n-f.top-f.bottom-Math.abs(o[1])*2];Gn(m[0]>0&&m[1]>0);const T=m[0]/p[0],v=m[1]/p[1],y=(f.right-f.left)/2/T,w=(f.top-f.bottom)/2/v,x=[(d[0]+h[0])/2+y,(d[1]+h[1])/2+w],S=ps(x),P=Math.min(s,Zg(Math.abs(Math.min(T,v))));return Gn(Number.isFinite(P)),{longitude:S[0],latitude:S[1],zoom:P}}function UR(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Gn(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const Py=Math.PI/180;function BR(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,c;const u=t.fovy?.5*t.fovy*Py:Math.atan(.5/t.altitude),f=(90-t.pitch)*Py;return u>f-.01?(l=Ay(t,0,e),c=Ay(t,n,e)):(l=i([0,0],s),c=i([n,0],s)),[o,a,c,l]}function Ay(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=es(r,[e,0,1,1]),s=es(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=lE([],i,s,a),c=ps(l);return c.push(n),c}const Cy=512;function VR(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=Sy(i+180,360)-180),(a<-180||a>180)&&(a=Sy(a+180,360)-180);const l=Zg(n/Cy);if(o<=l)o=l,s=0;else{const c=n/2/Math.pow(2,o),u=ps([0,c])[1];if(s<u)s=u;else{const f=ps([0,Cy-c])[1];s>f&&(s=f)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const jR=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,GR=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,WR=ya(qR),HR=ya(ZR),$R=[0,0,0,1],XR=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function YR(t,e){const[n,r,i]=t,s=hu([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function qR({viewport:t,center:e}){return new Je(t.viewProjectionMatrix).invert().transform(e)}function ZR({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>YR(o,r));for(const o of e){const a=o.clone().translate(new F(t.center).negate()),l=s.map(u=>a.transform(u)),c=new Je().ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});n.push(c.multiplyRight(o))}return n}function KR(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||$R,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=WR({viewport:t.viewport,center:e.project_uCenter}),s=[],o=HR({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],c=l.clone().translate(new F(t.viewport.center).negate());e.project_uCoordinateSystem===Z.LNGLAT&&e.project_uProjectionMode===Xt.WEB_MERCATOR?(o[a]=c,s[a]=i):(o[a]=l.clone().multiplyRight(XR),s[a]=c.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const zf={name:"shadow",dependencies:[qg],vs:jR,fs:GR,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?KR(t,e):{}},ui={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...UI},QR=[qg],JR=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function eO(t){const e=pa.getDefaultProgramManager(t);for(const n of QR)e.addDefaultModule(n);for(const n of JR)e.addShaderHook(n);return e}const tO=[255,255,255],nO=1;let rO=0;class iO{constructor(e={}){g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","ambient");const{color:n=tO}=e,{intensity:r=nO}=e;this.id=e.id||"ambient-".concat(rO++),this.color=n,this.intensity=r}}const sO=[255,255,255],oO=1,aO=[0,0,-1];let lO=0;class Ly{constructor(e={}){g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","directional"),g(this,"direction",void 0),g(this,"shadow",void 0);const{color:n=sO}=e,{intensity:r=oO}=e,{direction:i=aO}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(lO++),this.color=n,this.intensity=r,this.type="directional",this.direction=new F(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class cO{constructor(e,n={id:"pass"}){g(this,"id",void 0),g(this,"gl",void 0),g(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class du extends cO{constructor(...e){super(...e),g(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return Vn(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const c=this.gl;l&&fO(c),a&&(this._lastRenderIndex=-1);const u=[];for(const f of i){const h=s&&s[f.id];o(f);const d=this._getDrawLayerParams(f,e),p=f.subViewports||[f];for(const m of p){const T=this._drawLayersInViewport(c,{target:n,moduleParameters:r,viewport:m,view:h,pass:e.pass,layers:e.layers},d);u.push(T)}}return u}_getDrawLayerParams(e,{layers:n,pass:r,layerFilter:i,cullRect:s,effects:o,moduleParameters:a}){const l=[],c=NE(this._lastRenderIndex+1),u={layer:n[0],viewport:e,isPicking:r.startsWith("picking"),renderPass:r,cullRect:s},f={};for(let h=0;h<n.length;h++){const d=n[h],p=this._shouldDrawLayer(d,u,i,f),m={shouldDrawLayer:p};p&&(m.layerRenderIndex=c(d,p),m.moduleParameters=this._getModuleParameters(d,o,r,a),m.layerParameters=this.getLayerParameters(d,h,e)),l[h]=m}return l}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const c=uO(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const f=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Dt(e,{scissorTest:!0,scissor:c},()=>zg(e,f))}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};Vn(e,{viewport:c});for(let f=0;f<n.length;f++){const h=n[f],{shouldDrawLayer:d,layerRenderIndex:p,moduleParameters:m,layerParameters:T}=l[f];if(d&&h.props.pickable&&u.pickableCount++,h.isComposite)u.compositeCount++;else if(d){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,p),m.viewport=o;try{h._drawLayer({moduleParameters:m,uniforms:{layerIndex:p},parameters:T})}catch(v){h.raiseError(v,"drawing ".concat(h," to ").concat(i))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:hs(this.gl)});if(n)for(const l of n){var a;Object.assign(o,(a=l.getModuleParameters)===null||a===void 0?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function NE(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in e)&&r(i.parent,!1),l in n){const u=n[l]=n[l]||NE(e[l],e);c=u(i,s),n[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),n[a]=null):c=t;return s&&c>=t&&(t=c+1),e[a]=c,c};return r}function uO(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||hs(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function fO(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;Vn(t,{viewport:[0,0,e,n]}),t.clear(16640)}class hO extends du{constructor(e,n){super(e,n),g(this,"shadowMap",void 0),g(this,"depthBuffer",void 0),g(this,"fbo",void 0),this.shadowMap=new ot(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new ji(e,{format:33189,width:1,height:1}),this.fbo=new Ce(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;Dt(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=hs(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const dO={color:[255,255,255],intensity:1},My=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],gO=[0,0,0,200/255];class FE{constructor(e={}){g(this,"id","lighting-effect"),g(this,"props",null),g(this,"shadowColor",gO),g(this,"shadow",void 0),g(this,"ambientLight",null),g(this,"directionalLights",[]),g(this,"pointLights",[]),g(this,"shadowPasses",[]),g(this,"shadowMaps",[]),g(this,"dummyShadowMap",null),g(this,"programManager",void 0),g(this,"shadowMatrices",void 0);for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow)}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=pa.getDefaultProgramManager(e),zf&&this.programManager.addDefaultModule(zf)),this.dummyShadowMap||(this.dummyShadowMap=new ot(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(zf),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Je().lookAt({eye:new F(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new hO(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new iO(dO),this.directionalLights.push(new Ly(My[0]),new Ly(My[1])))}}class pO{constructor(e={}){g(this,"_pool",[]),g(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=i||e&&e.constructor||Float32Array,u=n*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let f=1/0;l&&(f=l*r+s);const h=this._allocate(c,u,a,f);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return r&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const ms=new pO;function ao(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function mO(t,e){const n=t%e;return n<0?e+n:n}function yO(t){return[t[12],t[13],t[14]]}function vO(t){return{left:Ei(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Ei(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Ei(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Ei(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Ei(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Ei(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const Iy=new F;function Ei(t,e,n,r){Iy.set(t,e,n);const i=Iy.len();return{distance:r/i,normal:new F(-t/i,-e/i,-n/i)}}function _O(t){return t-Math.fround(t)}let Zs;function Uf(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Zs=ms.allocate(Zs,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const c=t[o++];Zs[a+l]=c,Zs[a+l+n]=_O(c)}a+=n*2}return Zs.subarray(0,s*n*2)}const wO=Math.PI/180,EO=ao(),Ry=[0,0,0],TO={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function xO({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,c=n?new Je().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new Je().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:u=0,right:f=0,top:h=0,bottom:d=0}=s,p=Ve((u+t-f)/2,0,t)-t/2,m=Ve((h+e-d)/2,0,e)-e/2;c[8]-=p*2/t,c[9]+=m*2/e}return c}class Cr{constructor(e={}){g(this,"id",void 0),g(this,"x",void 0),g(this,"y",void 0),g(this,"width",void 0),g(this,"height",void 0),g(this,"padding",void 0),g(this,"isGeospatial",void 0),g(this,"zoom",void 0),g(this,"focalDistance",void 0),g(this,"position",void 0),g(this,"modelMatrix",void 0),g(this,"distanceScales",void 0),g(this,"scale",void 0),g(this,"center",void 0),g(this,"cameraPosition",void 0),g(this,"projectionMatrix",void 0),g(this,"viewMatrix",void 0),g(this,"viewMatrixUncentered",void 0),g(this,"viewMatrixInverse",void 0),g(this,"viewProjectionMatrix",void 0),g(this,"pixelProjectionMatrix",void 0),g(this,"pixelUnprojectionMatrix",void 0),g(this,"resolution",void 0),g(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||TO,this.focalDistance=e.focalDistance||1,this.position=e.position||Ry,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Xt.WEB_MERCATOR:Xt.WEB_MERCATOR_AUTO_OFFSET:Xt.IDENTITY}equals(e){return e instanceof Cr?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&_n(e.projectionMatrix,this.projectionMatrix)&&_n(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=OE(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],c=hu([i,a,o],this.pixelUnprojectionMatrix,l),[u,f,h]=this.unprojectPosition(c);return Number.isFinite(o)?[u,f,h]:Number.isFinite(r)?[u,f,r]:[u,f]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=br(e);return n[1]=Ve(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?ps(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?hd({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,vO(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=FR({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||hd({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=Ry;if(s&&(a=o?new Je(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new F(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=EO,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:c=null,focalDistance:u=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Je().multiplyRight(n).translate(new F(this.center).negate()),this.projectionMatrix=r||xO({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*wO,focalDistance:u,padding:c,near:a,far:l});const f=ao();Hr(f,f,this.projectionMatrix),Hr(f,f,this.viewMatrix),this.viewProjectionMatrix=f,this.viewMatrixInverse=ad([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=yO(this.viewMatrixInverse);const h=ao(),d=ao();$g(h,h,[this.width/2,-this.height/2,1]),Mc(h,h,[1,-1,0]),Hr(d,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=d,this.pixelUnprojectionMatrix=ad(ao(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||H.warn("Pixel project matrix not invertible")()}}g(Cr,"displayName","Viewport");const bO=512,SO=4003e4,PO=Math.PI/180;function Oy(t){const e=Math.cos(t*PO);return bO/SO/e}class En extends Cr{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,orthographic:c=!1,projectionMatrix:u,repeat:f=!1,worldOffset:h=0,legacyMeterSizes:d=!1}=e;let{width:p,height:m,altitude:T=1.5}=e;const v=Math.pow(2,i);p=p||1,m=m||1;let y,w=null;u?(T=u[5]/2,y=Rc(T)):(e.fovy?(y=e.fovy,T=RE(y)):y=Rc(T),w=zR({width:p,height:m,pitch:s,fovy:y,nearZMultiplier:a,farZMultiplier:l}));let x=DR({height:m,pitch:s,bearing:o,scale:v,altitude:T});h&&(x=new Je().translate([512*h,0,0]).multiplyLeft(x)),super({...e,width:p,height:m,viewMatrix:x,longitude:r,latitude:n,zoom:i,...w,fovy:y,focalDistance:T}),g(this,"longitude",void 0),g(this,"latitude",void 0),g(this,"pitch",void 0),g(this,"bearing",void 0),g(this,"altitude",void 0),g(this,"fovy",void 0),g(this,"orthographic",void 0),g(this,"_subViewports",void 0),g(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=T,this.fovy=y,this.orthographic=c,this._subViewports=f?[]:null,this._pseudoMeters=d,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new En({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Oy(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Oy(r);return[n,r,i]}addMetersToLngLat(e,n){return IE(e,n)}panByPosition(e,n){const r=hu(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Lc([],i,aE([],r)),o=Lc([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=BR(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=kE({width:r,height:i,bounds:e,...n});return new En({width:r,height:i,longitude:s,latitude:o,zoom:a})}}g(En,"displayName","WebMercatorViewport");function Bf(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof En){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function AO(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===Z.DEFAULT&&(i=e.isGeospatial?Z.LNGLAT:Z.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function DE(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=bs([],[o,a,l,1],n)),r){case Z.LNGLAT:return Bf([o,a,l],e,s);case Z.LNGLAT_OFFSETS:return Bf([o+i[0],a+i[1],l+(i[2]||0)],e,s);case Z.METER_OFFSETS:return Bf(IE(i,[o,a,l]),e,s);case Z.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function CO(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=AO(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=LE(n,r,i),f=DE(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});if(u){const h=n.projectPosition(l||c);pE(f,f,h)}return f}const Ci={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Oc=Symbol.for("component"),ts=Symbol.for("asyncPropDefaults"),Jr=Symbol.for("asyncPropOriginal"),cr=Symbol.for("asyncPropResolved");function gu(t,e=()=>!0){return Array.isArray(t)?zE(t,e,[]):e(t)?[t]:[]}function zE(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?zE(i,e,n):e(i)&&n.push(i)}return n}function LO({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class MO{constructor(e,n,r){g(this,"id",void 0),g(this,"context",void 0),g(this,"isLoaded",void 0),g(this,"persistent",void 0),g(this,"_loadCount",0),g(this,"_subscribers",new Set),g(this,"_data",void 0),g(this,"_loader",void 0),g(this,"_error",void 0),g(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=bc(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class IO{constructor({gl:e,protocol:n}){g(this,"protocol",void 0),g(this,"_context",void 0),g(this,"_resources",void 0),g(this,"_consumers",void 0),g(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new MO(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},l=a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const RO="layerManager.setLayers",OO="layerManager.activateViewport";class kO{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){g(this,"layers",void 0),g(this,"context",void 0),g(this,"resourceManager",void 0),g(this,"_lastRenderedLayers",[]),g(this,"_needsRedraw",!1),g(this,"_needsUpdate",!1),g(this,"_nextLayers",null),g(this,"_debug",!1),g(this,"activateViewport",o=>{qe(OO,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new IO({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&eO(e),stats:r||new lu({id:"deck.gl"}),viewport:i||new Cr({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new SE,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){qe(RO,this,n,e),this._lastRenderedLayers=e;const r=gu(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?H.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&H.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Ci.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Ci.MATCHED,n!==e&&(e.lifecycle=Ci.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Ci.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Ci.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Ss(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const r=t[n],i=e[n];if(!(r===i||Array.isArray(r)&&Array.isArray(i)&&Ss(r,i)))return!1}return!0}class NO{constructor(e){g(this,"width",void 0),g(this,"height",void 0),g(this,"views",void 0),g(this,"viewState",void 0),g(this,"controllers",void 0),g(this,"timeline",void 0),g(this,"_viewports",void 0),g(this,"_viewportMap",void 0),g(this,"_isUpdating",void 0),g(this,"_needsRedraw",void 0),g(this,"_needsUpdate",void 0),g(this,"_eventManager",void 0),g(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=gu(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Ss(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):H.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return i||(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const c=Boolean(s.controller);c&&!l&&(r=!0),(r||!c)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const FO=/([0-9]+\.?[0-9]*)(%|px)/;function Jn(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=FO.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function er(t,e){return t.relative?Math.round(t.position*e):t.position}function Ne(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class ei{constructor(e){g(this,"id",void 0),g(this,"viewportInstance",void 0),g(this,"_x",void 0),g(this,"_y",void 0),g(this,"_width",void 0),g(this,"_height",void 0),g(this,"_padding",void 0),g(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:l}=e||{};Ne(!l||l instanceof Cr),this.viewportInstance=l,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Jn(r),this._y=Jn(i),this._width=Jn(s),this._height=Jn(o),this._padding=a&&{left:Jn(a.left||0),right:Jn(a.right||0),top:Jn(a.top||0),bottom:Jn(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Ss(this.props,e.props)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:er(this._x,e),y:er(this._y,n),width:er(this._width,e),height:er(this._height,n)};return this._padding&&(r.padding={left:er(this._padding.left,e),top:er(this._padding.top,n),right:er(this._padding.right,e),bottom:er(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class va{constructor(e){g(this,"_inProgress",void 0),g(this,"_handle",void 0),g(this,"_timeline",void 0),g(this,"time",void 0),g(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const ky=()=>{},dd={BREAK:1,SNAP_TO_END:2,IGNORE:3},DO=t=>t,zO=dd.BREAK;class UO{constructor(e){g(this,"getControllerState",void 0),g(this,"props",void 0),g(this,"propsInTransition",void 0),g(this,"transition",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,c=l(r/a),u=i.interpolateProps(s,o,c);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new va(e.timeline),this.onViewStateChange=e.onViewStateChange||ky,this.onStateChange=e.onStateChange||ky}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===dd.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&Boolean(r)}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===dd.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||DO,interpolator:s,interruption:n.transitionInterruption||zO,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class BO{constructor(e){g(this,"_propsToCompare",void 0),g(this,"_propsToExtract",void 0),g(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!_n(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ne(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const VO=["longitude","latitude","zoom","bearing","pitch"],jO=["longitude","latitude","zoom"];class Kg extends BO{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:VO,required:jO},super(r.transitionProps),g(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Wr(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Wr(e.around,n.around,r)))}return i}}const tr={transitionDuration:0},GO=300,ul=t=>1-(1-t)*(1-t),Ti={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Or={};class UE{constructor(e){g(this,"props",void 0),g(this,"state",{}),g(this,"transitionManager",void 0),g(this,"eventManager",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"makeViewport",void 0),g(this,"_controllerState",void 0),g(this,"_events",{}),g(this,"_interactionState",{isDragging:!1}),g(this,"_customEvents",[]),g(this,"_eventStartBlocked",null),g(this,"_panMove",!1),g(this,"invertPan",!1),g(this,"dragMode","rotate"),g(this,"inertia",0),g(this,"scrollZoom",!0),g(this,"dragPan",!0),g(this,"dragRotate",!0),g(this,"doubleClickZoom",!0),g(this,"touchZoom",!0),g(this,"touchRotate",!1),g(this,"keyboard",!0),this.transitionManager=new UO({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return Boolean(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?GO:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(Ti.WHEEL,u&&r),this.toggleEvents(Ti.PAN,u&&(i||s)),this.toggleEvents(Ti.PINCH,u&&(a||l)),this.toggleEvents(Ti.TRIPLE_PAN,u&&l),this.toggleEvents(Ti.DOUBLE_TAP,u&&o),this.toggleEvents(Ti.KEYBOARD,u&&c),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,tr,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,tr,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ul},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,tr,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ul},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,tr,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,tr,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ul},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Or._startPinchRotation=e.rotation,Or._lastPinchEvent=e,this.updateViewport(r,tr,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Or._startPinchRotation-r})}return this.updateViewport(n,tr,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Or._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Or;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:ul},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Or._startPinchRotation=null,Or._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),c.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),c.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(i),c.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(i),c.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(i),c.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(i),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?tr:e?{...n,transitionInterpolator:new Kg({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class BE{constructor(e,n){g(this,"_viewportProps",void 0),g(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Ny=5,WO=1.2;class HO extends BE{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:f=20,minZoom:h=0,maxPitch:d=60,minPitch:p=0,startPanLngLat:m,startZoomLngLat:T,startRotatePos:v,startBearing:y,startPitch:w,startZoom:x,normalize:S=!0}=e;Ne(Number.isFinite(s)),Ne(Number.isFinite(i)),Ne(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:f,minZoom:h,maxPitch:d,minPitch:p,normalize:S,position:u},{startPanLngLat:m,startZoomLngLat:T,startRotatePos:v,startBearing:y,startPitch:w,startZoom:x}),g(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=Ve(l,a,o);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Ve(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Ve(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,VR(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:c,height:u}=this.getViewportProps(),f=s/c;let h=0;o>0?Math.abs(u-l)>Ny&&(h=o/(l-u)*WO):o<0&&l>Ny&&(h=1-a/l),h=Ve(h,-1,1);const{minPitch:d,maxPitch:p}=this.getViewportProps(),m=i+180*f;let T=r;return h>0?T=r+h*(p-r):h<0&&(T=r-h*(d-r)),{pitch:T,bearing:m}}}class $O extends UE{constructor(...e){super(...e),g(this,"ControllerState",HO),g(this,"transition",{transitionDuration:300,transitionInterpolator:new Kg({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),g(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Qg extends ei{get ViewportType(){return En}get ControllerType(){return $O}}g(Qg,"displayName","MapView");class XO extends du{constructor(e,n){super(e,n),g(this,"maskMap",void 0),g(this,"fbo",void 0);const{mapSize:r=2048}=n;this.maskMap=new ot(e,{width:r,height:r,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.fbo=new Ce(e,{id:"maskmap",width:r,height:r,attachments:{[36064]:this.maskMap}})}render(e){const n=this.gl,r=[!1,!1,!1,!1];return r[e.channel]=!0,Dt(n,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:r,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return e.props.operation===ma.MASK}delete(){this.fbo.delete(),this.maskMap.delete()}}const YO=new Je().lookAt({eye:[0,0,1]});function qO({width:t,height:e,near:n,far:r,padding:i}){let s=-t/2,o=t/2,a=-e/2,l=e/2;if(i){const{left:c=0,right:u=0,top:f=0,bottom:h=0}=i,d=Ve((c+t-u)/2,0,t)-t/2,p=Ve((f+e-h)/2,0,e)-e/2;s-=d,o-=d,a+=p,l+=p}return new Je().ortho({left:s,right:o,bottom:a,top:l,near:n,far:r})}class ZO extends Cr{constructor(e){const{width:n,height:r,near:i=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:l=null,flipY:c=!0}=e,u=Array.isArray(o)?o[0]:o,f=Array.isArray(o)?o[1]:o,h=Math.min(u,f),d=Math.pow(2,h);let p;if(u!==f){const m=Math.pow(2,u),T=Math.pow(2,f);p={unitsPerMeter:[m/d,T/d,1],metersPerUnit:[d/m,d/T,1]}}super({...e,longitude:void 0,position:a,viewMatrix:YO.clone().scale([d,d*(c?-1:1),d]),projectionMatrix:qO({width:n||1,height:r||1,padding:l,near:i,far:s}),zoom:h,distanceScales:p})}projectFlat([e,n]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],n*r[1]]}unprojectFlat([e,n]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],n*r[1]]}panByPosition(e,n){const r=hu(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Lc([],i,aE([],r)),o=Lc([],this.center,s);return{target:this.unprojectFlat(o)}}}class KO extends BE{constructor(e){const{width:n,height:r,rotationX:i=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-1/0,maxZoom:f=1/0,startPanPosition:h,startRotatePos:d,startRotationX:p,startRotationOrbit:m,startZoomPosition:T,startZoom:v}=e;super({width:n,height:r,rotationX:i,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:f},{startPanPosition:h,startRotatePos:d,startRotationX:p,startRotationOrbit:m,startZoomPosition:T,startZoom:v}),g(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:n}){const r=this.getState().startPanPosition||n;if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:l}=this.getViewportProps();if(!i||s===void 0||o===void 0)return this;let c;if(e){let u=(e[0]-i[0])/a;const f=(e[1]-i[1])/l;(s<-90||s>90)&&(u*=-1),c={rotationX:s+f*180,rotationOrbit:o+u*180}}else c={rotationX:s+r,rotationOrbit:o+n};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:i}=r;return Math.abs(i-n.rotationOrbit)>180&&(r.rotationOrbit=i<0?i+360:i-360),r}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomPosition:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:r,startZoom:i}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);const s=n+Math.log2(e);return Ve(s,i,r)}_panFromCenter(e){const{width:n,height:r,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(i)?[Ve(i[0],r,n),Ve(i[1],r,n)]:Ve(i,r,n),e.rotationX=Ve(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=mO(a+180,360)-180),e}}class QO extends KO{constructor(e){super(e),g(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(n)){let[o,a]=n;switch(this.zoomAxis){case"X":o=Ve(o+s,i,r);break;case"Y":a=Ve(a+s,i,r);break;default:let l=Math.min(o+s,a+s);l<i&&(s+=i-l),l=Math.max(o+s,a+s),l>r&&(s+=r-l),o+=s,a+=s}return[o,a]}return Ve(n+s,i,r)}}class JO extends UE{constructor(...e){super(...e),g(this,"ControllerState",QO),g(this,"transition",{transitionDuration:300,transitionInterpolator:new Kg(["target","zoom"])}),g(this,"dragMode","pan")}_onPanRotate(){return!1}}class VE extends ei{get ViewportType(){return ZO}get ControllerType(){return JO}}g(VE,"displayName","OrthographicView");function ek({layers:t,viewport:e}){let n=null;for(const s of t){const o=s.getBounds();o&&(n?(n[0]=Math.min(n[0],o[0][0]),n[1]=Math.min(n[1],o[0][1]),n[2]=Math.max(n[2],o[1][0]),n[3]=Math.max(n[3],o[1][1])):n=[o[0][0],o[0][1],o[1][0],o[1][1]])}const r=e.getBounds();if(!n)return r;const i=nk(r);return n[2]-n[0]<i[2]-i[0]||n[3]-n[1]<i[3]-i[1]||(n[0]=Math.max(n[0],i[0]),n[1]=Math.max(n[1],i[1]),n[2]=Math.min(n[2],i[2]),n[3]=Math.min(n[3],i[3])),n}function tk({bounds:t,viewport:e,width:n,height:r}){if(t[2]<=t[0]||t[3]<=t[1])return null;const i=1;if(n-=i*2,r-=i*2,e instanceof En){const{longitude:a,latitude:l,zoom:c}=kE({width:n,height:r,bounds:[[t[0],t[1]],[t[2],t[3]]],maxZoom:20});return new En({longitude:a,latitude:l,zoom:c,x:i,y:i,width:n,height:r})}const s=[(t[0]+t[2])/2,(t[1]+t[3])/2,0],o=Math.min(20,n/(t[2]-t[0]),r/(t[3]-t[1]));return new VE({x:i,y:i}).makeViewport({width:n,height:r,viewState:{target:s,zoom:Math.log2(o)}})}function nk(t){const e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}class rk{constructor(){g(this,"id","mask-effect"),g(this,"props",null),g(this,"useInPicking",!0),g(this,"dummyMaskMap",void 0),g(this,"channels",[]),g(this,"masks",null),g(this,"maskPass",void 0),g(this,"maskMap",void 0),g(this,"lastViewport",void 0)}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new ot(e,{width:1,height:1}));const a=n.filter(f=>f.props.visible&&f.props.operation===ma.MASK);if(a.length===0){this.masks=null,this.channels.length=0;return}this.masks={},this.maskPass||(this.maskPass=new XO(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const l=this._sortMaskChannels(a),c=i[0],u=!this.lastViewport||!this.lastViewport.equals(c);for(const f in l)this._renderChannel(l[f],{layerFilter:r,onViewportActive:s,views:o,viewport:c,viewportChanged:u})}_renderChannel(e,{layerFilter:n,onViewportActive:r,views:i,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const l=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((c,u)=>c!==a.layerBounds[u]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(l||o)&&(this.lastViewport=s,e.bounds=ek({layers:e.layers,viewport:s}),l||!_n(e.bounds,a.bounds))){const{maskPass:c,maskMap:u}=this,f=tk({bounds:e.bounds,viewport:s,width:u.width,height:u.height});e.maskBounds=f?f.getBounds():[0,0,1,1],c.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:n,viewports:f?[f]:[],onViewportActive:r,views:i,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const n={};let r=0;for(const i of e){const{id:s}=i.root;let o=n[s];if(!o){if(++r>4){H.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>(a==null?void 0:a.id)===s),layers:[],layerBounds:[],coordinateOrigin:i.root.props.coordinateOrigin,coordinateSystem:i.root.props.coordinateSystem},n[s]=o}o.layers.push(i),o.layerBounds.push(i.getBounds())}for(let i=0;i<4;i++){const s=this.channels[i];(!s||!(s.id in n))&&(this.channels[i]=null)}for(const i in n){const s=n[i];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return n}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const ik=new FE;class sk{constructor(){g(this,"effects",void 0),g(this,"_internalEffects",void 0),g(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!Ss(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new rk),e.some(n=>n instanceof FE)||this._internalEffects.push(ik)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class ok extends du{shouldDrawLayer(e){return e.props.operation===ma.DRAW}}const Fy={blendFunc:[1,0,32771,0],blendEquation:32774};class jE extends du{constructor(...e){super(...e),g(this,"pickZ",void 0),g(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:f,effects:h,pass:d="picking",pickZ:p}){const m=this.gl;this.pickZ=p;const T=p?null:{byLayer:new Map,byAlpha:[]};this._colors=T;const v=Dt(m,{scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Fy,blend:!p},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:f,effects:h==null?void 0:h.filter(w=>w.useInPicking),pass:d}));return this._colors=null,{decodePickingColor:T&&lk.bind(null,T),stats:v}}shouldDrawLayer(e){return e.props.pickable&&e.props.operation===ma.DRAW}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters};return this._colors?(Object.assign(i,Fy),i.blend=!0,i.blendColor=ak(this._colors,e,r)):i.blend=!1,i}}function ak(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(H.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function lk(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const ck="deckRenderer.renderLayers";class uk{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new ok(e),this.pickLayersPass=new jE(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||Ce.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const r=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,i=n.render({...e,target:r});this._postRender(e.effects,e),this.renderCount++,qe(ck,this,i,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){let r=null;for(const i of e)i.preRender(this.gl,n),i.postRender&&(r=i);r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new Ce(this.gl),new Ce(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const fk={pickedColor:null,pickedObjectIndex:-1};function hk({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:c}=s;let u=i*i,f=-1,h=0;for(let d=0;d<c;d++){const p=d+a-r,m=p*p;if(m>u)h+=4*l;else for(let T=0;T<l;T++){if(t[h+3]-1>=0){const y=T+o-n,w=y*y+m;w<=u&&(u=w,f=h)}h+=4}}if(f>=0){const d=t.slice(f,f+4),p=e(d);if(p){const m=Math.floor(f/4/l),T=f/4-m*l;return{...p,pickedColor:d,pickedX:o+T,pickedY:a+m}}H.error("Picked non-existent layer. Is picking buffer corrupt?")()}return fk}function dk({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):H.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function GE({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=pk((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function gk(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const f=n.index,h=n.layerId,d=o?o.props.id:null;if(d!==h||a!==f){if(d!==h){const p=i.find(m=>m.props.id===h);p&&l.unshift(p)}n.layerId=d,n.index=a,n.info=null}}const c=GE(t),u=new Map;return u.set(null,c),l.forEach(f=>{let h={...c};f===o&&(h.color=s,h.index=a,h.picked=!0),h=WE({layer:f,info:h,mode:r});const d=h.layer;f===o&&r==="hover"&&(n.info=h),u.set(d.id,h),r==="hover"&&d.updateAutoHighlight(h)}),u}function WE({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function pk(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class mk{constructor(e){g(this,"gl",void 0),g(this,"pickingFBO",void 0),g(this,"depthFBO",void 0),g(this,"pickLayersPass",void 0),g(this,"layerFilter",void 0),g(this,"lastPickedInfo",void 0),g(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new jE(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(h=>h.id===o):null,c=a&&i.find(h=>h.id===a)||i[0],u=c&&c.unproject([e-c.x,n-c.y]);return{...s,...{x:e,y:n,viewport:c,coordinate:u,layer:l}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new Ce(r),Ce.isSupported(r,{colorBufferFloat:!0}))){const i=new Ce(r);i.attach({[36064]:new ot(r,{format:X(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>r.isPickable()&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:f}){const h=this._getPickable(e),d=hs(this.gl);if(!h)return{result:[],emptyInfo:GE({viewports:r,x:i,y:s,pixelRatio:d})};this._resizeBuffer();const p=bf(this.gl,[i,s],!0),m=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],T=Math.round(o*d),{width:v,height:y}=this.pickingFBO,w=this._getPickingRect({deviceX:m[0],deviceY:m[1],deviceRadius:T,deviceWidth:v,deviceHeight:y}),x={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let S;const P=[],C=new Set;for(let M=0;M<a;M++){let O;if(w){const B=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:u,deviceRect:w,cullRect:x,effects:f,pass:"picking:".concat(l)});O=hk({...B,deviceX:m[0],deviceY:m[1],deviceRadius:T,deviceRect:w})}else O={pickedColor:null,pickedObjectIndex:-1};let I;O.pickedLayer&&c&&this.depthFBO&&(I=this._drawAndSample({layers:[O.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:O.pickedX,y:O.pickedY,width:1,height:1},cullRect:x,effects:f,pass:"picking:".concat(l,":z")},!0).pickedColors[0]),O.pickedLayer&&M+1<a&&(C.add(O.pickedLayer),O.pickedLayer.disablePickingIndex(O.pickedObjectIndex)),S=gk({pickInfo:O,lastPickedInfo:this.lastPickedInfo,mode:l,layers:h,viewports:r,x:i,y:s,z:I,pixelRatio:d});for(const B of S.values())B.layer&&P.push(B);if(!O.pickedColor)break}for(const M of C)M.restorePickingColors();return{result:P,emptyInfo:S.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:f}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const d=hs(this.gl),p=bf(this.gl,[i,s],!0),m=p.x,T=p.y+p.height,v=bf(this.gl,[i+o,s+a],!0),y=v.x+v.width,w=v.y,x={x:m,y:w,width:y-m,height:T-w},S=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:u,deviceRect:x,cullRect:{x:i,y:s,width:o,height:a},effects:f,pass:"picking:".concat(l)}),P=dk(S),C=new Map,M=Number.isFinite(c);for(let O=0;O<P.length&&!(M&&c&&C.size>=c);O++){const I=P[O];let B={color:I.pickedColor,layer:null,index:I.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:d};B=WE({layer:I.pickedLayer,info:B,mode:l}),C.has(B.object)||C.set(B.object,B)}return Array.from(C.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},c=!1){const u=c?this.depthFBO:this.pickingFBO,{decodePickingColor:f}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c}),{x:h,y:d,width:p,height:m}=s,T=new(c?Float32Array:Uint8Array)(p*m*4);return fu(u,{sourceX:h,sourceY:d,sourceWidth:p,sourceHeight:m,target:T}),{pickedColors:T,decodePickingColor:f}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,c=Math.min(s,n+r+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const yk={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class vk{constructor(e){g(this,"el",null),g(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,yk),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var ti={},_k={get exports(){return ti},set exports(t){ti=t}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,c=Math.abs,u=Date.now;function f(_,E,b){return setTimeout(w(_,b),E)}function h(_,E,b){return Array.isArray(_)?(d(_,b[E],b),!0):!1}function d(_,E,b){var A;if(_)if(_.forEach)_.forEach(E,b);else if(_.length!==i)for(A=0;A<_.length;)E.call(b,_[A],A,_),A++;else for(A in _)_.hasOwnProperty(A)&&E.call(b,_[A],A,_)}function p(_,E,b){var A="DEPRECATED METHOD: "+E+`
`+b+` AT 
`;return function(){var L=new Error("get-stack-trace"),N=L&&L.stack?L.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",$=e.console&&(e.console.warn||e.console.log);return $&&$.call(e.console,A,N),_.apply(this,arguments)}}var m;typeof Object.assign!="function"?m=function(E){if(E===i||E===null)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(E),A=1;A<arguments.length;A++){var L=arguments[A];if(L!==i&&L!==null)for(var N in L)L.hasOwnProperty(N)&&(b[N]=L[N])}return b}:m=Object.assign;var T=p(function(E,b,A){for(var L=Object.keys(b),N=0;N<L.length;)(!A||A&&E[L[N]]===i)&&(E[L[N]]=b[L[N]]),N++;return E},"extend","Use `assign`."),v=p(function(E,b){return T(E,b,!0)},"merge","Use `assign`.");function y(_,E,b){var A=E.prototype,L;L=_.prototype=Object.create(A),L.constructor=_,L._super=A,b&&m(L,b)}function w(_,E){return function(){return _.apply(E,arguments)}}function x(_,E){return typeof _==a?_.apply(E&&E[0]||i,E):_}function S(_,E){return _===i?E:_}function P(_,E,b){d(I(E),function(A){_.addEventListener(A,b,!1)})}function C(_,E,b){d(I(E),function(A){_.removeEventListener(A,b,!1)})}function M(_,E){for(;_;){if(_==E)return!0;_=_.parentNode}return!1}function O(_,E){return _.indexOf(E)>-1}function I(_){return _.trim().split(/\s+/g)}function B(_,E,b){if(_.indexOf&&!b)return _.indexOf(E);for(var A=0;A<_.length;){if(b&&_[A][b]==E||!b&&_[A]===E)return A;A++}return-1}function G(_){return Array.prototype.slice.call(_,0)}function V(_,E,b){for(var A=[],L=[],N=0;N<_.length;){var $=E?_[N][E]:_[N];B(L,$)<0&&A.push(_[N]),L[N]=$,N++}return b&&(E?A=A.sort(function(De,tt){return De[E]>tt[E]}):A=A.sort()),A}function q(_,E){for(var b,A,L=E[0].toUpperCase()+E.slice(1),N=0;N<s.length;){if(b=s[N],A=b?b+L:E,A in _)return A;N++}return i}var Bt=1;function Cs(){return Bt++}function fi(_){var E=_.ownerDocument||_;return E.defaultView||E.parentWindow||e}var D=/mobile|tablet|ip(ad|hone|od)|android/i,j="ontouchstart"in e,W=q(e,"PointerEvent")!==i,ge=j&&D.test(navigator.userAgent),fe="touch",hi="pen",Vt="mouse",Ls="kinect",Tn=25,be=1,Lr=2,Se=4,ct=8,xa=1,Ms=2,Is=4,Rs=8,Os=16,rn=Ms|Is,Mr=Rs|Os,Lp=rn|Mr,Mp=["x","y"],ba=["clientX","clientY"];function Lt(_,E){var b=this;this.manager=_,this.callback=E,this.element=_.element,this.target=_.options.inputTarget,this.domHandler=function(A){x(_.options.enable,[_])&&b.handler(A)},this.init()}Lt.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(fi(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(fi(this.element),this.evWin,this.domHandler)}};function qT(_){var E,b=_.options.inputClass;return b?E=b:W?E=ku:ge?E=Aa:j?E=Nu:E=Pa,new E(_,ZT)}function ZT(_,E,b){var A=b.pointers.length,L=b.changedPointers.length,N=E&be&&A-L===0,$=E&(Se|ct)&&A-L===0;b.isFirst=!!N,b.isFinal=!!$,N&&(_.session={}),b.eventType=E,KT(_,b),_.emit("hammer.input",b),_.recognize(b),_.session.prevInput=b}function KT(_,E){var b=_.session,A=E.pointers,L=A.length;b.firstInput||(b.firstInput=Ip(E)),L>1&&!b.firstMultiple?b.firstMultiple=Ip(E):L===1&&(b.firstMultiple=!1);var N=b.firstInput,$=b.firstMultiple,Oe=$?$.center:N.center,De=E.center=Rp(A);E.timeStamp=u(),E.deltaTime=E.timeStamp-N.timeStamp,E.angle=Ou(Oe,De),E.distance=Sa(Oe,De),QT(b,E),E.offsetDirection=kp(E.deltaX,E.deltaY);var tt=Op(E.deltaTime,E.deltaX,E.deltaY);E.overallVelocityX=tt.x,E.overallVelocityY=tt.y,E.overallVelocity=c(tt.x)>c(tt.y)?tt.x:tt.y,E.scale=$?tx($.pointers,A):1,E.rotation=$?ex($.pointers,A):0,E.maxPointers=b.prevInput?E.pointers.length>b.prevInput.maxPointers?E.pointers.length:b.prevInput.maxPointers:E.pointers.length,JT(b,E);var on=_.element;M(E.srcEvent.target,on)&&(on=E.srcEvent.target),E.target=on}function QT(_,E){var b=E.center,A=_.offsetDelta||{},L=_.prevDelta||{},N=_.prevInput||{};(E.eventType===be||N.eventType===Se)&&(L=_.prevDelta={x:N.deltaX||0,y:N.deltaY||0},A=_.offsetDelta={x:b.x,y:b.y}),E.deltaX=L.x+(b.x-A.x),E.deltaY=L.y+(b.y-A.y)}function JT(_,E){var b=_.lastInterval||E,A=E.timeStamp-b.timeStamp,L,N,$,Oe;if(E.eventType!=ct&&(A>Tn||b.velocity===i)){var De=E.deltaX-b.deltaX,tt=E.deltaY-b.deltaY,on=Op(A,De,tt);N=on.x,$=on.y,L=c(on.x)>c(on.y)?on.x:on.y,Oe=kp(De,tt),_.lastInterval=E}else L=b.velocity,N=b.velocityX,$=b.velocityY,Oe=b.direction;E.velocity=L,E.velocityX=N,E.velocityY=$,E.direction=Oe}function Ip(_){for(var E=[],b=0;b<_.pointers.length;)E[b]={clientX:l(_.pointers[b].clientX),clientY:l(_.pointers[b].clientY)},b++;return{timeStamp:u(),pointers:E,center:Rp(E),deltaX:_.deltaX,deltaY:_.deltaY}}function Rp(_){var E=_.length;if(E===1)return{x:l(_[0].clientX),y:l(_[0].clientY)};for(var b=0,A=0,L=0;L<E;)b+=_[L].clientX,A+=_[L].clientY,L++;return{x:l(b/E),y:l(A/E)}}function Op(_,E,b){return{x:E/_||0,y:b/_||0}}function kp(_,E){return _===E?xa:c(_)>=c(E)?_<0?Ms:Is:E<0?Rs:Os}function Sa(_,E,b){b||(b=Mp);var A=E[b[0]]-_[b[0]],L=E[b[1]]-_[b[1]];return Math.sqrt(A*A+L*L)}function Ou(_,E,b){b||(b=Mp);var A=E[b[0]]-_[b[0]],L=E[b[1]]-_[b[1]];return Math.atan2(L,A)*180/Math.PI}function ex(_,E){return Ou(E[1],E[0],ba)+Ou(_[1],_[0],ba)}function tx(_,E){return Sa(E[0],E[1],ba)/Sa(_[0],_[1],ba)}var nx={mousedown:be,mousemove:Lr,mouseup:Se},rx="mousedown",ix="mousemove mouseup";function Pa(){this.evEl=rx,this.evWin=ix,this.pressed=!1,Lt.apply(this,arguments)}y(Pa,Lt,{handler:function(E){var b=nx[E.type];b&be&&E.button===0&&(this.pressed=!0),b&Lr&&E.which!==1&&(b=Se),this.pressed&&(b&Se&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[E],changedPointers:[E],pointerType:Vt,srcEvent:E}))}});var sx={pointerdown:be,pointermove:Lr,pointerup:Se,pointercancel:ct,pointerout:ct},ox={2:fe,3:hi,4:Vt,5:Ls},Np="pointerdown",Fp="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Np="MSPointerDown",Fp="MSPointerMove MSPointerUp MSPointerCancel");function ku(){this.evEl=Np,this.evWin=Fp,Lt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}y(ku,Lt,{handler:function(E){var b=this.store,A=!1,L=E.type.toLowerCase().replace("ms",""),N=sx[L],$=ox[E.pointerType]||E.pointerType,Oe=$==fe,De=B(b,E.pointerId,"pointerId");N&be&&(E.button===0||Oe)?De<0&&(b.push(E),De=b.length-1):N&(Se|ct)&&(A=!0),!(De<0)&&(b[De]=E,this.callback(this.manager,N,{pointers:b,changedPointers:[E],pointerType:$,srcEvent:E}),A&&b.splice(De,1))}});var ax={touchstart:be,touchmove:Lr,touchend:Se,touchcancel:ct},lx="touchstart",cx="touchstart touchmove touchend touchcancel";function Dp(){this.evTarget=lx,this.evWin=cx,this.started=!1,Lt.apply(this,arguments)}y(Dp,Lt,{handler:function(E){var b=ax[E.type];if(b===be&&(this.started=!0),!!this.started){var A=ux.call(this,E,b);b&(Se|ct)&&A[0].length-A[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:A[0],changedPointers:A[1],pointerType:fe,srcEvent:E})}}});function ux(_,E){var b=G(_.touches),A=G(_.changedTouches);return E&(Se|ct)&&(b=V(b.concat(A),"identifier",!0)),[b,A]}var fx={touchstart:be,touchmove:Lr,touchend:Se,touchcancel:ct},hx="touchstart touchmove touchend touchcancel";function Aa(){this.evTarget=hx,this.targetIds={},Lt.apply(this,arguments)}y(Aa,Lt,{handler:function(E){var b=fx[E.type],A=dx.call(this,E,b);A&&this.callback(this.manager,b,{pointers:A[0],changedPointers:A[1],pointerType:fe,srcEvent:E})}});function dx(_,E){var b=G(_.touches),A=this.targetIds;if(E&(be|Lr)&&b.length===1)return A[b[0].identifier]=!0,[b,b];var L,N,$=G(_.changedTouches),Oe=[],De=this.target;if(N=b.filter(function(tt){return M(tt.target,De)}),E===be)for(L=0;L<N.length;)A[N[L].identifier]=!0,L++;for(L=0;L<$.length;)A[$[L].identifier]&&Oe.push($[L]),E&(Se|ct)&&delete A[$[L].identifier],L++;if(Oe.length)return[V(N.concat(Oe),"identifier",!0),Oe]}var gx=2500,zp=25;function Nu(){Lt.apply(this,arguments);var _=w(this.handler,this);this.touch=new Aa(this.manager,_),this.mouse=new Pa(this.manager,_),this.primaryTouch=null,this.lastTouches=[]}y(Nu,Lt,{handler:function(E,b,A){var L=A.pointerType==fe,N=A.pointerType==Vt;if(!(N&&A.sourceCapabilities&&A.sourceCapabilities.firesTouchEvents)){if(L)px.call(this,b,A);else if(N&&mx.call(this,A))return;this.callback(E,b,A)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function px(_,E){_&be?(this.primaryTouch=E.changedPointers[0].identifier,Up.call(this,E)):_&(Se|ct)&&Up.call(this,E)}function Up(_){var E=_.changedPointers[0];if(E.identifier===this.primaryTouch){var b={x:E.clientX,y:E.clientY};this.lastTouches.push(b);var A=this.lastTouches,L=function(){var N=A.indexOf(b);N>-1&&A.splice(N,1)};setTimeout(L,gx)}}function mx(_){for(var E=_.srcEvent.clientX,b=_.srcEvent.clientY,A=0;A<this.lastTouches.length;A++){var L=this.lastTouches[A],N=Math.abs(E-L.x),$=Math.abs(b-L.y);if(N<=zp&&$<=zp)return!0}return!1}var Bp=q(o.style,"touchAction"),Vp=Bp!==i,jp="compute",Gp="auto",Fu="manipulation",Ir="none",ks="pan-x",Ns="pan-y",Ca=vx();function Du(_,E){this.manager=_,this.set(E)}Du.prototype={set:function(_){_==jp&&(_=this.compute()),Vp&&this.manager.element.style&&Ca[_]&&(this.manager.element.style[Bp]=_),this.actions=_.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var _=[];return d(this.manager.recognizers,function(E){x(E.options.enable,[E])&&(_=_.concat(E.getTouchAction()))}),yx(_.join(" "))},preventDefaults:function(_){var E=_.srcEvent,b=_.offsetDirection;if(this.manager.session.prevented){E.preventDefault();return}var A=this.actions,L=O(A,Ir)&&!Ca[Ir],N=O(A,Ns)&&!Ca[Ns],$=O(A,ks)&&!Ca[ks];if(L){var Oe=_.pointers.length===1,De=_.distance<2,tt=_.deltaTime<250;if(Oe&&De&&tt)return}if(!($&&N)&&(L||N&&b&rn||$&&b&Mr))return this.preventSrc(E)},preventSrc:function(_){this.manager.session.prevented=!0,_.preventDefault()}};function yx(_){if(O(_,Ir))return Ir;var E=O(_,ks),b=O(_,Ns);return E&&b?Ir:E||b?E?ks:Ns:O(_,Fu)?Fu:Gp}function vx(){if(!Vp)return!1;var _={},E=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(b){_[b]=E?e.CSS.supports("touch-action",b):!0}),_}var La=1,Mt=2,di=4,qn=8,xn=qn,Fs=16,sn=32;function bn(_){this.options=m({},this.defaults,_||{}),this.id=Cs(),this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=La,this.simultaneous={},this.requireFail=[]}bn.prototype={defaults:{},set:function(_){return m(this.options,_),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(_){if(h(_,"recognizeWith",this))return this;var E=this.simultaneous;return _=Ma(_,this),E[_.id]||(E[_.id]=_,_.recognizeWith(this)),this},dropRecognizeWith:function(_){return h(_,"dropRecognizeWith",this)?this:(_=Ma(_,this),delete this.simultaneous[_.id],this)},requireFailure:function(_){if(h(_,"requireFailure",this))return this;var E=this.requireFail;return _=Ma(_,this),B(E,_)===-1&&(E.push(_),_.requireFailure(this)),this},dropRequireFailure:function(_){if(h(_,"dropRequireFailure",this))return this;_=Ma(_,this);var E=B(this.requireFail,_);return E>-1&&this.requireFail.splice(E,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(_){return!!this.simultaneous[_.id]},emit:function(_){var E=this,b=this.state;function A(L){E.manager.emit(L,_)}b<qn&&A(E.options.event+Wp(b)),A(E.options.event),_.additionalEvent&&A(_.additionalEvent),b>=qn&&A(E.options.event+Wp(b))},tryEmit:function(_){if(this.canEmit())return this.emit(_);this.state=sn},canEmit:function(){for(var _=0;_<this.requireFail.length;){if(!(this.requireFail[_].state&(sn|La)))return!1;_++}return!0},recognize:function(_){var E=m({},_);if(!x(this.options.enable,[this,E])){this.reset(),this.state=sn;return}this.state&(xn|Fs|sn)&&(this.state=La),this.state=this.process(E),this.state&(Mt|di|qn|Fs)&&this.tryEmit(E)},process:function(_){},getTouchAction:function(){},reset:function(){}};function Wp(_){return _&Fs?"cancel":_&qn?"end":_&di?"move":_&Mt?"start":""}function Hp(_){return _==Os?"down":_==Rs?"up":_==Ms?"left":_==Is?"right":""}function Ma(_,E){var b=E.manager;return b?b.get(_):_}function jt(){bn.apply(this,arguments)}y(jt,bn,{defaults:{pointers:1},attrTest:function(_){var E=this.options.pointers;return E===0||_.pointers.length===E},process:function(_){var E=this.state,b=_.eventType,A=E&(Mt|di),L=this.attrTest(_);return A&&(b&ct||!L)?E|Fs:A||L?b&Se?E|qn:E&Mt?E|di:Mt:sn}});function Ia(){jt.apply(this,arguments),this.pX=null,this.pY=null}y(Ia,jt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Lp},getTouchAction:function(){var _=this.options.direction,E=[];return _&rn&&E.push(Ns),_&Mr&&E.push(ks),E},directionTest:function(_){var E=this.options,b=!0,A=_.distance,L=_.direction,N=_.deltaX,$=_.deltaY;return L&E.direction||(E.direction&rn?(L=N===0?xa:N<0?Ms:Is,b=N!=this.pX,A=Math.abs(_.deltaX)):(L=$===0?xa:$<0?Rs:Os,b=$!=this.pY,A=Math.abs(_.deltaY))),_.direction=L,b&&A>E.threshold&&L&E.direction},attrTest:function(_){return jt.prototype.attrTest.call(this,_)&&(this.state&Mt||!(this.state&Mt)&&this.directionTest(_))},emit:function(_){this.pX=_.deltaX,this.pY=_.deltaY;var E=Hp(_.direction);E&&(_.additionalEvent=this.options.event+E),this._super.emit.call(this,_)}});function zu(){jt.apply(this,arguments)}y(zu,jt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ir]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.scale-1)>this.options.threshold||this.state&Mt)},emit:function(_){if(_.scale!==1){var E=_.scale<1?"in":"out";_.additionalEvent=this.options.event+E}this._super.emit.call(this,_)}});function Uu(){bn.apply(this,arguments),this._timer=null,this._input=null}y(Uu,bn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Gp]},process:function(_){var E=this.options,b=_.pointers.length===E.pointers,A=_.distance<E.threshold,L=_.deltaTime>E.time;if(this._input=_,!A||!b||_.eventType&(Se|ct)&&!L)this.reset();else if(_.eventType&be)this.reset(),this._timer=f(function(){this.state=xn,this.tryEmit()},E.time,this);else if(_.eventType&Se)return xn;return sn},reset:function(){clearTimeout(this._timer)},emit:function(_){this.state===xn&&(_&&_.eventType&Se?this.manager.emit(this.options.event+"up",_):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function Bu(){jt.apply(this,arguments)}y(Bu,jt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ir]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.rotation)>this.options.threshold||this.state&Mt)}});function Vu(){jt.apply(this,arguments)}y(Vu,jt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:rn|Mr,pointers:1},getTouchAction:function(){return Ia.prototype.getTouchAction.call(this)},attrTest:function(_){var E=this.options.direction,b;return E&(rn|Mr)?b=_.overallVelocity:E&rn?b=_.overallVelocityX:E&Mr&&(b=_.overallVelocityY),this._super.attrTest.call(this,_)&&E&_.offsetDirection&&_.distance>this.options.threshold&&_.maxPointers==this.options.pointers&&c(b)>this.options.velocity&&_.eventType&Se},emit:function(_){var E=Hp(_.offsetDirection);E&&this.manager.emit(this.options.event+E,_),this.manager.emit(this.options.event,_)}});function Ra(){bn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}y(Ra,bn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Fu]},process:function(_){var E=this.options,b=_.pointers.length===E.pointers,A=_.distance<E.threshold,L=_.deltaTime<E.time;if(this.reset(),_.eventType&be&&this.count===0)return this.failTimeout();if(A&&L&&b){if(_.eventType!=Se)return this.failTimeout();var N=this.pTime?_.timeStamp-this.pTime<E.interval:!0,$=!this.pCenter||Sa(this.pCenter,_.center)<E.posThreshold;this.pTime=_.timeStamp,this.pCenter=_.center,!$||!N?this.count=1:this.count+=1,this._input=_;var Oe=this.count%E.taps;if(Oe===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=xn,this.tryEmit()},E.interval,this),Mt):xn}return sn},failTimeout:function(){return this._timer=f(function(){this.state=sn},this.options.interval,this),sn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==xn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Sn(_,E){return E=E||{},E.recognizers=S(E.recognizers,Sn.defaults.preset),new ju(_,E)}Sn.VERSION="2.0.7",Sn.defaults={domEvents:!1,touchAction:jp,enable:!0,inputTarget:null,inputClass:null,preset:[[Bu,{enable:!1}],[zu,{enable:!1},["rotate"]],[Vu,{direction:rn}],[Ia,{direction:rn},["swipe"]],[Ra],[Ra,{event:"doubletap",taps:2},["tap"]],[Uu]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var _x=1,$p=2;function ju(_,E){this.options=m({},Sn.defaults,E||{}),this.options.inputTarget=this.options.inputTarget||_,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=_,this.input=qT(this),this.touchAction=new Du(this,this.options.touchAction),Xp(this,!0),d(this.options.recognizers,function(b){var A=this.add(new b[0](b[1]));b[2]&&A.recognizeWith(b[2]),b[3]&&A.requireFailure(b[3])},this)}ju.prototype={set:function(_){return m(this.options,_),_.touchAction&&this.touchAction.update(),_.inputTarget&&(this.input.destroy(),this.input.target=_.inputTarget,this.input.init()),this},stop:function(_){this.session.stopped=_?$p:_x},recognize:function(_){var E=this.session;if(!E.stopped){this.touchAction.preventDefaults(_);var b,A=this.recognizers,L=E.curRecognizer;(!L||L&&L.state&xn)&&(L=E.curRecognizer=null);for(var N=0;N<A.length;)b=A[N],E.stopped!==$p&&(!L||b==L||b.canRecognizeWith(L))?b.recognize(_):b.reset(),!L&&b.state&(Mt|di|qn)&&(L=E.curRecognizer=b),N++}},get:function(_){if(_ instanceof bn)return _;for(var E=this.recognizers,b=0;b<E.length;b++)if(E[b].options.event==_)return E[b];return null},add:function(_){if(h(_,"add",this))return this;var E=this.get(_.options.event);return E&&this.remove(E),this.recognizers.push(_),_.manager=this,this.touchAction.update(),_},remove:function(_){if(h(_,"remove",this))return this;if(_=this.get(_),_){var E=this.recognizers,b=B(E,_);b!==-1&&(E.splice(b,1),this.touchAction.update())}return this},on:function(_,E){if(_!==i&&E!==i){var b=this.handlers;return d(I(_),function(A){b[A]=b[A]||[],b[A].push(E)}),this}},off:function(_,E){if(_!==i){var b=this.handlers;return d(I(_),function(A){E?b[A]&&b[A].splice(B(b[A],E),1):delete b[A]}),this}},emit:function(_,E){this.options.domEvents&&wx(_,E);var b=this.handlers[_]&&this.handlers[_].slice();if(!(!b||!b.length)){E.type=_,E.preventDefault=function(){E.srcEvent.preventDefault()};for(var A=0;A<b.length;)b[A](E),A++}},destroy:function(){this.element&&Xp(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Xp(_,E){var b=_.element;if(b.style){var A;d(_.options.cssProps,function(L,N){A=q(b.style,N),E?(_.oldCssProps[A]=b.style[A],b.style[A]=L):b.style[A]=_.oldCssProps[A]||""}),E||(_.oldCssProps={})}}function wx(_,E){var b=n.createEvent("Event");b.initEvent(_,!0,!0),b.gesture=E,E.target.dispatchEvent(b)}m(Sn,{INPUT_START:be,INPUT_MOVE:Lr,INPUT_END:Se,INPUT_CANCEL:ct,STATE_POSSIBLE:La,STATE_BEGAN:Mt,STATE_CHANGED:di,STATE_ENDED:qn,STATE_RECOGNIZED:xn,STATE_CANCELLED:Fs,STATE_FAILED:sn,DIRECTION_NONE:xa,DIRECTION_LEFT:Ms,DIRECTION_RIGHT:Is,DIRECTION_UP:Rs,DIRECTION_DOWN:Os,DIRECTION_HORIZONTAL:rn,DIRECTION_VERTICAL:Mr,DIRECTION_ALL:Lp,Manager:ju,Input:Lt,TouchAction:Du,TouchInput:Aa,MouseInput:Pa,PointerEventInput:ku,TouchMouseInput:Nu,SingleTouchInput:Dp,Recognizer:bn,AttrRecognizer:jt,Tap:Ra,Pan:Ia,Swipe:Vu,Pinch:zu,Rotate:Bu,Press:Uu,on:P,off:C,each:d,merge:v,extend:T,assign:m,inherit:y,bindFn:w,prefixed:q});var Ex=typeof e<"u"?e:typeof self<"u"?self:{};Ex.Hammer=Sn,typeof i=="function"&&i.amd?i(function(){return Sn}):t.exports?t.exports=Sn:e[r]=Sn})(window,document,"Hammer")})(_k);const wk=ti,cn=Tx({__proto__:null,default:wk},[ti]),HE=1,$E=2,gd=4,Ek={mousedown:HE,mousemove:$E,mouseup:gd};function Tk(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function xk(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(Tk(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function bk(t){t.prototype.handler=function(n){let r=Ek[n.type];r&HE&&n.button>=0&&(this.pressed=!0),r&$E&&n.which===0&&(r=gd),this.pressed&&(r&gd&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}xk(ti.PointerEventInput);bk(ti.MouseInput);const Sk=ti.Manager;class pu{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const Pk=cn?[[cn.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[cn.Rotate,{enable:!1}],[cn.Pinch,{enable:!1}],[cn.Swipe,{enable:!1}],[cn.Pan,{threshold:0,enable:!1}],[cn.Press,{enable:!1}],[cn.Tap,{event:"doubletap",taps:2,enable:!1}],[cn.Tap,{event:"anytap",enable:!1}],[cn.Tap,{enable:!1}]]:null,Dy={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Ak={doubletap:["tap"]},Ck={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Jg={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Lk={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},zy={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Mk=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Gi=typeof window<"u"?window:global;let pd=!1;try{const t={get passive(){return pd=!0,!0}};Gi.addEventListener("test",null,t),Gi.removeEventListener("test",null)}catch{pd=!1}const Ik=Mk.indexOf("firefox")!==-1,{WHEEL_EVENTS:Rk}=Jg,Uy="wheel",By=4.000244140625,Ok=40,kk=.25;class Nk extends pu{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Gi.WheelEvent&&(Ik&&i.deltaMode===Gi.WheelEvent.DOM_DELTA_PIXEL&&(s/=Gi.devicePixelRatio),i.deltaMode===Gi.WheelEvent.DOM_DELTA_LINE&&(s*=Ok)),s!==0&&s%By===0&&(s=Math.floor(s/By)),i.shiftKey&&s&&(s=s*kk),this.callback({type:Uy,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(Rk),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,pd?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Uy&&(this.options.enable=n)}}const{MOUSE_EVENTS:Fk}=Jg,Vy="pointermove",jy="pointerover",Gy="pointerout",Wy="pointerenter",Hy="pointerleave";class Dk extends pu{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(Fk),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Vy&&(this.enableMoveEvent=n),e===jy&&(this.enableOverEvent=n),e===Gy&&(this.enableOutEvent=n),e===Wy&&(this.enableEnterEvent=n),e===Hy&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(jy,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Gy,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Wy,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(Hy,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(Vy,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:zk}=Jg,$y="keydown",Xy="keyup";class Uk extends pu{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:$y,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:Xy,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(zk),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===$y&&(this.enableDownEvent=n),e===Xy&&(this.enableUpEvent=n)}}const Yy="contextmenu";class Bk extends pu{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:Yy,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===Yy&&(this.options.enable=n)}}const md=1,kc=2,yd=4,Vk={pointerdown:md,pointermove:kc,pointerup:yd,mousedown:md,mousemove:kc,mouseup:yd},jk=1,Gk=2,Wk=3,Hk=0,$k=1,Xk=2,Yk=1,qk=2,Zk=4;function Kk(t){const e=Vk[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return e===yd||e===kc&&!Number.isFinite(n)?(s=i===jk,o=i===Gk,a=i===Wk):e===kc?(s=Boolean(n&Yk),o=Boolean(n&Zk),a=Boolean(n&qk)):e===md&&(s=r===Hk,o=r===$k,a=r===Xk),{leftButton:s,middleButton:o,rightButton:a}}function Qk(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Vf={srcElement:"root",priority:0};class Jk{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Vf;typeof r=="string"||r&&r.addEventListener?l={...Vf,srcElement:r}:r&&(l={...Vf,...r});let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let f=c.length-1;for(;f>=0&&!(c[f].priority>=u.priority);)f--;c.splice(f+1,0,u)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:c,handler:u,once:f}=r[l];if(u({...e,type:c,stopPropagation:s,stopImmediatePropagation:o}),f&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...Kk(e),...Qk(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const eN={events:null,recognizers:null,recognizerOptions:{},Manager:Sk,touchAction:"none",tabIndex:0};class tN{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=Ck[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...eN,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||Pk}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Dy).forEach(i=>{const s=this.manager.get(i);s&&Dy[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new Nk(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Dk(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Uk(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new Bk(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=Ak[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const u in e)this._addEventHandler(u,e[u],r,i,s);return}const{manager:o,events:a}=this,l=zy[e]||e;let c=a.get(l);c||(c=new Jk(this),a.set(l,c),c.recognizerName=Lk[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,n,r,i,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=zy[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function kr(){}const nN=({isDragging:t})=>t?"grabbing":"grab",XE={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:kr,onResize:kr,onViewStateChange:kr,onInteractionStateChange:kr,onBeforeRender:kr,onAfterRender:kr,onLoad:kr,onError:t=>H.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:nN,getTooltip:null,debug:!1,drawPickingColors:!1};class mu{constructor(e){g(this,"props",void 0),g(this,"width",0),g(this,"height",0),g(this,"userData",{}),g(this,"canvas",null),g(this,"viewManager",null),g(this,"layerManager",null),g(this,"effectManager",null),g(this,"deckRenderer",null),g(this,"deckPicker",null),g(this,"eventManager",null),g(this,"tooltip",null),g(this,"metrics",void 0),g(this,"animationLoop",void 0),g(this,"stats",void 0),g(this,"viewState",void 0),g(this,"cursorState",void 0),g(this,"_needsRedraw",void 0),g(this,"_pickRequest",void 0),g(this,"_lastPointerDownInfo",null),g(this,"_metricsCounter",void 0),g(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),g(this,"_onEvent",n=>{const r=xy[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,l=a&&(a[r.handler]||a.props[r.handler]),c=this.props[r.handler];let u=!1;l&&(u=l.call(a,o,n)),!u&&c&&c(o,n)}),g(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...XE,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&H.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),Mw()==="IE"&&H.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new lu({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&ms.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(i=this.deckRenderer)===null||i===void 0||i.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(a=this.tooltip)===null||a===void 0||a.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var l;(l=this.canvas.parentElement)===null||l===void 0||l.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&H.removed("onLayerHover","onHover")(),"onLayerClick"in e&&H.removed("onLayerClick","onClick")(),e.initialViewState&&!Ss(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ne(this.viewManager),this.viewManager.views}getViewports(e){return Ne(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_pick(e,n,r){Ne(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ne(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth||e.width,r=e.clientHeight||e.height;if(n!==this.width||r!==this.height){var i;this.width=n,this.height=r,(i=this.viewManager)===null||i===void 0||i.setProps({width:n,height:r}),this.props.onResize({width:n,height:r})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u}=e;return new _3({width:n,height:r,useDevicePixels:u,autoResizeViewport:!1,gl:i,onCreateContext:f=>Dw({...s,...f,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:f=>this._setGLContext(f.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Qg({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,Fg(e,{enable:!0,copyState:!0})),this.tooltip=new vk(this.canvas),Vn(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new SE;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new tN(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in xy)this.eventManager.on(i,this._onEvent);this.viewManager=new NO({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new kO(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new sk,this.deckRenderer=new uk(e),this.deckPicker=new mk(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;Vn(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),H.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Vr.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}g(mu,"defaultProps",XE);g(mu,"VERSION",bA.VERSION);class jf{constructor(e,n){g(this,"opts",void 0),g(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function rN(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function jl(t){return t.stride||t.size*t.bytesPerElement}function YE(t,e){e.offset&&H.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=jl(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function iN(t,e){const n=YE(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class sN{constructor(e,n,r){g(this,"gl",void 0),g(this,"id",void 0),g(this,"size",void 0),g(this,"settings",void 0),g(this,"value",void 0),g(this,"doublePrecision",void 0),g(this,"_buffer",void 0),g(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&qC(e,ce.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let l=rN(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new re(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*jl(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),ms.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=iN(this.getAccessor(),n||{});return r[e]=new jf(this,s.high),r["".concat(e,"64Low")]=i?new jf(this,s.low):new Float32Array(this.size),r}if(n){const r=YE(this.getAccessor(),n);return{[e]:new jf(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let c=0;c<i;c++){const u=n[l++];u<o[c]&&(o[c]=u),u>a[c]&&(a[c]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof re?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=jl(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=jl(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Uf(s,i));const l=s.byteLength+a+i.stride*2;o.byteLength<l&&o.reallocate(l),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Uf(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=ms.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?Uf(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&H.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e)return n[r]=i[0],n;switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const qy=[],Zy=[];function yu(t,e=0,n=1/0){let r=qy;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(Zy.length=t.length,r=Zy):r=qy,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function qE(t){return t&&t[Symbol.asyncIterator]}function ZE(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,c=i?i/a:0,u=Math.floor((t.length-c)/l);return(f,{index:h,target:d})=>{if(!s){const v=h*l+c;for(let y=0;y<n;y++)d[y]=t[v+y];return d}const p=s[h],m=s[h+1]||u;let T;if(o){T=new Array(m-p);for(let v=p;v<m;v++){const y=v*l+c;d=new Array(n);for(let w=0;w<n;w++)d[w]=t[y+w];T[v-p]=d}}else if(l===n)T=t.subarray(p*n+c,m*n+c);else{T=new t.constructor((m-p)*n);let v=0;for(let y=p;y<m;y++){const w=y*l+c;for(let x=0;x<n;x++)T[v++]=t[w+x]}}return T}}const oN=[],Gl=[[0,1/0]];function aN(t,e){if(t===Gl||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function Gf(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let c=a;for(;c<l;){const u=s(c,e);for(let f=0;f<i;f++)n[r+c]=u[f]||0,c++}}function lN({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Gf({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((u,f)=>r(u+a,f)),c=Math.min(i.length,s.length);for(let u=1;u<c;u++){const f=i[u]*n,h=s[u]*n;Gf({source:t.subarray(o,f),target:e,start:a,end:h,size:n,getData:l}),o=f,a=h}return a<e.length&&Gf({source:[],target:e,start:a,size:n,getData:l}),e}const cN={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function KE(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...cN[n],...e,...t,type:n}}function QE(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function JE(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function eT(t){t.push(t.shift())}function ep(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function tT({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,l=n.byteOffset,c=n.startIndices,u=i&&c,f=ep(n,e),h=n.isConstant;if(!u&&r>=f)return;const d=h?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!h){const v=s;s=(y,w)=>n.normalizeConstant(v(y,w))}const p=h?(v,y)=>s(d,y):(v,y)=>s(d.subarray(v,v+a),y),m=t.getData({length:r}),T=new Float32Array(f);lN({source:m,target:T,sourceStartIndices:i,targetStartIndices:c,size:a,getData:p}),t.byteLength<T.byteLength+l&&t.reallocate(T.byteLength+l),t.subData({data:T,offset:l})}class tp extends sN{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Gl}),g(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return KE(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=aN(this.state.updateRanges,[r,i])}else this.state.updateRanges=Gl}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=oN}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Gl),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(i,this,{data:n,startRow:c,endRow:u,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[c,u]of s){const f=Number.isFinite(c)?this.getVertexOffset(c):0,h=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:h})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Ne(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=Boolean(o.size)&&o.size!==this.size;return r.binaryAccessor=ZE(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?n[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:f}=e,{accessor:h,transform:d}=a,p=l.binaryAccessor||(typeof h=="function"?h:s[h]);Ne(typeof p=="function",'accessor "'.concat(h,'" is not a function'));let m=e.getVertexOffset(r);const{iterable:T,objectInfo:v}=yu(n,r,i);for(const y of T){v.index++;let w=p(y,v);if(d&&(w=d.call(this,w)),f){const x=(v.index<f.length-1?f[v.index+1]:o)-f[v.index];if(w&&Array.isArray(w[0])){let S=m;for(const P of w)e._normalizeValue(P,c,S),S+=u}else w&&w.length>u?c.set(w,m):(e._normalizeValue(w,v.target,0),LO({target:c,source:v.target,start:m,count:x}));m+=x*u}else e._normalizeValue(w,c,m),m+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class uN{constructor({gl:e,attribute:n,timeline:r}){g(this,"gl",void 0),g(this,"type","interpolation"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=e,this.transition=new va(r),this.attribute=n,this.attributeInTransition=new tp(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=hN(e,n);const i={byteLength:0,usage:35050};this.buffers=[new re(e,i),new re(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;eT(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)tT({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=ep(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:QE(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const fN=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function hN(t,e){const n=JE(e.size);return new Yg(t,{vs:fN,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class dN{constructor({gl:e,attribute:n,timeline:r}){g(this,"gl",void 0),g(this,"type","spring"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"texture",void 0),g(this,"framebuffer",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new va(r),this.attribute=n,this.attributeInTransition=new tp(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=pN(e),this.framebuffer=mN(e,this.texture),this.transform=gN(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new re(e,i),new re(e,i),new re(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)tT({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=ep(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:QE(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),eT(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),fu(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function gN(t,e,n){const r=JE(e.size);return new Yg(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function pN(t){return new ot(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function mN(t,e){return new Ce(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const yN={interpolation:uN,spring:dN};class vN{constructor(e,{id:n,timeline:r}){g(this,"id",void 0),g(this,"isSupported",void 0),g(this,"gl",void 0),g(this,"timeline",void 0),g(this,"transitions",void 0),g(this,"needsRedraw",void 0),g(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Yg.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){H.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=yN[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(H.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const Ky="attributeManager.invalidate",_N="attributeManager.updateStart",wN="attributeManager.updateEnd",EN="attribute.updateStart",TN="attribute.allocate",xN="attribute.updateEnd";class bN{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){g(this,"id",void 0),g(this,"gl",void 0),g(this,"attributes",void 0),g(this,"updateTriggers",void 0),g(this,"needsRedraw",void 0),g(this,"userData",void 0),g(this,"stats",void 0),g(this,"attributeTransitionManager",void 0),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new vN(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);qe(Ky,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);qe(Ky,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;qe(_N,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],f=u.settings.accessor;u.startIndices=r,u.numInstances=n,s[c]&&H.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue(typeof f=="string"?o[f]:void 0,e.startIndices)||typeof f=="string"&&!o[f]&&u.setConstantValue(s[f])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}l&&qe(wN,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new tp(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(qe(EN,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&qe(TN,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,qe(xN,n,r))}}class SN extends va{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Wr(n,r,o)}}const Qy=1e-5;function Jy(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function PN(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=Jy(t[o],e[o],n[o],r,i);return s}return Jy(t,e,n,r,i)}function ev(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class AN extends va{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=PN(s,o,n,r,i);const l=ev(a,n),c=ev(a,o);l<Qy&&c<Qy&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const CN={interpolation:SN,spring:AN};class LN{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;n=c,this.remove(e)}if(i=KE(i),!i)return;const o=CN[i.type];if(!o){H.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function MN(t){const e=np(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function IN(t,e){const n=nT({newProps:t,oldProps:e,propTypes:np(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=ON(t,e);let i=!1;return r||(i=kN(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:NN(t,e),transitionsChanged:RN(t,e)}}function RN(t,e){if(!t.transitions)return!1;const n={},r=np(t);let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&vd(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function nT({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=vd(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=vd(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function vd(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function ON(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function kN(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&tv(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&tv(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function NN(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function tv(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},nT({oldProps:i,newProps:r,triggerName:n})}function np(t){const e=t[Oc],n=e&&e.constructor;return n?n._propTypes:{}}const FN="count(): argument not an object",DN="count(): argument not a container";function zN(t){if(!BN(t))throw new Error(FN);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(UN(t))return Object.keys(t).length;throw new Error(DN)}function UN(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function BN(t){return t!==null&&typeof t=="object"}function VN(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const jN={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},_d={};function GN(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof ot)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let r=null;e.compressed&&(r={[10241]:e.data.length>1?9985:9729});const i=new ot(n,{...e,parameters:{...jN,...r,...t.props.textureParameters}});return _d[i.id]=!0,i}function WN(t){!t||!(t instanceof ot)||_d[t.id]&&(t.delete(),delete _d[t.id])}const HN={boolean:{validate(t,e){return!0},equal(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Zo(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Wf(t,e)}},accessor:{validate(t,e){const n=Nc(t);return n==="function"||n===Nc(e.value)},equal(t,e,n){return typeof e=="function"?!0:Wf(t,e)}},array:{validate(t,e){return e.optional&&!t||Zo(t)},equal(t,e,n){return n.compare?Wf(t,e):t===e}},object:{equal(t,e,n){return n.compare?Ss(t,e):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>GN(n,t),release:t=>{WN(t)}}};function Wf(t,e){if(t===e)return!0;if(!Zo(t)||!Zo(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function $N(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=XN(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function XN(t,e){switch(Nc(e)){case"object":return Ks(t,e);case"array":return Ks(t,{type:"array",value:e,compare:!1});case"boolean":return Ks(t,{type:"boolean",value:e});case"number":return Ks(t,{type:"number",value:e});case"function":return Ks(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Ks(t,e){return"type"in e?{name:t,...HN[e.type],...e}:"value"in e?{name:t,type:Nc(e.value),...e}:{name:t,type:"object",value:e}}function Zo(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Nc(t){return Zo(t)?"array":t===null?"null":typeof t}function YN(t,e){const n=rT(t.constructor),r=Object.create(n);r[Oc]=t,r[Jr]={},r[cr]={};for(let i=0;i<e.length;++i){const s=e[i];for(const o in s)r[o]=s[o]}return Object.freeze(r),r}function rT(t){const e=Fc(t,"_mergedDefaultProps");return e||(qN(t),t._mergedDefaultProps)}function qN(t){if(!t.prototype)return;const n=Object.getPrototypeOf(t),r=rT(n),i=Fc(t,"defaultProps")||{},s=$N(i),o=ZN(s.defaultProps,r,t),a={...n._propTypes,...s.propTypes};QN(o,a);const l={...n._deprecatedProps,...s.deprecatedProps};KN(o,l),t._mergedDefaultProps=o,t._propTypes=a,t._deprecatedProps=l}function ZN(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=e4(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}function KN(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])iT(this,s)||(this[s]=r);H.deprecated(i,e[n].join("/"))()}})}function QN(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=JN(o))}t[ts]=n,t[Jr]={},Object.defineProperties(t,r)}function JN(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||qE(e)?this[Jr][t]=e:this[cr][t]=e},get(){if(this[cr]){if(t in this[cr])return this[cr][t]||this[ts][t];if(t in this[Jr]){const e=this[Oc]&&this[Oc].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[ts][t]}}return this[ts][t]}}}function iT(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Fc(t,e){return iT(t,e)&&t[e]}function e4(t){const e=Fc(t,"layerName")||Fc(t,"componentName");return e||H.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}let t4=0;class rp{constructor(...e){g(this,"id",void 0),g(this,"props",void 0),g(this,"count",void 0),this.props=YN(this,e),this.id=this.props.id,this.count=t4++}clone(e){const{props:n}=this,r={};for(const i in n[ts])i in n[cr]?r[i]=n[cr][i]:i in n[Jr]&&(r[i]=n[Jr][i]);return new this.constructor({...n,...r,...e})}}g(rp,"componentName","Component");g(rp,"defaultProps",{});const n4=Object.freeze({});class r4{constructor(e){g(this,"component",void 0),g(this,"onAsyncPropUpdated",void 0),g(this,"asyncProps",void 0),g(this,"oldProps",void 0),g(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||n4}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return Boolean(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){const n=e[cr]||{},r=e[Jr]||e,i=e[ts]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(qE(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class i4 extends r4{constructor({attributeManager:e,layer:n}){super(n),g(this,"attributeManager",void 0),g(this,"needsRedraw",void 0),g(this,"needsUpdate",void 0),g(this,"subLayers",void 0),g(this,"usesPickingColorCache",void 0),g(this,"changeFlags",void 0),g(this,"viewport",void 0),g(this,"uniformTransitions",void 0),g(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,n){const r=this.component.props.fetch;return r?r(n,{propName:e,layer:this.layer}):super._fetch(e,n)}_onResolve(e,n){const r=this.component.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:this.layer})}_onError(e,n){this.layer.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const s4="layer.changeFlag",o4="layer.initialize",a4="layer.update",l4="layer.finalize",c4="layer.matched",nv=2**24-1,u4=Object.freeze([]),f4=ya(({oldViewport:t,viewport:e})=>t.equals(e));let un=new Uint8ClampedArray(0);const h4={data:{type:"data",value:u4,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let l=o.contains(t);return!l&&!i&&(o.add({resourceId:t,data:bc(t,r),persistent:!1}),l=!0),l?o.subscribe({resourceId:t,onChange:c=>{var u;return(u=n.internalState)===null||u===void 0?void 0:u.reloadAsyncProp(e,c)},consumerId:n.id,requestId:e}):bc(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:ma.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Z.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class nn extends rp{constructor(...e){super(...e),g(this,"internalState",null),g(this,"lifecycle",Ci.NO_STATE),g(this,"context",void 0),g(this,"state",void 0),g(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ne(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=DE(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=OE(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return Ne(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ne(this.internalState);const r=this.internalState.viewport||this.context.viewport;return CO(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Z.DEFAULT||e===Z.LNGLAT||e===Z.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ne(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:zN(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const n=this.getAttributeManager();if(!n)return null;const{positions:r,instancePositions:i}=n.attributes;return(e=r||i)===null||e===void 0?void 0:e.getBounds()}getShaders(e){for(const n of this.props.extensions)e=VN(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const l of r)n.invalidateAll(l);else n.invalidateAll();const{props:i,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable;if(o!==a&&n){const{pickingColors:l,instancePickingColors:c}=n.attributes,u=l||c;u&&(a&&u.constant&&(u.constant=!1,n.invalidate(u.id)),!u.value&&!a&&(u.constant=!0,u.value=[0,0,0]))}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!f4({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(un.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>nv&&H.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),un=ms.allocate(un,n,{size:3,copy:!0,maxCount:Math.max(n,nv)});const i=Math.floor(un.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),un[o*3+0]=s[0],un[o*3+1]=s[1],un[o*3+2]=s[2]}e.value=un.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==un.buffer&&(r.value=un.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ne(!this.internalState),Ne(Number.isFinite(this.props.coordinateSystem)),qe(o4,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new i4({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(H.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new LN(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){qe(c4,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.internalState.layer=this,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(qe(a4,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const c=this.getModels()[0]!==l[0];this._postUpdate(a,c)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){qe(l4,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,l=a&&a(n)||[0,0];Vn(s.gl,{polygonOffset:l}),Dt(s.gl,r,()=>{const c={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&qe(s4,this,i,e)}const r=Boolean(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=IN(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){MN(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new bN(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const c={};o||(c.pickingSelectedColor=null),Array.isArray(l)&&(c.pickingHighlightColor=l),Number.isInteger(a)&&(c.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(c)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;return n=n||i,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}g(nn,"defaultProps",h4);g(nn,"layerName","Layer");const d4="compositeLayer.renderLayers";class vu extends nn{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:d,positionFormat:p,modelMatrix:m,extensions:T,fetch:v,operation:y,_subLayerProps:w}=this.props,x={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:d,positionFormat:p,modelMatrix:m,extensions:T,fetch:v,operation:y},S=w&&e.id&&w[e.id],P=S&&S.updateTriggers,C=e.id||"sublayer";if(S){const M=this.constructor._propTypes,O=e.type?e.type._propTypes:{};for(const I in S){const B=O[I]||M[I];B&&B.type==="accessor"&&(S[I]=this.getSubLayerAccessor(S[I]))}}Object.assign(x,e,S),x.id="".concat(this.props.id,"-").concat(C),x.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...P};for(const M of T){const O=M.getSubLayerProps.call(this,M);O&&Object.assign(x,O,{updateTriggers:Object.assign(x.updateTriggers,O.updateTriggers)})}return x}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=gu(s,Boolean),this.internalState.subLayers=r}qe(d4,this,i,r);for(const s of r)s.parent=this}}g(vu,"layerName","CompositeLayer");const fl=Math.PI/180,rv=180/Math.PI,Wl=6370972,Wi=256;function g4(){const t=Wi/Wl,e=Math.PI/180*Wi;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class p4 extends Cr{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:s=.1,farZMultiplier:o=2,resolution:a=10}=e;let{height:l,altitude:c=1.5}=e;l=l||1,c=Math.max(.75,c);const u=new Je().lookAt({eye:[0,-c,0],up:[0,0,1]}),f=Math.pow(2,i);u.rotateX(n*fl),u.rotateZ(-r*fl),u.scale(f/l);const h=Math.atan(.5/c),d=Wi*2*f/l;super({...e,height:l,viewMatrix:u,longitude:r,latitude:n,zoom:i,distanceScales:g4(),fovyRadians:h*2,focalDistance:c,near:s,far:Math.min(2,1/d+1)*c*o}),g(this,"longitude",void 0),g(this,"latitude",void 0),g(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=a}get projectionMode(){return Xt.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),o=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],s[0],i[0],o[0]),Math.min(r[1],s[1],i[1],o[1]),Math.max(r[0],s[0],i[0],o[0]),Math.max(r[1],s[1],i[1],o[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,{pixelUnprojectionMatrix:l}=this;let c;if(Number.isFinite(o))c=Hf(l,[i,a,o,1]);else{const d=Hf(l,[i,a,-1,1]),p=Hf(l,[i,a,1,1]),m=((r||0)/Wl+1)*Wi,T=Of(pE([],d,p)),v=Of(d),y=Of(p),x=4*((4*v*y-(T-v-y)**2)/16)/T,S=Math.sqrt(v-x),P=Math.sqrt(Math.max(0,m*m-x)),C=(S-P)/Math.sqrt(T);c=CM([],d,p,C)}const[u,f,h]=this.unprojectPosition(c);return Number.isFinite(o)?[u,f,h]:Number.isFinite(r)?[u,f,r]:[u,f]}projectPosition(e){const[n,r,i=0]=e,s=n*fl,o=r*fl,a=Math.cos(o),l=(i/Wl+1)*Wi;return[Math.sin(s)*a*l,-Math.cos(s)*a*l,Math.sin(o)*l]}unprojectPosition(e){const[n,r,i]=e,s=mE(e),o=Math.asin(i/s),l=Math.atan2(n,-r)*rv,c=o*rv,u=(s/Wi-1)*Wl;return[l,c,u]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function Hf(t,e){const n=bs([],e,t);return Xg(n,n,1/n[3]),n}class sT{constructor(e){g(this,"opts",void 0),g(this,"typedArrayManager",void 0),g(this,"indexStarts",[0]),g(this,"vertexStarts",[0]),g(this,"vertexCount",0),g(this,"instanceCount",0),g(this,"attributes",void 0),g(this,"_attributeDefs",void 0),g(this,"data",void 0),g(this,"getGeometry",void 0),g(this,"geometryBuffer",void 0),g(this,"buffers",void 0),g(this,"positionSize",void 0),g(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=ms,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=l,s&&(Ne(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),l||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(a))for(const c of a)this._rebuildGeometry(c);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?ZE(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const l=s[a];l.copy=n,r[a]=o.allocate(r[a],e,l)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=yu(i,n,r);for(const l of o){a.index++;const c=s?s(l,a):null;e(c,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:l=1/0}=e||{},c={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((f,h)=>{const d=f&&this.normalizeGeometry(f);c[h]=d,r[h+1]=r[h]+(d?this.getGeometrySize(d):0)},a,l),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof re){const f=o.accessor.stride||this.positionSize*4;i=i||o.byteLength/f}else if(o.buffer){const f=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/f}else if(o.value){const f=o.value,h=o.stride/f.BYTES_PER_ELEMENT||this.positionSize;i=i||f.length/h}this._allocate(i,Boolean(e)),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const u={};this._forEachGeometry((f,h)=>{const d=c[h]||f;u.vertexStart=r[h],u.indexStart=n[h];const p=h<r.length-1?r[h+1]:i;u.geometrySize=p-r[h],u.geometryIndex=h,this.updateGeometryAttributes(d,u)},a,l),this.vertexCount=n[n.length-1]}}const m4=new Uint16Array([0,2,1,0,3,2]),y4=new Float32Array([0,1,0,0,1,0,1,1]);function v4(t,e){if(!e)return _4(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,s=Math.ceil(r/e)+1,o=(i-1)*(s-1)*6,a=new Uint32Array(o),l=new Float32Array(i*s*2),c=new Float64Array(i*s*3);let u=0,f=0;for(let h=0;h<i;h++){const d=h/(i-1);for(let p=0;p<s;p++){const m=p/(s-1),T=w4(t,d,m);c[u*3+0]=T[0],c[u*3+1]=T[1],c[u*3+2]=T[2]||0,l[u*2+0]=d,l[u*2+1]=1-m,h>0&&p>0&&(a[f++]=u-s,a[f++]=u-s-1,a[f++]=u-1,a[f++]=u-s,a[f++]=u-1,a[f++]=u),u++}}return{vertexCount:o,positions:c,indices:a,texCoords:l}}function _4(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:m4,texCoords:y4}}function w4(t,e,n){return Wr(Wr(t[0],t[1],n),Wr(t[3],t[2],n),e)}const E4=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,T4=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,x4=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  return mix(transparentColor, vec4(color, 1.0), alpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(T4,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),b4={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Z.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};class ip extends nn{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:E4,fs:x4,modules:[ci,ui]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var s;const{gl:o}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(o),i.invalidateAll()}if(e.bounds!==n.bounds){const o=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const l in a)o&&o[l]!==a[l]&&i.invalidate(l);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:s}=n;r.index=0;const o=S4(r.color),a=[Math.floor(o[0]*i),Math.floor(o[1]*s)];return r.bitmap={size:{width:i,height:s},uv:o,pixel:a},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return iv(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),v4(n,this.context.viewport.resolution)}_getModel(e){return e?new jn(e,{...this.getShaders(),id:this.props.id,geometry:new li({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:s,bounds:o,disablePicking:a}=this.state,{image:l,desaturate:c,transparentColor:u,tintColor:f}=this.props;r.pickingActive&&a||l&&i&&i.setUniforms(n).setUniforms({bitmapTexture:l,desaturate:c,transparentColor:u.map(h=>h/255),tintColor:f.slice(0,3).map(h=>h/255),coordinateConversion:s,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=Z;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:s}=this.props;if(!iv(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const o=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&o===n)return{coordinateConversion:-1,bounds:s};if(i===n&&o===e){const a=br([s[0],s[1]]),l=br([s[2],s[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],l[0],l[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}g(ip,"layerName","BitmapLayer");g(ip,"defaultProps",b4);function S4(t){const[e,n,r]=t,i=(r&240)/256,s=(r&15)/16;return[(e+s)/256,(n+i)/256]}function iv(t){return Number.isFinite(t[0])}const P4=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  // convert size in meters to pixels, then scaled and clamp
 
  // project meters to pixels and clamp to limits 
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );

  // scale icon height to match instanceSize
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;

  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,A4=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);

  // if colorMode == 0, use pixel color from the texture
  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  // Take the global opacity and the alpha from vColor into account for the alpha component
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,C4=1024,L4=4,sv=()=>{},ov={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071};function M4(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function I4(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}function Ko(t){return t&&(t.id||t.url)}function R4(t,e,n,r){const i=t.width,s=t.height,o=new ot(t.gl,{width:e,height:n,parameters:r});return HC(t,o,{targetY:0,width:i,height:s}),t.delete(),o}function av(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=Ko(i);t[o]={...i,x:s,y:n}}}function O4({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<t.length;l++){const c=t[l],u=Ko(c);if(!n[u]){const{height:f,width:h}=c;r+h+e>o&&(av(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:c,xOffset:r}),r=r+h+e,s=Math.max(s,f)}}return a.length>0&&av(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:M4(s+i+e)}}function k4(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=yu(t);for(const o of i){s.index++;const a=e(o,s),l=Ko(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[l]&&(!n[l]||a.url!==n[l].url)&&(r[l]={...a,source:o,sourceIndex:s.index})}return r}class N4{constructor(e,{onUpdate:n=sv,onError:r=sv}){g(this,"gl",void 0),g(this,"onUpdate",void 0),g(this,"onError",void 0),g(this,"_loadOptions",null),g(this,"_texture",null),g(this,"_externalTexture",null),g(this,"_mapping",{}),g(this,"_textureParameters",null),g(this,"_pendingCount",0),g(this,"_autoPacking",!1),g(this,"_xOffset",0),g(this,"_yOffset",0),g(this,"_rowHeight",0),g(this,"_buffer",L4),g(this,"_canvasWidth",C4),g(this,"_canvasHeight",0),g(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Ko(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var o;(o=this._texture)===null||o===void 0||o.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(k4(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:l}=O4({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=l,this._texture||(this._texture=new ot(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||ov})),this._texture.height!==this._canvasHeight&&(this._texture=R4(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||ov)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d");for(const r of e)this._pendingCount++,bc(r.url,Aw,this._loadOptions).then(i=>{const s=Ko(r),{x:o,y:a,width:l,height:c}=this._mapping[s],u=I4(n,i,l,c);this._texture.setSubImageData({data:u,x:o,y:a,width:l,height:c}),this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const oT=[0,0,0,255],F4={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:oT},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class _u extends nn{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:P4,fs:A4,modules:[ci,ui]})}initializeState(){this.state={iconManager:new N4(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:oT},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c,textureParameters:u}=n,{iconManager:f}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(f.setProps({loadOptions:n.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:u}),h?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&f.packIcons(l,c),i.extensionsChanged){var d;const{gl:p}=this.context;(d=this.state.model)===null||d===void 0||d.delete(),this.state.model=this._getModel(p),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();c&&this.state.model.setUniforms(e).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:xr[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new jn(e,{...this.getShaders(),id:this.props.id,geometry:new li({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):H.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}g(_u,"defaultProps",F4);g(_u,"layerName","IconLayer");const D4=`#define SHADER_NAME line-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions64Low;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute float instanceWidths;

uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float useShortestPath;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;

// offset vector by strokeWidth pixels
// offset_direction is -1 (left) or 1 (right)
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

vec3 splitLine(vec3 a, vec3 b, float x) {
  float t = (x - a.x) / (b.x - a.x);
  return vec3(x, mix(a.yz, b.yz, t));
}

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  vec3 source_world = instanceSourcePositions;
  vec3 target_world = instanceTargetPositions;
  vec3 source_world_64low = instanceSourcePositions64Low;
  vec3 target_world_64low = instanceTargetPositions64Low;

  if (useShortestPath > 0.5 || useShortestPath < -0.5) {
    source_world.x = mod(source_world.x + 180., 360.0) - 180.;
    target_world.x = mod(target_world.x + 180., 360.0) - 180.;
    float deltaLng = target_world.x - source_world.x;

    if (deltaLng * useShortestPath > 180.) {
      source_world.x += 360. * useShortestPath;
      source_world = splitLine(source_world, target_world, 180. * useShortestPath);
      source_world_64low = vec3(0.0);
    } else if (deltaLng * useShortestPath < -180.) {
      target_world.x += 360. * useShortestPath;
      target_world = splitLine(source_world, target_world, 180. * useShortestPath);
      target_world_64low = vec3(0.0);
    } else if (useShortestPath < 0.) {
      // Line is not split, abort
      gl_Position = vec4(0.);
      return;
    }
  }

  // Position
  vec4 source_commonspace;
  vec4 target_commonspace;
  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);
  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);
  
  // linear interpolation of source & target to pick right coord
  float segmentIndex = positions.x;
  vec4 p = mix(source, target, segmentIndex);
  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);
  uv = positions.xy;
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;

  // Multiply out width and clamp to limits
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );

  // extrude
  vec3 offset = vec3(
    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Color
  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,z4=`#define SHADER_NAME line-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,U4=[0,0,0,255],B4={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:U4},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class sp extends nn{getShaders(){return super.getShaders({vs:D4,fs:z4,modules:[ci,ui]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:s,wrapLongitude:o}=this.props;this.state.model.setUniforms(e).setUniforms({widthUnits:xr[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s,useShortestPath:o?1:0}).draw(),o&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(e){const n=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new jn(e,{...this.getShaders(),id:this.props.id,geometry:new li({drawMode:5,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}g(sp,"layerName","LineLayer");g(sp,"defaultProps",B4);const V4=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  
  // Multiply out line width and clamp to limits
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;

  // Expand geometry to accomodate edge smoothing
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;

  // position on the containing square in [-1, 1] space
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
  }

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply opacity to instance color, or return instance picking color
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,j4=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (filled) {
    gl_FragColor = vFillColor;
  } else {
    discard;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,lv=[0,0,0,255],G4={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:lv},getLineColor:{type:"accessor",value:lv},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class op extends nn{getShaders(){return super.getShaders({vs:V4,fs:j4,modules:[ci,ui]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:o?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:xr[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:xr[u],lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new jn(e,{...this.getShaders(),id:this.props.id,geometry:new li({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}g(op,"defaultProps",G4);g(op,"layerName","ScatterplotLayer");const aT={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function lT(t,e,n={}){return W4(t,n)!==e?($4(t,n),!0):!1}function W4(t,e={}){return Math.sign(H4(t,e))}function H4(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let o=n,a=r-i;o<r;o+=i)s+=(t[o]-t[a])*(t[o+1]+t[a+1]),a=o;return s/2}function $4(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=n+a*i,c=n+(s-1-a)*i;for(let u=0;u<i;++u){const f=t[l+u];t[l+u]=t[c+u],t[c+u]=f}}}function qt(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function wd(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Qo(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function Ed(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function Hl(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function cT(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},l=(a-o)/n;let c=[];const u=[c],f=Qo(t,0,n,o);let h,d;const p=fT(f,i,s,[]),m=[];qt(c,f);for(let T=1;T<l;T++){for(h=Qo(t,T,n,o,h),d=Hl(h,p);d;){Ed(f,h,d,p,m);const v=Hl(m,p);v&&(Ed(f,m,v,p,m),d=v),qt(c,m),wd(f,m),Y4(p,i,d),r&&c.length>n&&(c=[],u.push(c),qt(c,f)),d=Hl(h,p)}qt(c,h),wd(f,h)}return r?u:u[0]}const cv=0,X4=1;function hl(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function uT(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],l=[{pos:t,types:o?new Array(t.length/r).fill(X4):null,holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:f,types:h,holes:d}=l.shift();q4(f,r,d[0]||f.length,c),u=fT(c[0],i,s,u);const p=Hl(c[1],u);if(p){let m=uv(f,h,r,0,d[0]||f.length,u,p);const T={pos:m[0].pos,types:m[0].types,holes:[]},v={pos:m[1].pos,types:m[1].types,holes:[]};l.push(T,v);for(let y=0;y<d.length;y++)m=uv(f,h,r,d[y],d[y+1]||f.length,u,p),m[0]&&(T.holes.push(T.pos.length),T.pos=hl(T.pos,m[0].pos),o&&(T.types=hl(T.types,m[0].types))),m[1]&&(v.holes.push(v.pos.length),v.pos=hl(v.pos,m[1].pos),o&&(v.types=hl(v.types,m[1].types)))}else{const m={positions:f};o&&(m.edgeTypes=h),d.length&&(m.holeIndices=d),a.push(m)}}return a}function uv(t,e,n,r,i,s,o){const a=(i-r)/n,l=[],c=[],u=[],f=[],h=[];let d,p,m;const T=Qo(t,a-1,n,r);let v=Math.sign(o&8?T[1]-s[3]:T[0]-s[2]),y=e&&e[a-1],w=0,x=0;for(let S=0;S<a;S++)d=Qo(t,S,n,r,d),p=Math.sign(o&8?d[1]-s[3]:d[0]-s[2]),m=e&&e[r/n+S],p&&v&&v!==p&&(Ed(T,d,o,s,h),qt(l,h)&&u.push(y),qt(c,h)&&f.push(y)),p<=0?(qt(l,d)&&u.push(m),w-=p):u.length&&(u[u.length-1]=cv),p>=0?(qt(c,d)&&f.push(m),x+=p):f.length&&(f[f.length-1]=cv),wd(T,d),v=p,y=m;return[w?{pos:l,types:e&&u}:null,x?{pos:c,types:e&&f}:null]}function fT(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function Y4(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function q4(t,e,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<n;l+=e){const c=t[l],u=t[l+1];i=c<i?c:i,s=c>s?c:s,o=u<o?u:o,a=u>a?u:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}const Z4=85.051129;function K4(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);hT(o,n,0,i-r);const a=cT(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)dT(l,n);return a}function Q4(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let l=0,c=0;for(let f=0;f<=e.length;f++){const h=e[f]||t.length,d=c,p=J4(t,r,l,h);for(let m=p;m<h;m++)o[c++]=t[m];for(let m=l;m<p;m++)o[c++]=t[m];hT(o,r,d,c),eF(o,r,d,c,n==null?void 0:n.maxLatitude),l=h,a[f]=c}a.pop();const u=uT(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const f of u)dT(f.positions,r);return u}function J4(t,e,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=e){const a=Math.abs(t[o]);a>i&&(i=a,s=o-1)}return s}function eF(t,e,n,r,i=Z4){const s=t[n],o=t[r-e];if(Math.abs(s-o)>180){const a=Qo(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,qt(t,a),a[1]=Math.sign(a[1])*i,qt(t,a),a[0]=s,qt(t,a)}}function hT(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function dT(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function tF(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?cT(i,{size:e,gridResolution:n}):r?K4(i,{size:e}):i}const nF=1,rF=2,$f=4;class iF extends sT{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?tF(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(fv(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&fv(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=$f,r[s+o-2]=$f):(r[s]+=nF,r[s+o-2]+=rF),r[s+o-1]=$f}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,l=0;l<s;a++,l++)this.getPointOnPath(e,l,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function fv(t){return Array.isArray(t[0])}const sF=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}

// calculate line join positions
vec3 lineJoin(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  // side of the segment - -1: left, 0: center, 1: right
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);

  // tangent of the corner
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  // direction of the corner
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  // direction of the segment
  vec2 dir = isEnd ? dirA : dirB;
  // direction of the extrusion
  vec2 perp = isEnd ? perpA : perpB;
  // length of the segment
  float L = isEnd ? lenA : lenB;

  // A = angle of the corner
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));

  // -1: right, 1: left
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);

  // relative position to the corner:
  // -1: inside (smaller side of the angle)
  // 0: center
  // 1: outside (bigger side of the angle)
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  // trim if inside corner extends further than the line segment
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);

  // special treatment for start cap and end cap
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;

  // extend out a triangle to envelope the round cap
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }

  // Generate variables for fragment shader
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return currPoint + offset;
}

// In clipspace extrusion, if a line extends behind the camera, clip it to avoid visual artifacts
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    // Extrude in clipspace
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 pos = lineJoin(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);
  } else {
    // Extrude in commonspace
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec4 pos = vec4(
      lineJoin(prevPosition, currPosition, nextPosition, width.xy),
      1.0);
    geometry.position = pos;
    gl_Position = project_common_position_to_clipspace(pos);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,oF=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
/*
 * vPathPosition represents the relative coordinates of the current fragment on the path segment.
 * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.
 * vPathPosition.y - position along the length of the path, between [0, L / width].
 */
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    // if joint is rounded, test distance from the corner
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    // trim miter
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,gT=[0,0,0,255],aF={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:gT},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Xf={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class ap extends nn{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:sF,fs:oF,modules:[ci,ui]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Xf,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Xf,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Xf,defaultValue:gT},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new iF({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,l=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:l.getPath,buffers:l,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else this._disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:xr[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:c}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new jn(e,{...this.getShaders(),id:this.props.id,geometry:new li({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}g(ap,"defaultProps",aF);g(ap,"layerName","PathLayer");var Dc={},lF={get exports(){return Dc},set exports(t){Dc=t}};lF.exports=wu;Dc.default=wu;function wu(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=pT(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,c,u,f,h,d;if(r&&(s=dF(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(var p=n;p<i;p+=n)f=t[p],h=t[p+1],f<a&&(a=f),h<l&&(l=h),f>c&&(c=f),h>u&&(u=h);d=Math.max(c-a,u-l),d=d!==0?32767/d:0}return Jo(s,o,n,a,l,d,0),o}function pT(t,e,n,r,i){var s,o;if(i===bd(t,e,n,r)>0)for(s=e;s<n;s+=r)o=hv(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=hv(s,t[s],t[s+1],o);return o&&Eu(o,o.next)&&(ta(o),o=o.next),o}function ni(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(Eu(n,n.next)||me(n.prev,n,n.next)===0)){if(ta(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Jo(t,e,n,r,i,s,o){if(t){!o&&s&&vF(t,r,i,s);for(var a=t,l,c;t.prev!==t.next;){if(l=t.prev,c=t.next,s?uF(t,r,i,s):cF(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),ta(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=fF(ni(t),e,n),Jo(t,e,n,r,i,s,2)):o===2&&hF(t,e,n,r,i,s):Jo(ni(t),e,n,r,i,s,1);break}}}}function cF(t){var e=t.prev,n=t,r=t.next;if(me(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,f=a<l?a<c?a:c:l<c?l:c,h=i>s?i>o?i:o:s>o?s:o,d=a>l?a>c?a:c:l>c?l:c,p=r.next;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=f&&p.y<=d&&Hi(i,a,s,l,o,c,p.x,p.y)&&me(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function uF(t,e,n,r){var i=t.prev,s=t,o=t.next;if(me(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,u=i.y,f=s.y,h=o.y,d=a<l?a<c?a:c:l<c?l:c,p=u<f?u<h?u:h:f<h?f:h,m=a>l?a>c?a:c:l>c?l:c,T=u>f?u>h?u:h:f>h?f:h,v=Td(d,p,e,n,r),y=Td(m,T,e,n,r),w=t.prevZ,x=t.nextZ;w&&w.z>=v&&x&&x.z<=y;){if(w.x>=d&&w.x<=m&&w.y>=p&&w.y<=T&&w!==i&&w!==o&&Hi(a,u,l,f,c,h,w.x,w.y)&&me(w.prev,w,w.next)>=0||(w=w.prevZ,x.x>=d&&x.x<=m&&x.y>=p&&x.y<=T&&x!==i&&x!==o&&Hi(a,u,l,f,c,h,x.x,x.y)&&me(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;w&&w.z>=v;){if(w.x>=d&&w.x<=m&&w.y>=p&&w.y<=T&&w!==i&&w!==o&&Hi(a,u,l,f,c,h,w.x,w.y)&&me(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;x&&x.z<=y;){if(x.x>=d&&x.x<=m&&x.y>=p&&x.y<=T&&x!==i&&x!==o&&Hi(a,u,l,f,c,h,x.x,x.y)&&me(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function fF(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!Eu(i,s)&&mT(i,r,r.next,s)&&ea(i,s)&&ea(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),ta(r),ta(r.next),r=t=s),r=r.next}while(r!==t);return ni(r)}function hF(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&EF(o,a)){var l=yT(o,a);o=ni(o,o.next),l=ni(l,l.next),Jo(o,e,n,r,i,s,0),Jo(l,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function dF(t,e,n,r){var i=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,c=pT(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(wF(c));for(i.sort(gF),s=0;s<i.length;s++)n=pF(i[s],n);return n}function gF(t,e){return t.x-e.x}function pF(t,e){var n=mF(t,e);if(!n)return e;var r=yT(n,t);return ni(r,r.next),ni(n,n.next)}function mF(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var l=o,c=o.x,u=o.y,f=1/0,h;n=o;do r>=n.x&&n.x>=c&&r!==n.x&&Hi(i<u?r:s,i,c,u,i<u?s:r,i,n.x,n.y)&&(h=Math.abs(i-n.y)/(r-n.x),ea(n,t)&&(h<f||h===f&&(n.x>o.x||n.x===o.x&&yF(o,n)))&&(o=n,f=h)),n=n.next;while(n!==l);return o}function yF(t,e){return me(t.prev,t,e.prev)<0&&me(e.next,t,t.next)<0}function vF(t,e,n,r){var i=t;do i.z===0&&(i.z=Td(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,_F(i)}function _F(t){var e,n,r,i,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1);return t}function Td(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function wF(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Hi(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function EF(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!TF(t,e)&&(ea(t,e)&&ea(e,t)&&xF(t,e)&&(me(t.prev,t,e.prev)||me(t,e.prev,e))||Eu(t,e)&&me(t.prev,t,t.next)>0&&me(e.prev,e,e.next)>0)}function me(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Eu(t,e){return t.x===e.x&&t.y===e.y}function mT(t,e,n,r){var i=gl(me(t,e,n)),s=gl(me(t,e,r)),o=gl(me(n,r,t)),a=gl(me(n,r,e));return!!(i!==s&&o!==a||i===0&&dl(t,n,e)||s===0&&dl(t,r,e)||o===0&&dl(n,t,r)||a===0&&dl(n,e,r))}function dl(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function gl(t){return t>0?1:t<0?-1:0}function TF(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&mT(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function ea(t,e){return me(t.prev,t,t.next)<0?me(t,e,t.next)>=0&&me(t,t.prev,e)>=0:me(t,e,t.prev)<0||me(t,t.next,e)<0}function xF(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function yT(t,e){var n=new xd(t.i,t.x,t.y),r=new xd(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function hv(t,e,n,r){var i=new xd(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ta(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function xd(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}wu.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(bd(t,0,s,n));if(i)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;o-=Math.abs(bd(t,c,u,n))}var f=0;for(a=0;a<r.length;a+=3){var h=r[a]*n,d=r[a+1]*n,p=r[a+2]*n;f+=Math.abs((t[h]-t[p])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[p+1]-t[h+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function bd(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}wu.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};const pl=aT.CLOCKWISE,dv=aT.COUNTER_CLOCKWISE,ur={isClosed:!0};function bF(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function lo(t){return"positions"in t?t.positions:t}function $l(t){return"holeIndices"in t?t.holeIndices:null}function SF(t){return Array.isArray(t[0])}function PF(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function AF(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function CF(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function gv(t,e,n,r,i){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let l=0;l<r;l++)t[s++]=n[a][l]||0;if(!AF(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return ur.start=e,ur.end=s,ur.size=r,lT(t,i,ur),s}function pv(t,e,n,r,i=0,s,o){s=s||n.length;const a=s-i;if(a<=0)return e;let l=e;for(let c=0;c<a;c++)t[l++]=n[i+c];if(!CF(n,r,i,s))for(let c=0;c<r;c++)t[l++]=n[i+c];return ur.start=e,ur.end=l,ur.size=r,lT(t,o,ur),l}function LF(t,e){bF(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=pv(n,o,i,e,s[a-1],s[a],a===0?pl:dv),r.push(o);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!SF(t))return pv(n,0,t,e,0,n.length,pl),n;if(!PF(t)){let i=0;for(const[s,o]of t.entries())i=gv(n,i,o,e,s===0?pl:dv),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return gv(n,0,t,e,pl),n}function MF(t,e,n){let r=$l(t);r&&(r=r.map(s=>s/e));let i=lo(t);if(n){const s=i.length;i=i.slice();const o=[];for(let a=0;a<s;a+=e){o[0]=i[a],o[1]=i[a+1];const l=n(o);i[a]=l[0],i[a+1]=l[1]}}return Dc(i,r,e)}class IF extends sT{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=LF(e,this.positionSize);return this.opts.resolution?uT(lo(n),$l(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Q4(lo(n),$l(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(mv(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return lo(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&mv(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let c=i;const u=MF(e,this.positionSize,this.opts.preproject);l=a.allocate(l,i+u.length,{copy:!0});for(let f=0;f<u.length;f++)l[c++]=u[f]+r;o[n+1]=i+u.length,s.indices=l}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=lo(e);for(let a=n,l=0;l<r;a++,l++){const c=o[l*s],u=o[l*s+1],f=s>2?o[l*s+2]:0;i[a*3]=c,i[a*3+1]=u,i[a*3+2]=f}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&$l(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function mv(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const vT=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,RF=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(vT,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),OF=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(vT,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),kF=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,zc=[0,0,0,255],NF={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:zc},getLineColor:{type:"accessor",value:zc},material:!0},ml={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class lp extends nn{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?RF:OF,fs:kF,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[ci,WI,ui]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;n.isGeospatial&&r===Z.DEFAULT&&(r=Z.LNGLAT),this.setState({numInstances:0,polygonTesselator:new IF({preproject:r===Z.LNGLAT&&n.projectFlat.bind(n),fp64:this.use64bitPositions(),IndexType:!e||Ug(e,ce.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const i=this.getAttributeManager(),s=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:ml,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:ml,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ml,accessor:"getFillColor",defaultValue:zc,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ml,accessor:"getLineColor",defaultValue:zc,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(o,{index:a,target:l})=>this.encodePickingColor(o&&o.__source?o.__source.index:a,l),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else this._disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,polygonTesselator:l}=this.state,c={...e,extruded:Boolean(n),elevationScale:s};a&&(a.setInstanceCount(l.instanceCount-1),a.setUniforms(c),i&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),r&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(l.vertexCount),o.setUniforms(c).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(l=>l.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,o;if(r){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new jn(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new jn(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new li({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,s].filter(Boolean),topModel:s,sideModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}g(lp,"defaultProps",NF);g(lp,"layerName","SolidPolygonLayer");function FF({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,o=t.length;let a=o,l=o;for(let h=0;h<o;h++){const d=e(t[h]);if(a>h&&d>=i&&(a=h),d>=s){l=h;break}}let c=a;const f=l-a!==r.length?t.slice(l):void 0;for(let h=0;h<r.length;h++)t[c++]=r[h];if(f){for(let h=0;h<f.length;h++)t[c++]=f[h];t.length=c}return{startRow:a,endRow:a+r.length}}function DF(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?zF(t,r,n):null}function zF(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function UF(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let o=0;o<i.length;o++)e(i[o],s),n[r][o*3+0]=s[0],n[r][o*3+1]=s[1],n[r][o*3+2]=s[2]}return n}const BF=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float buffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;

    // if enable sdf (signed distance fields)
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }

    // Take the global opacity and the alpha from color into account for the alpha component
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,yv=192/256,vv=[],VF={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class cp extends _u{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:BF}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&H.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state;e.uniforms={...e.uniforms,buffer:yv,outlineBuffer:i?Math.max(r,yv*(1-i)):-1,gamma:r,sdf:Boolean(n),outlineColor:s},super.draw(e)}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):vv}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):vv}}g(cp,"defaultProps",VF);g(cp,"layerName","MultiIconLayer");var Uc={},jF={get exports(){return Uc},set exports(t){Uc=t}};jF.exports=_a;Uc.default=_a;var ns=1e20;function _a(t,e,n,r,i,s){this.fontSize=t||24,this.buffer=e===void 0?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=s||"normal",this.radius=n||8;var o=this.size=this.fontSize+this.buffer*2,a=o+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function GF(t,e,n,r,i,s,o){s.fill(ns,0,e*n),o.fill(0,0,e*n);for(var a=(e-r)/2,l=0;l<i;l++)for(var c=0;c<r;c++){var u=(l+a)*e+c+a,f=t.data[4*(l*r+c)+3]/255;if(f===1)s[u]=0,o[u]=ns;else if(f===0)s[u]=ns,o[u]=0;else{var h=Math.max(0,.5-f),d=Math.max(0,f-.5);s[u]=h*h,o[u]=d*d}}}function WF(t,e,n,r,i,s,o){for(var a=0;a<e*n;a++){var l=Math.sqrt(r[a])-Math.sqrt(i[a]);t[a]=Math.round(255-255*(l/s+o))}}_a.prototype._draw=function(t,e){var n=this.ctx.measureText(t),r=n.width,i=2*this.buffer,s,o,a,l,c,u,f,h;e&&this.useMetrics?(c=Math.floor(n.actualBoundingBoxAscent),h=this.buffer+Math.ceil(n.actualBoundingBoxAscent),u=this.buffer,f=this.buffer,o=Math.min(this.size,Math.ceil(n.actualBoundingBoxRight-n.actualBoundingBoxLeft)),l=Math.min(this.size-u,Math.ceil(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)),s=o+i,a=l+i,this.ctx.textBaseline="alphabetic"):(s=o=this.size,a=l=this.size,c=19*this.fontSize/24,u=f=0,h=this.middle,this.ctx.textBaseline="middle");var d;o&&l&&(this.ctx.clearRect(f,u,o,l),this.ctx.fillText(t,this.buffer,h),d=this.ctx.getImageData(f,u,o,l));var p=new Uint8ClampedArray(s*a);return GF(d,s,a,o,l,this.gridOuter,this.gridInner),_v(this.gridOuter,s,a,this.f,this.v,this.z),_v(this.gridInner,s,a,this.f,this.v,this.z),WF(p,s,a,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:p,metrics:{width:o,height:l,sdfWidth:s,sdfHeight:a,top:c,left:0,advance:r}}};_a.prototype.draw=function(t){return this._draw(t,!1).data};_a.prototype.drawWithMetrics=function(t){return this._draw(t,!0)};function _v(t,e,n,r,i,s){for(var o=0;o<e;o++)wv(t,o,e,n,r,i,s);for(var a=0;a<n;a++)wv(t,a*e,1,e,r,i,s)}function wv(t,e,n,r,i,s,o){var a,l,c,u;for(s[0]=0,o[0]=-ns,o[1]=ns,a=0;a<r;a++)i[a]=t[e+a*n];for(a=1,l=0,c=0;a<r;a++){do u=s[l],c=(i[a]-i[u]+a*a-u*u)/(a-u)/2;while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=ns}for(a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;u=s[l],t[e+a*n]=i[u]+(a-u)*(a-u)}}const HF=32,$F=[];function XF(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function YF({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o;for(const f of t)if(!s[f]){const h=e(f);c+h+r*2>i&&(c=0,l++),s[f]={x:c+r,y:a+l*(n+r*2)+r,width:h,height:n},c+=h+r*2}const u=n+r*2;return{mapping:s,xOffset:c,yOffset:a+l*u,canvasHeight:XF(a+(l+1)*u)}}function _T(t,e,n,r){let i=0;for(let o=e;o<n;o++){var s;const a=t[o];i+=((s=r[a])===null||s===void 0?void 0:s.width)||0}return i}function wT(t,e,n,r,i,s){let o=e,a=0;for(let l=e;l<n;l++){const c=_T(t,l,l+1,i);a+c>r&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function qF(t,e,n,r,i,s){let o=e,a=e,l=e,c=0;for(let u=e;u<n;u++)if((t[u]===" "||t[u+1]===" "||u+1===n)&&(l=u+1),l>a){let f=_T(t,a,l,i);c+f>r&&(o<a&&(s.push(a),o=a,c=0),f>r&&(f=wT(t,a,l,r,i,s),o=s[s.length-1])),a=l,c+=f}return c}function ZF(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?wT(t,i,s,n,r,o):qF(t,i,s,n,r,o),o}function KF(t,e,n,r,i,s){let o=0,a=0;for(let l=e;l<n;l++){const c=t[l],u=r[c];u?(a||(a=u.height),i[l]=o+u.width/2,o+=u.width):(H.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),i[l]=o,o+=HF)}s[0]=o,s[1]=a}function Ev(t,e,n,r,i){const s=Array.from(t),o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,f=[0,0],h=[0,0];let d=0,p=0,m=0;for(let T=0;T<=o;T++){const v=s[T];if((v===`
`||T===o)&&(m=T),m>p){const y=u?ZF(s,n,r,i,p,m):$F;for(let w=0;w<=y.length;w++){const x=w===0?p:y[w-1],S=w<y.length?y[w]:m;KF(s,x,S,i,a,h);for(let P=x;P<S;P++)l[P]=d+h[1]/2,c[P]=h[0];d=d+h[1]*e,f[0]=Math.max(f[0],h[0])}p=m}v===`
`&&(a[p]=0,l[p]=0,c[p]=0,p++)}return f[1]=d,{x:a,y:l,rowWidth:c,size:f}}function QF({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,l=r?r/o:0,c=i[e]||Math.ceil((t.length-l)/a),u=s&&new Set,f=new Array(e);let h=t;if(a>1||l>0){const d=t.constructor;h=new d(c);for(let p=0;p<c;p++)h[p]=t[p*a+l]}for(let d=0;d<e;d++){const p=i[d],m=i[d+1]||c,T=h.subarray(p,m);f[d]=String.fromCodePoint.apply(null,T),u&&T.forEach(u.add,u)}if(u)for(const d of u)s.add(String.fromCodePoint(d));return{texts:f,characterCount:c}}class ET{constructor(e=5){g(this,"limit",void 0),g(this,"_cache",{}),g(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function JF(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const So={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:JF(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},Tv=1024,eD=.9,xv=1.2,TT=3;let Bc=new ET(TT);function tD(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=Bc.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function nD(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function bv(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function rD(t){H.assert(Number.isFinite(t)&&t>=TT,"Invalid cache limit"),Bc=new ET(t)}class iD{constructor(){g(this,"props",{...So}),g(this,"_key",void 0),g(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return xv}setProps(e={}){Object.assign(this.props,e);const n=this._key;this._key=this._getKey();const r=tD(this._key,this.props.characterSet),i=Bc.get(this._key);if(i&&r.size===0){this._key!==n&&(this._atlas=i);return}const s=this._generateFontAtlas(this._key,r,i);this._atlas=s,Bc.set(this._key,s)}_generateFontAtlas(e,n,r){const{fontFamily:i,fontWeight:s,fontSize:o,buffer:a,sdf:l,radius:c,cutoff:u}=this.props;let f=r&&r.data;f||(f=document.createElement("canvas"),f.width=Tv);const h=f.getContext("2d");bv(h,i,o,s);const{mapping:d,canvasHeight:p,xOffset:m,yOffset:T}=YF({getFontWidth:v=>h.measureText(v).width,fontHeight:o*xv,buffer:a,characterSet:n,maxCanvasWidth:Tv,...r&&{mapping:r.mapping,xOffset:r.xOffset,yOffset:r.yOffset}});if(f.height!==p){const v=h.getImageData(0,0,f.width,f.height);f.height=p,h.putImageData(v,0,0)}if(bv(h,i,o,s),l){const v=new Uc(o,a,c,u,i,s),y=h.getImageData(0,0,v.size,v.size);for(const w of n)nD(v.draw(w),y),h.putImageData(y,d[w].x-a,d[w].y+a)}else for(const v of n)h.fillText(v,d[v].x,d[v].y+o*eD);return{xOffset:m,yOffset:T,mapping:d,data:f,width:f.width,height:f.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(o," ").concat(a):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const sD=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;

  // convert size in meters to pixels, then scaled and clamp

  // project meters to pixels and clamp to limits
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply opacity to instance color, or return instance picking color
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,oD=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,aD={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class up extends nn{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:sD,fs:oD,modules:[ci,ui]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:Boolean(a),padding:l,sizeUnits:xr[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new jn(e,{...this.getShaders(),id:this.props.id,geometry:new li({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}g(up,"defaultProps",aD);g(up,"layerName","TextBackgroundLayer");const Sv={start:1,middle:0,end:-1},Pv={top:1,center:0,bottom:-1},Yf=[0,0,0,255],lD=1,cD={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Yf},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:So.characterSet},fontFamily:So.fontFamily,fontWeight:So.fontWeight,lineHeight:lD,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Yf},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Yf},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class fp extends vu{constructor(...e){super(...e),g(this,"state",void 0),g(this,"getBoundingRect",(n,r)=>{const i=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,f=s(n,r)||"",{size:[h,d]}=Ev(f,l,o,a,i),p=Sv[typeof c=="function"?c(n,r):c],m=Pv[typeof u=="function"?u(n,r):u];return[(p-1)*h/2,(m-1)*d/2,h,d]}),g(this,"getIconOffsets",(n,r)=>{const i=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,f=s(n,r)||"",{x:h,y:d,rowWidth:p,size:[m,T]}=Ev(f,l,o,a,i),v=Sv[typeof c=="function"?c(n,r):c],y=Pv[typeof u=="function"?u(n,r):u],w=h.length,x=new Array(w*2);let S=0;for(let P=0;P<w;P++){const C=(1-v)*(m-p[P])/2;x[S++]=(v-1)*m/2+C+h[P],x[S++]=(y-1)*T/2+d[P]}return x})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new iD}}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,o=n.startIndices,a;const l=r==="auto"&&new Set;if(i&&o){const{texts:c,characterCount:u}=QF({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:o,characterSet:l});a=u,s=(f,{index:h})=>c[h]}else{const{iterable:c,objectInfo:u}=yu(n);o=[0],a=0;for(const f of c){u.index++;const h=Array.from(s(f,u)||"");l&&h.forEach(l.add,l),a+=h.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||r})}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:o},styleVersion:a}=this.state,{data:l,_dataDiff:c,getPosition:u,getColor:f,getSize:h,getAngle:d,getPixelOffset:p,getBackgroundColor:m,getBorderColor:T,getBorderWidth:v,backgroundPadding:y,background:w,billboard:x,fontSettings:S,outlineWidth:P,outlineColor:C,sizeScale:M,sizeUnits:O,sizeMinPixels:I,sizeMaxPixels:B,transitions:G,updateTriggers:V}=this.props,q=this.getSubLayerClass("characters",cp),Bt=this.getSubLayerClass("background",up);return[w&&new Bt({getFillColor:m,getLineColor:T,getLineWidth:v,padding:y,getPosition:u,getSize:h,getAngle:d,getPixelOffset:p,billboard:x,sizeScale:M/this.state.fontAtlasManager.props.fontSize,sizeUnits:O,sizeMinPixels:I,sizeMaxPixels:B,transitions:G&&{getPosition:G.getPosition,getAngle:G.getAngle,getSize:G.getSize,getFillColor:G.getBackgroundColor,getLineColor:G.getBorderColor,getLineWidth:G.getBorderWidth,getPixelOffset:G.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:V.getPosition,getAngle:V.getAngle,getSize:V.getSize,getFillColor:V.getBackgroundColor,getLineColor:V.getBorderColor,getLineWidth:V.getBorderWidth,getPixelOffset:V.getPixelOffset,getBoundingRect:{getText:V.getText,getTextAnchor:V.getTextAnchor,getAlignmentBaseline:V.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:c,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new q({sdf:S.sdf,smoothing:Number.isFinite(S.smoothing)?S.smoothing:So.smoothing,outlineWidth:P,outlineColor:C,iconAtlas:s,iconMapping:o,getPosition:u,getColor:f,getSize:h,getAngle:d,getPixelOffset:p,billboard:x,sizeScale:M*i,sizeUnits:O,sizeMinPixels:I*i,sizeMaxPixels:B*i,transitions:G&&{getPosition:G.getPosition,getAngle:G.getAngle,getColor:G.getColor,getSize:G.getSize,getPixelOffset:G.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:V.getText,getPosition:V.getPosition,getAngle:V.getAngle,getColor:V.getColor,getSize:V.getSize,getPixelOffset:V.getPixelOffset,getIconOffsets:{getText:V.getText,getTextAnchor:V.getTextAnchor,getAlignmentBaseline:V.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:c,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){rD(e)}}g(fp,"defaultProps",cD);g(fp,"layerName","TextLayer");const Xl={circle:{type:op,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:_u,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:fp,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Yl={type:ap,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Sd={type:lp,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Qs({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function qf(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function uD(t){if(Array.isArray(t))return t;switch(H.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return H.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function Av(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let o=i;o<s;o++){const a=t[o],{geometry:l}=a;if(l)if(l.type==="GeometryCollection"){H.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");const{geometries:c}=l;for(let u=0;u<c.length;u++){const f=c[u];Cv(f,r,e,a,o)}}else Cv(l,r,e,a,o)}return r}function Cv(t,e,n,r,i){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=e;if(!hD(s,o)){H.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":o.forEach(f=>{a.push(n({geometry:{type:"Point",coordinates:f}},r,i))});break;case"LineString":l.push(n({geometry:t},r,i));break;case"MultiLineString":o.forEach(f=>{l.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"Polygon":c.push(n({geometry:t},r,i)),o.forEach(f=>{u.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"MultiPolygon":o.forEach(f=>{c.push(n({geometry:{type:"Polygon",coordinates:f}},r,i)),f.forEach(h=>{u.push(n({geometry:{type:"LineString",coordinates:h}},r,i))})});break}}const fD={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function hD(t,e){let n=fD[t];for(H.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function xT(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function yl(t){return t.geometry.coordinates}function dD(t,e){const n=xT(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=yl,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=yl,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=yl,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=yl,n}function gD(t,e){const n=xT(),{points:r,lines:i,polygons:s}=t,o=UF(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const pD=["points","linestrings","polygons"],mD={...Qs(Xl.circle),...Qs(Xl.icon),...Qs(Xl.text),...Qs(Yl),...Qs(Sd),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class hp extends vu{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=gD(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=uD(e.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const l=this.state.features;for(const c in l)s[c]=l[c].slice(),o[c]=[];for(const c of n.dataChanged){const u=Av(r,i,c);for(const f in l)o[f].push(FF({data:s[f],getIndex:h=>h.__source.index,dataRange:c,replace:u[f]}))}}else s=Av(r,i);const a=dD(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=pD.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,Sd.type);if(s){const o=qf(this,Sd.props),a=e&&n;return a||delete o.getLineColor,o.updateTriggers.lineColors=a,new s(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,Yl.type),a=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,Yl.type);if(o||a){const l=qf(this,Yl.props);return[o&&new o(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers}),r.polygonsOutline),a&&new a(l,this.getSubLayerProps({id:s,updateTriggers:l.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(a=>a.__source.index===i));const s=new Set(e.split("+")),o=[];for(const a of s){const l="points-".concat(a),c=Xl[a],u=c&&this.shouldRenderSubLayer(l,n.points.data)&&this.getSubLayerClass(l,c.type);if(u){const f=qf(this,c.props);let h=n.points;if(a==="text"&&r){const{instancePickingColors:d,...p}=h.data.attributes;h={...h,data:{...h.data,attributes:p}}}o.push(new u(f,this.getSubLayerProps({id:l,updateTriggers:f.updateTriggers,highlightedObjectIndex:i}),h))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:o}=i,a=DF(s,o);return e(a,i)}}}g(hp,"layerName","GeoJsonLayer");g(hp,"defaultProps",mD);class yD{constructor(e){g(this,"index",void 0),g(this,"isVisible",void 0),g(this,"isSelected",void 0),g(this,"parent",void 0),g(this,"children",void 0),g(this,"content",void 0),g(this,"state",void 0),g(this,"layers",void 0),g(this,"id",void 0),g(this,"bbox",void 0),g(this,"zoom",void 0),g(this,"userData",void 0),g(this,"_abortController",void 0),g(this,"_loader",void 0),g(this,"_loaderId",void 0),g(this,"_isLoaded",void 0),g(this,"_isCancelled",void 0),g(this,"_needsReload",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||H.error("byteLength not defined in tile data")(),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:s,id:o,bbox:a,userData:l,zoom:c}=this,u=this._loaderId;this._abortController=new AbortController;const{signal:f}=this._abortController,h=await n.scheduleRequest(this,m=>m.isSelected?1:-1);if(!h){this._isCancelled=!0;return}if(this._isCancelled){h.done();return}let d=null,p;try{d=await e({index:s,id:o,bbox:a,userData:l,zoom:c,signal:f})}catch(m){p=m||!0}finally{h.done()}if(u===this._loaderId){if(this._loader=void 0,this.content=d,this._isCancelled&&!d){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,p?i(p,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const Ze={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},Lv=new F,vD=new F;class dp{constructor(e=[0,0,0],n=[0,0,0],r){g(this,"center",void 0),g(this,"halfDiagonal",void 0),g(this,"minimum",void 0),g(this,"maximum",void 0),r=r||Lv.copy(e).add(n).scale(.5),this.center=new F(r),this.halfDiagonal=new F(n).subtract(this.center),this.minimum=new F(e),this.maximum=new F(n)}clone(){return new dp(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=vD.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),s=this.center.dot(r)+e.distance;return s-i>0?Ze.INSIDE:s+i<0?Ze.OUTSIDE:Ze.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=Lv.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,s;return s=Math.abs(n.x)-r.x,s>0&&(i+=s*s),s=Math.abs(n.y)-r.y,s>0&&(i+=s*s),s=Math.abs(n.z)-r.z,s>0&&(i+=s*s),i}}const Js=new F,Mv=new F;class gp{constructor(e=[0,0,0],n=0){g(this,"center",void 0),g(this,"radius",void 0),this.radius=-0,this.center=new F,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Js.from(n),this.center=new F().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new gp(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,o=Js.copy(i).subtract(n),a=o.magnitude();if(r>=a+s)return this.clone();if(s>=a+r)return e.clone();const l=(r+a+s)*.5;return Mv.copy(o).scale((-r+l)/a).add(n),this.center.copy(Mv),this.radius=l,this}expand(e){const r=Js.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=YM(Js,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Js.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?Ze.OUTSIDE:s<r?Ze.INTERSECTING:Ze.INSIDE}}const _D=new F,wD=new F,vl=new F,_l=new F,wl=new F,ED=new F,TD=new F,An={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class pp{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){g(this,"center",void 0),g(this,"halfAxes",void 0),this.center=new F().from(e),this.halfAxes=new je(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new F(e).len(),new F(n).len(),new F(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new F(e).normalize(),s=new F(n).normalize(),o=new F(r).normalize();return new vy().fromMatrix3(new je([...i,...s,...o]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new vy(r),s=new je().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new F().from(e),this.halfAxes=s,this}clone(){return new pp(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new gp){const n=this.halfAxes,r=n.getColumn(0,vl),i=n.getColumn(1,_l),s=n.getColumn(2,wl),o=_D.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,o=r.y,a=r.z,l=Math.abs(s*i[An.COLUMN0ROW0]+o*i[An.COLUMN0ROW1]+a*i[An.COLUMN0ROW2])+Math.abs(s*i[An.COLUMN1ROW0]+o*i[An.COLUMN1ROW1]+a*i[An.COLUMN1ROW2])+Math.abs(s*i[An.COLUMN2ROW0]+o*i[An.COLUMN2ROW1]+a*i[An.COLUMN2ROW2]),c=r.dot(n)+e.distance;return c<=-l?Ze.OUTSIDE:c>=l?Ze.INSIDE:Ze.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=wD.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,vl),s=r.getColumn(1,_l),o=r.getColumn(2,wl),a=i.magnitude(),l=s.magnitude(),c=o.magnitude();i.normalize(),s.normalize(),o.normalize();let u=0,f;return f=Math.abs(n.dot(i))-a,f>0&&(u+=f*f),f=Math.abs(n.dot(s))-l,f>0&&(u+=f*f),f=Math.abs(n.dot(o))-c,f>0&&(u+=f*f),u}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,l=a.getColumn(0,vl),c=a.getColumn(1,_l),u=a.getColumn(2,wl),f=ED.copy(l).add(c).add(u).add(o),h=TD.copy(f).subtract(e);let d=n.dot(h);return i=Math.min(d,i),s=Math.max(d,s),f.copy(o).add(l).add(c).subtract(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),f.copy(o).add(l).subtract(c).add(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),f.copy(o).add(l).subtract(c).subtract(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),o.copy(f).subtract(l).add(c).add(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),o.copy(f).subtract(l).add(c).subtract(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),o.copy(f).subtract(l).subtract(c).add(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),o.copy(f).subtract(l).subtract(c).subtract(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,vl);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,_l);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,wl);return i.transformAsPoint(e),this.halfAxes=new je([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const Iv=new F,Rv=new F;class ys{constructor(e=[0,0,1],n=0){g(this,"normal",void 0),g(this,"distance",void 0),this.normal=new F,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return Yo(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=Iv.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),Yo(_n(this.normal.len(),1)),this.distance=i,this}clone(){return new ys(this.normal,this.distance)}equals(e){return _n(this.distance,e.distance)&&_n(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=Rv.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=Iv.from(e);const r=this.getPointDistance(e),i=Rv.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const Ov=[new F([1,0,0]),new F([0,1,0]),new F([0,0,1])],kv=new F,xD=new F;new ys(new F(1,0,0),0);class On{constructor(e=[]){g(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*Ov.length;const n=e.center,r=e.radius;let i=0;for(const s of Ov){let o=this.planes[i],a=this.planes[i+1];o||(o=this.planes[i]=new ys),a||(a=this.planes[i+1]=new ys);const l=kv.copy(s).scale(-r).add(n);-s.dot(l),o.fromPointNormal(l,s);const c=kv.copy(s).scale(r).add(n),u=xD.copy(s).negate();-u.dot(c),a.fromPointNormal(c,u),i+=2}return this}computeVisibility(e){let n=Ze.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case Ze.OUTSIDE:return Ze.OUTSIDE;case Ze.INTERSECTING:n=Ze.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(Yo(Number.isFinite(n),"parentPlaneMask is required."),n===On.MASK_OUTSIDE||n===On.MASK_INSIDE)return n;let r=On.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const o=s<31?1<<s:0;if(s<31&&!(n&o))continue;const a=i[s],l=e.intersectPlane(a);if(l===Ze.OUTSIDE)return On.MASK_OUTSIDE;l===Ze.INTERSECTING&&(r|=o)}return r}}g(On,"MASK_OUTSIDE",4294967295);g(On,"MASK_INSIDE",0);g(On,"MASK_INDETERMINATE",2147483647);new F;new F;new F;new F;new F;new F;new F;new F;new F;new F;new F;new F;new F;new F;new F;new F;new F;const fn=new je,bD=new je,SD=new je,El=new je,Nv=new je;function PD(t,e={}){const n=xE.EPSILON20,r=10;let i=0,s=0;const o=bD,a=SD;o.identity(),a.copy(t);const l=n*AD(a);for(;s<r&&CD(a)>l;)LD(a,El),Nv.copy(El).transpose(),a.multiplyRight(El),a.multiplyLeft(Nv),o.multiplyRight(El),++i>2&&(++s,i=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function AD(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const Pd=[1,0,0],Ad=[2,2,1];function CD(t){let e=0;for(let n=0;n<3;++n){const r=t[fn.getElementIndex(Ad[n],Pd[n])];e+=2*r*r}return Math.sqrt(e)}function LD(t,e){const n=xE.EPSILON15;let r=0,i=1;for(let c=0;c<3;++c){const u=Math.abs(t[fn.getElementIndex(Ad[c],Pd[c])]);u>r&&(i=c,r=u)}const s=Pd[i],o=Ad[i];let a=1,l=0;if(Math.abs(t[fn.getElementIndex(o,s)])>n){const c=t[fn.getElementIndex(o,o)],u=t[fn.getElementIndex(s,s)],f=t[fn.getElementIndex(o,s)],h=(c-u)/2/f;let d;h<0?d=-1/(-h+Math.sqrt(1+h*h)):d=1/(h+Math.sqrt(1+h*h)),a=1/Math.sqrt(1+d*d),l=d*a}return je.IDENTITY.to(e),e[fn.getElementIndex(s,s)]=e[fn.getElementIndex(o,o)]=a,e[fn.getElementIndex(o,s)]=l,e[fn.getElementIndex(s,o)]=-l,e}const nr=new F,MD=new F,ID=new F,RD=new F,OD=new F,kD=new je,ND={diagonal:new je,unitary:new je};function FD(t,e=new pp){if(!t||t.length===0)return e.halfAxes=new je([0,0,0,0,0,0,0,0,0]),e.center=new F,e;const n=t.length,r=new F(0,0,0);for(const O of t)r.add(O);const i=1/n;r.multiplyByScalar(i);let s=0,o=0,a=0,l=0,c=0,u=0;for(const O of t){const I=nr.copy(O).subtract(r);s+=I.x*I.x,o+=I.x*I.y,a+=I.x*I.z,l+=I.y*I.y,c+=I.y*I.z,u+=I.z*I.z}s*=i,o*=i,a*=i,l*=i,c*=i,u*=i;const f=kD;f[0]=s,f[1]=o,f[2]=a,f[3]=o,f[4]=l,f[5]=c,f[6]=a,f[7]=c,f[8]=u;const{unitary:h}=PD(f,ND),d=e.halfAxes.copy(h);let p=d.getColumn(0,ID),m=d.getColumn(1,RD),T=d.getColumn(2,OD),v=-Number.MAX_VALUE,y=-Number.MAX_VALUE,w=-Number.MAX_VALUE,x=Number.MAX_VALUE,S=Number.MAX_VALUE,P=Number.MAX_VALUE;for(const O of t)nr.copy(O),v=Math.max(nr.dot(p),v),y=Math.max(nr.dot(m),y),w=Math.max(nr.dot(T),w),x=Math.min(nr.dot(p),x),S=Math.min(nr.dot(m),S),P=Math.min(nr.dot(T),P);p=p.multiplyByScalar(.5*(x+v)),m=m.multiplyByScalar(.5*(S+y)),T=T.multiplyByScalar(.5*(P+w)),e.center.copy(p).add(m).add(T);const C=MD.set(v-x,y-S,w-P).multiplyByScalar(.5),M=new je([C[0],0,0,0,C[1],0,0,0,C[2]]);return e.halfAxes.multiplyRight(M),e}const $i=512,Fv=3,bT=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],ST=bT.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),DD=ST.concat([[.25,.5],[.75,.5]]);class Xi{constructor(e,n,r){g(this,"x",void 0),g(this,"y",void 0),g(this,"z",void 0),g(this,"childVisible",void 0),g(this,"selected",void 0),g(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new Xi(e,n,r),new Xi(e,n+1,r),new Xi(e+1,n,r),new Xi(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:s,maxZ:o,bounds:a,offset:l,project:c}=e,u=this.getBoundingVolume(i,l,c);if(a&&!this.insideBounds(a)||r.computeVisibility(u)<0)return!1;if(!this.childVisible){let{z:h}=this;if(h<o&&h>=s){const d=u.distanceTo(n.cameraPosition)*n.scale/n.height;h+=Math.floor(Math.log2(d))}if(h>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const h of this.children)h.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const s=Math.pow(2,this.z),o=$i/s;return this.x*o<r&&this.y*o<i&&(this.x+1)*o>e&&(this.y+1)*o>n}getBoundingVolume(e,n,r){if(r){const l=this.z<1?DD:this.z<2?ST:bT,c=[];for(const u of l){const f=Cd(this.x+u[0],this.y+u[1],this.z);f[2]=e[0],c.push(r(f)),e[0]!==e[1]&&(f[2]=e[1],c.push(r(f)))}return FD(c)}const i=Math.pow(2,this.z),s=$i/i,o=this.x*s+n*$i,a=$i-(this.y+1)*s;return new dp([o,a,e[0]],[o+s,a+s,e[1]])}}function zD(t,e,n,r){const i=t instanceof p4&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:d,distance:p})=>new ys(d.clone().negate(),p)),o=new On(s),a=t.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,c=n&&n[1]*a||0,u=t instanceof En&&t.pitch<=60?e:0;if(r){const[d,p,m,T]=r,v=br([d,T]),y=br([m,p]);r=[v[0],$i-v[1],y[0],$i-y[1]]}const f=new Xi(0,0,0),h={viewport:t,project:i,cullingVolume:o,elevationBounds:[l,c],minZ:u,maxZ:e,bounds:r,offset:0};if(f.update(h),t instanceof En&&t.subViewports&&t.subViewports.length>1){for(h.offset=-1;f.update(h)&&!(--h.offset<-Fv););for(h.offset=1;f.update(h)&&!(++h.offset>Fv););}return f.getSelected()}const Wn=512,UD=[-1/0,-1/0,1/0,1/0],BD={type:"url",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equals:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function PT(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function VD(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function jD(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const s=VD(r)%t.length;t=t[s]}let i=t;for(const s of Object.keys(n)){const o=new RegExp("{".concat(s,"}"),"g");i=i.replace(o,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function GD(t,e,n){let r;if(e&&e.length===2){const[i,s]=e,o=t.getBounds({z:i}),a=t.getBounds({z:s});r=[Math.min(o[0],a[0]),Math.min(o[1],a[1]),Math.max(o[2],a[2]),Math.max(o[3],a[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function Vc({viewport:t,z:e,cullRect:n}){const r=n.x-t.x,i=n.y-t.y,{width:s,height:o}=n;if(!Array.isArray(e)){const c={targetZ:e||0},u=t.unproject([r,i],c),f=t.unproject([r+s,i],c),h=t.unproject([r,i+o],c),d=t.unproject([r+s,i+o],c);return[Math.min(u[0],f[0],h[0],d[0]),Math.min(u[1],f[1],h[1],d[1]),Math.max(u[0],f[0],h[0],d[0]),Math.max(u[1],f[1],h[1],d[1])]}const a=Vc({viewport:t,z:e[0],cullRect:n}),l=Vc({viewport:t,z:e[1],cullRect:n});return[Math.min(a[0],l[0]),Math.min(a[1],l[1]),Math.max(a[2],l[2]),Math.max(a[3],l[3])]}function WD(t,e,n){return n?PT(t,n).map(i=>i*e/Wn):t.map(r=>r*e/Wn)}function mp(t,e){return Math.pow(2,t)*Wn/e}function Cd(t,e,n){const r=mp(n,Wn),i=t/r*360-180,s=Math.PI-2*Math.PI*e/r,o=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,o]}function Dv(t,e,n,r){const i=mp(n,r);return[t/i*Wn,e/i*Wn]}function HD(t,e,n,r,i=Wn){if(t.isGeospatial){const[c,u]=Cd(e,n,r),[f,h]=Cd(e+1,n+1,r);return{west:c,north:u,east:f,south:h}}const[s,o]=Dv(e,n,r,i),[a,l]=Dv(e+1,n+1,r,i);return{left:s,top:o,right:a,bottom:l}}function $D(t,e,n,r,i){const s=GD(t,null,r),o=mp(e,n),[a,l,c,u]=WD(s,o,i),f=[];for(let h=Math.floor(a);h<c;h++)for(let d=Math.floor(l);d<u;d++)f.push({x:h,y:d,z:e});return f}function XD({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:s=Wn,modelMatrix:o,modelMatrixInverse:a,zoomOffset:l=0}){let c=t.isGeospatial?Math.round(t.zoom+Math.log2(Wn/s))+l:Math.ceil(t.zoom)+l;if(typeof n=="number"&&Number.isFinite(n)&&c<n){if(!i)return[];c=n}typeof e=="number"&&Number.isFinite(e)&&c>e&&(c=e);let u=i;return o&&a&&i&&!t.isGeospatial&&(u=PT(i,o)),t.isGeospatial?zD(t,c,r,i):$D(t,c,s,u||UD,a)}const zv=1,Tu=2,YD="never",qD="no-overlap",yp="best-available",ZD=5,KD={[yp]:JD,[qD]:ez,[YD]:()=>{}};class QD{constructor(e){g(this,"opts",void 0),g(this,"_requestScheduler",void 0),g(this,"_cache",void 0),g(this,"_dirty",void 0),g(this,"_tiles",void 0),g(this,"_cacheByteSize",void 0),g(this,"_viewport",void 0),g(this,"_zRange",void 0),g(this,"_selectedTiles",void 0),g(this,"_frameNumber",void 0),g(this,"_modelMatrix",void 0),g(this,"_modelMatrixInverse",void 0),g(this,"_maxZoom",void 0),g(this,"_minZoom",void 0),g(this,"onTileLoad",void 0),g(this,"_getCullBounds",ya(Vc)),this.opts=e,this.onTileLoad=n=>{this.opts.onTileLoad(n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new D2({maxRequests:e.maxRequests,throttleRequests:e.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Je,this._modelMatrixInverse=new Je,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new Je(r),s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!_n(this._zRange,n)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(l=>this._getTile(l,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const[r,i,s,o]=Vc({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:a}=e;if("west"in a)return a.west<s&&a.east>r&&a.south<o&&a.north>i;const l=Math.min(a.top,a.bottom),c=Math.max(a.top,a.bottom);return a.left<s&&a.right>r&&l<o&&c>i}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:o}){const{tileSize:a,extent:l,zoomOffset:c}=this.opts;return XD({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:a,extent:l,modelMatrix:s,modelMatrixInverse:o,zoomOffset:c})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:HD(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||yp,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:KD[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:ZD*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[o,a]of e)if(!a.isVisible&&!a.isSelected&&(this._cacheByteSize-=n.maxCacheByteSize?a.byteLength:0,e.delete(o),this.opts.onTileUnload(a)),e.size<=r&&this._cacheByteSize<=i)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((o,a)=>o.zoom-a.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),s=!1;return!i&&n?(i=new yD(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function JD(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!AT(e)&&vp(e);for(const e of t)e.isVisible=Boolean(e.state&Tu)}function ez(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&AT(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=Boolean(n.state&Tu),n.children&&(n.isVisible||n.state&zv))for(const r of n.children)r.state=zv;else n.isSelected&&vp(n)}function AT(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=Tu,!0;e=e.parent}return!1}function vp(t){for(const e of t.children)e.isLoaded||e.content?e.state|=Tu:vp(e)}const tz={TilesetClass:QD,data:{type:"data",value:[]},dataComparator:BD.equals,renderSubLayers:{type:"function",value:t=>new hp(t),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:t=>console.error(t),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:yp,zRange:null,maxRequests:6,zoomOffset:0};class _p extends vu{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0?void 0:n.selectedTiles.every(r=>r.isLoaded&&r.layers&&r.layers.every(i=>i.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:s,maxZoom:o,minZoom:a,maxRequests:l,zoomOffset:c}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:o,minZoom:a,tileSize:e,refinementStrategy:i,extent:s,maxRequests:l,zoomOffset:c,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:s}=e,o=this.state.isLoaded!==s,a=this.state.frameNumber!==i;s&&(o||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?jD(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){return e.picked&&(e.tile=n.props.tile),e}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(e.id),data:e.content,_offset:0,tile:e});e.layers=gu(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}g(_p,"defaultProps",tz);g(_p,"layerName","TileLayer");const nz=typeof window<"u"?J.useLayoutEffect:J.useEffect,rz=nz;function jc(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const iz={position:"absolute",zIndex:-1};function CT(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>CT(n,e));if(xu(t)){if(sz(t))return e.style=iz,J.cloneElement(t,e);if(oz(t))return J.cloneElement(t,e)}return t}function xu(t){return t&&typeof t=="object"&&"type"in t||!1}function sz(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function oz(t){const e=t.type;return e&&e.deckGLViewProps}function Ld(t){if(typeof t=="function")return J.createElement(ei,{},t);if(Array.isArray(t))return t.map(Ld);if(xu(t)){if(t.type===J.Fragment)return Ld(t.props.children);if(jc(t.type,ei))return t}return t}function az({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return J.Children.forEach(Ld(t),o=>{if(xu(o)){const a=o.type;if(jc(a,nn)){const l=lz(a,o.props);i.push(l)}else r.push(o);if(jc(a,ei)&&a!==ei&&o.props.id){const l=new a(o.props);s[l.id]=l}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function lz(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function cz({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,l=o;xu(o)&&jc(o.type,ei)&&(a=o.props.id||s,l=o.props.children);const c=r.getViewport(a),u=r.getViewState(a);if(c){u.padding=c.padding;const{x:f,y:h,width:d,height:p}=c;l=CT(l,{x:f,y:h,width:d,height:p,viewport:c,viewState:u}),i[a]||(i[a]={viewport:c,children:[]}),i[a].children.push(l)}}return Object.keys(i).map(o=>{const{viewport:a,children:l}=i[o],{x:c,y:u,width:f,height:h}=a,d={position:"absolute",left:c,top:u,width:f,height:h},p="view-".concat(o),m=J.createElement("div",{key:p,id:p,style:d},...l);if(n){const T={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:v=>{v.viewId=o,e._onViewStateChange(v)}};return J.createElement(n,{key:p,value:T},m)}return m})}const uz={mixBlendMode:null};function fz({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in uz?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function hz(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function LT(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function dz(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():LT(t)}});return r}const MT=J.forwardRef((t,e)=>{const[n,r]=J.useState(0),s=J.useRef({control:null,version:n,forceUpdate:()=>r(S=>S+1)}).current,o=J.useRef(null),a=J.useRef(null),l=J.useMemo(()=>az(t),[t.layers,t.views,t.children]);let c=!0;const u=S=>{var P;return c&&t.viewState?(s.viewStateUpdateRequested=S,null):(s.viewStateUpdateRequested=null,(P=t.onViewStateChange)===null||P===void 0?void 0:P.call(t,S))},f=S=>{if(c)s.interactionStateUpdateRequested=S;else{var P;s.interactionStateUpdateRequested=null,(P=t.onInteractionStateChange)===null||P===void 0||P.call(t,S)}},h=J.useMemo(()=>{const S={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:f};return delete S._customRender,s.deck&&s.deck.setProps(S),S},[t]);J.useEffect(()=>{const S=t.Deck||mu;return s.deck=dz(s,S,{...h,parent:o.current,canvas:a.current}),()=>{var P;return(P=s.deck)===null||P===void 0?void 0:P.finalize()}},[]),rz(()=>{LT(s);const{viewStateUpdateRequested:S,interactionStateUpdateRequested:P}=s;S&&u(S),P&&f(P)}),J.useImperativeHandle(e,()=>hz(s),[]);const d=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:p,width:m,height:T,id:v,style:y}=t,{containerStyle:w,canvasStyle:x}=J.useMemo(()=>fz({width:m,height:T,style:y}),[m,T,y]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===d||s.version!==n){s.lastRenderedViewports=d,s.version=n;const S=cz({children:l.children,deck:s.deck,ContextProvider:p}),P=J.createElement("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:a,style:x});s.control=J.createElement("div",{id:"".concat(v||"deckgl","-wrapper"),ref:o,style:w},[P,S])}return c=!1,s.control});MT.defaultProps=mu.defaultProps;const gz=MT;function pz(){return new _p({id:"osm-layer",data:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png","https://c.tile.openstreetmap.org/{z}/{x}/{y}.png"],maxRequests:20,minZoom:0,maxZoom:19,tileSize:256,renderSubLayers:t=>{const{bbox:{west:e,south:n,east:r,north:i}}=t.tile;return new ip(t,{data:null,image:t.data,bounds:[e,n,r,i]})}})}const IT={RGBA:[37,165,154,255],HEX:"#25A59A"},mz={RGBA:[97,97,97,200],HEX:"#616161"},yz=()=>[new sp({id:"line-layer",data:{},pickable:!0,getWidth:2,getSourcePosition:t=>t.from,getTargetPosition:t=>t.to,getColor:t=>IT.RGBA})];function vz(){const t={initialViewState:{latitude:59.926,longitude:30.387,bearing:0,pitch:45,zoom:16,maxPitch:85,minPitch:-85},views:[new Qg({repeat:!1,nearZMultiplier:.01})],layers:[pz(),yz()],controller:{doubleClickZoom:!1,touchRotate:!0,scrollZoom:{speed:.005}}};return Zt("div",{onContextMenu:e=>e.preventDefault(),onMouseDown:e=>e.preventDefault(),children:Zt(gz,{...t})})}function Le(){return Le=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Le.apply(this,arguments)}function Li(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function RT(t){if(!Li(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=RT(t[n])}),e}function Nn(t,e,n={clone:!0}){const r=n.clone?Le({},t):t;return Li(t)&&Li(e)&&Object.keys(e).forEach(i=>{i!=="__proto__"&&(Li(e[i])&&i in t&&Li(t[i])?r[i]=Nn(t[i],e[i],n):n.clone?r[i]=Li(e[i])?RT(e[i]):e[i]:r[i]=e[i])}),r}function vs(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function OT(t){if(typeof t!="string")throw new Error(vs(7));return t.charAt(0).toUpperCase()+t.slice(1)}function Ps(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function _z(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function wz(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Ez=function(){function t(n){var r=this;this._insertTag=function(i){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,s),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(wz(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=_z(i);try{s.insertRule(r,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),Ye="-ms-",Gc="-moz-",Q="-webkit-",kT="comm",wp="rule",Ep="decl",Tz="@import",NT="@keyframes",xz=Math.abs,bu=String.fromCharCode,bz=Object.assign;function Sz(t,e){return Be(t,0)^45?(((e<<2^Be(t,0))<<2^Be(t,1))<<2^Be(t,2))<<2^Be(t,3):0}function FT(t){return t.trim()}function Pz(t,e){return(t=e.exec(t))?t[0]:t}function ee(t,e,n){return t.replace(e,n)}function Md(t,e){return t.indexOf(e)}function Be(t,e){return t.charCodeAt(e)|0}function na(t,e,n){return t.slice(e,n)}function dn(t){return t.length}function Tp(t){return t.length}function Tl(t,e){return e.push(t),t}function Az(t,e){return t.map(e).join("")}var Su=1,_s=1,DT=0,pt=0,Pe=0,As="";function Pu(t,e,n,r,i,s,o){return{value:t,root:e,parent:n,type:r,props:i,children:s,line:Su,column:_s,length:o,return:""}}function eo(t,e){return bz(Pu("",null,null,"",null,null,0),t,{length:-t.length},e)}function Cz(){return Pe}function Lz(){return Pe=pt>0?Be(As,--pt):0,_s--,Pe===10&&(_s=1,Su--),Pe}function St(){return Pe=pt<DT?Be(As,pt++):0,_s++,Pe===10&&(_s=1,Su++),Pe}function wn(){return Be(As,pt)}function ql(){return pt}function wa(t,e){return na(As,t,e)}function ra(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function zT(t){return Su=_s=1,DT=dn(As=t),pt=0,[]}function UT(t){return As="",t}function Zl(t){return FT(wa(pt-1,Id(t===91?t+2:t===40?t+1:t)))}function Mz(t){for(;(Pe=wn())&&Pe<33;)St();return ra(t)>2||ra(Pe)>3?"":" "}function Iz(t,e){for(;--e&&St()&&!(Pe<48||Pe>102||Pe>57&&Pe<65||Pe>70&&Pe<97););return wa(t,ql()+(e<6&&wn()==32&&St()==32))}function Id(t){for(;St();)switch(Pe){case t:return pt;case 34:case 39:t!==34&&t!==39&&Id(Pe);break;case 40:t===41&&Id(t);break;case 92:St();break}return pt}function Rz(t,e){for(;St()&&t+Pe!==47+10;)if(t+Pe===42+42&&wn()===47)break;return"/*"+wa(e,pt-1)+"*"+bu(t===47?t:St())}function Oz(t){for(;!ra(wn());)St();return wa(t,pt)}function kz(t){return UT(Kl("",null,null,null,[""],t=zT(t),0,[0],t))}function Kl(t,e,n,r,i,s,o,a,l){for(var c=0,u=0,f=o,h=0,d=0,p=0,m=1,T=1,v=1,y=0,w="",x=i,S=s,P=r,C=w;T;)switch(p=y,y=St()){case 40:if(p!=108&&Be(C,f-1)==58){Md(C+=ee(Zl(y),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:C+=Zl(y);break;case 9:case 10:case 13:case 32:C+=Mz(p);break;case 92:C+=Iz(ql()-1,7);continue;case 47:switch(wn()){case 42:case 47:Tl(Nz(Rz(St(),ql()),e,n),l);break;default:C+="/"}break;case 123*m:a[c++]=dn(C)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:T=0;case 59+u:d>0&&dn(C)-f&&Tl(d>32?Bv(C+";",r,n,f-1):Bv(ee(C," ","")+";",r,n,f-2),l);break;case 59:C+=";";default:if(Tl(P=Uv(C,e,n,c,u,i,a,w,x=[],S=[],f),s),y===123)if(u===0)Kl(C,e,P,P,x,s,f,a,S);else switch(h===99&&Be(C,3)===110?100:h){case 100:case 109:case 115:Kl(t,P,P,r&&Tl(Uv(t,P,P,0,0,i,a,w,i,x=[],f),S),i,S,f,a,r?x:S);break;default:Kl(C,P,P,P,[""],S,0,a,S)}}c=u=d=0,m=v=1,w=C="",f=o;break;case 58:f=1+dn(C),d=p;default:if(m<1){if(y==123)--m;else if(y==125&&m++==0&&Lz()==125)continue}switch(C+=bu(y),y*m){case 38:v=u>0?1:(C+="\f",-1);break;case 44:a[c++]=(dn(C)-1)*v,v=1;break;case 64:wn()===45&&(C+=Zl(St())),h=wn(),u=f=dn(w=C+=Oz(ql())),y++;break;case 45:p===45&&dn(C)==2&&(m=0)}}return s}function Uv(t,e,n,r,i,s,o,a,l,c,u){for(var f=i-1,h=i===0?s:[""],d=Tp(h),p=0,m=0,T=0;p<r;++p)for(var v=0,y=na(t,f+1,f=xz(m=o[p])),w=t;v<d;++v)(w=FT(m>0?h[v]+" "+y:ee(y,/&\f/g,h[v])))&&(l[T++]=w);return Pu(t,e,n,i===0?wp:a,l,c,u)}function Nz(t,e,n){return Pu(t,e,n,kT,bu(Cz()),na(t,2,-2),0)}function Bv(t,e,n,r){return Pu(t,e,n,Ep,na(t,0,r),na(t,r+1,-1),r)}function rs(t,e){for(var n="",r=Tp(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function Fz(t,e,n,r){switch(t.type){case Tz:case Ep:return t.return=t.return||t.value;case kT:return"";case NT:return t.return=t.value+"{"+rs(t.children,r)+"}";case wp:t.value=t.props.join(",")}return dn(n=rs(t.children,r))?t.return=t.value+"{"+n+"}":""}function Dz(t){var e=Tp(t);return function(n,r,i,s){for(var o="",a=0;a<e;a++)o+=t[a](n,r,i,s)||"";return o}}function zz(t){return function(e){e.root||(e=e.return)&&t(e)}}var Uz=function(e,n,r){for(var i=0,s=0;i=s,s=wn(),i===38&&s===12&&(n[r]=1),!ra(s);)St();return wa(e,pt)},Bz=function(e,n){var r=-1,i=44;do switch(ra(i)){case 0:i===38&&wn()===12&&(n[r]=1),e[r]+=Uz(pt-1,n,r);break;case 2:e[r]+=Zl(i);break;case 4:if(i===44){e[++r]=wn()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=bu(i)}while(i=St());return e},Vz=function(e,n){return UT(Bz(zT(e),n))},Vv=new WeakMap,jz=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!Vv.get(r))&&!i){Vv.set(e,!0);for(var s=[],o=Vz(n,s),a=r.props,l=0,c=0;l<o.length;l++)for(var u=0;u<a.length;u++,c++)e.props[c]=s[l]?o[l].replace(/&\f/g,a[u]):a[u]+" "+o[l]}}},Gz=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function BT(t,e){switch(Sz(t,e)){case 5103:return Q+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Q+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Q+t+Gc+t+Ye+t+t;case 6828:case 4268:return Q+t+Ye+t+t;case 6165:return Q+t+Ye+"flex-"+t+t;case 5187:return Q+t+ee(t,/(\w+).+(:[^]+)/,Q+"box-$1$2"+Ye+"flex-$1$2")+t;case 5443:return Q+t+Ye+"flex-item-"+ee(t,/flex-|-self/,"")+t;case 4675:return Q+t+Ye+"flex-line-pack"+ee(t,/align-content|flex-|-self/,"")+t;case 5548:return Q+t+Ye+ee(t,"shrink","negative")+t;case 5292:return Q+t+Ye+ee(t,"basis","preferred-size")+t;case 6060:return Q+"box-"+ee(t,"-grow","")+Q+t+Ye+ee(t,"grow","positive")+t;case 4554:return Q+ee(t,/([^-])(transform)/g,"$1"+Q+"$2")+t;case 6187:return ee(ee(ee(t,/(zoom-|grab)/,Q+"$1"),/(image-set)/,Q+"$1"),t,"")+t;case 5495:case 3959:return ee(t,/(image-set\([^]*)/,Q+"$1$`$1");case 4968:return ee(ee(t,/(.+:)(flex-)?(.*)/,Q+"box-pack:$3"+Ye+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Q+t+t;case 4095:case 3583:case 4068:case 2532:return ee(t,/(.+)-inline(.+)/,Q+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(dn(t)-1-e>6)switch(Be(t,e+1)){case 109:if(Be(t,e+4)!==45)break;case 102:return ee(t,/(.+:)(.+)-([^]+)/,"$1"+Q+"$2-$3$1"+Gc+(Be(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Md(t,"stretch")?BT(ee(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Be(t,e+1)!==115)break;case 6444:switch(Be(t,dn(t)-3-(~Md(t,"!important")&&10))){case 107:return ee(t,":",":"+Q)+t;case 101:return ee(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Q+(Be(t,14)===45?"inline-":"")+"box$3$1"+Q+"$2$3$1"+Ye+"$2box$3")+t}break;case 5936:switch(Be(t,e+11)){case 114:return Q+t+Ye+ee(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Q+t+Ye+ee(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Q+t+Ye+ee(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Q+t+Ye+t+t}return t}var Wz=function(e,n,r,i){if(e.length>-1&&!e.return)switch(e.type){case Ep:e.return=BT(e.value,e.length);break;case NT:return rs([eo(e,{value:ee(e.value,"@","@"+Q)})],i);case wp:if(e.length)return Az(e.props,function(s){switch(Pz(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return rs([eo(e,{props:[ee(s,/:(read-\w+)/,":"+Gc+"$1")]})],i);case"::placeholder":return rs([eo(e,{props:[ee(s,/:(plac\w+)/,":"+Q+"input-$1")]}),eo(e,{props:[ee(s,/:(plac\w+)/,":"+Gc+"$1")]}),eo(e,{props:[ee(s,/:(plac\w+)/,Ye+"input-$1")]})],i)}return""})}},Hz=[Wz],$z=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(m){var T=m.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var i=e.stylisPlugins||Hz,s={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(m){for(var T=m.getAttribute("data-emotion").split(" "),v=1;v<T.length;v++)s[T[v]]=!0;a.push(m)});var l,c=[jz,Gz];{var u,f=[Fz,zz(function(m){u.insert(m)})],h=Dz(c.concat(i,f)),d=function(T){return rs(kz(T),h)};l=function(T,v,y,w){u=y,d(T?T+"{"+v.styles+"}":v.styles),w&&(p.inserted[v.name]=!0)}}var p={key:n,sheet:new Ez({key:n,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:l};return p.sheet.hydrate(a),p},Xz=J.createContext(typeof HTMLElement<"u"?$z({key:"css"}):null);Xz.Provider;var Yz=J.createContext({});function Po(t,e){return e?Nn(t,e,{clone:!1}):t}const xp={xs:0,sm:600,md:900,lg:1200,xl:1536},jv={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${xp[t]}px)`};function Hn(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const s=r.breakpoints||jv;return e.reduce((o,a,l)=>(o[s.up(s.keys[l])]=n(e[l]),o),{})}if(typeof e=="object"){const s=r.breakpoints||jv;return Object.keys(e).reduce((o,a)=>{if(Object.keys(s.values||xp).indexOf(a)!==-1){const l=s.up(a);o[l]=n(e[a],a)}else{const l=a;o[l]=e[l]}return o},{})}return n(e)}function qz(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,i)=>{const s=t.up(i);return r[s]={},r},{}))||{}}function Zz(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function Au(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,s)=>i&&i[s]?i[s]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function Wc(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=Au(t,n)||r,e&&(i=e(i,r,t)),i}function te(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,s=o=>{if(o[e]==null)return null;const a=o[e],l=o.theme,c=Au(l,r)||{};return Hn(o,a,f=>{let h=Wc(c,i,f);return f===h&&typeof f=="string"&&(h=Wc(c,i,`${e}${f==="default"?"":OT(f)}`,f)),n===!1?h:{[n]:h}})};return s.propTypes={},s.filterProps=[e],s}function Cu(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(s=>{r[s]=i}),r),{}),n=r=>Object.keys(r).reduce((i,s)=>e[s]?Po(i,e[s](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Kz(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const Qz={m:"margin",p:"padding"},Jz={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Gv={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},e6=Kz(t=>{if(t.length>2)if(Gv[t])t=Gv[t];else return[t];const[e,n]=t.split(""),r=Qz[e],i=Jz[n]||"";return Array.isArray(i)?i.map(s=>r+s):[r+i]}),bp=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Sp=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...bp,...Sp];function Ea(t,e,n,r){var i;const s=(i=Au(t,e,!1))!=null?i:n;return typeof s=="number"?o=>typeof o=="string"?o:s*o:Array.isArray(s)?o=>typeof o=="string"?o:s[o]:typeof s=="function"?s:()=>{}}function VT(t){return Ea(t,"spacing",8)}function Ta(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function t6(t,e){return n=>t.reduce((r,i)=>(r[i]=Ta(e,n),r),{})}function n6(t,e,n,r){if(e.indexOf(n)===-1)return null;const i=e6(n),s=t6(i,r),o=t[n];return Hn(t,o,s)}function jT(t,e){const n=VT(t.theme);return Object.keys(t).map(r=>n6(t,e,r,n)).reduce(Po,{})}function we(t){return jT(t,bp)}we.propTypes={};we.filterProps=bp;function Ee(t){return jT(t,Sp)}Ee.propTypes={};Ee.filterProps=Sp;function mn(t){return typeof t!="number"?t:`${t}px solid`}const r6=te({prop:"border",themeKey:"borders",transform:mn}),i6=te({prop:"borderTop",themeKey:"borders",transform:mn}),s6=te({prop:"borderRight",themeKey:"borders",transform:mn}),o6=te({prop:"borderBottom",themeKey:"borders",transform:mn}),a6=te({prop:"borderLeft",themeKey:"borders",transform:mn}),l6=te({prop:"borderColor",themeKey:"palette"}),c6=te({prop:"borderTopColor",themeKey:"palette"}),u6=te({prop:"borderRightColor",themeKey:"palette"}),f6=te({prop:"borderBottomColor",themeKey:"palette"}),h6=te({prop:"borderLeftColor",themeKey:"palette"}),Lu=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Ea(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Ta(e,r)});return Hn(t,t.borderRadius,n)}return null};Lu.propTypes={};Lu.filterProps=["borderRadius"];Cu(r6,i6,s6,o6,a6,l6,c6,u6,f6,h6,Lu);const Mu=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Ea(t.theme,"spacing",8),n=r=>({gap:Ta(e,r)});return Hn(t,t.gap,n)}return null};Mu.propTypes={};Mu.filterProps=["gap"];const Iu=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Ea(t.theme,"spacing",8),n=r=>({columnGap:Ta(e,r)});return Hn(t,t.columnGap,n)}return null};Iu.propTypes={};Iu.filterProps=["columnGap"];const Ru=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Ea(t.theme,"spacing",8),n=r=>({rowGap:Ta(e,r)});return Hn(t,t.rowGap,n)}return null};Ru.propTypes={};Ru.filterProps=["rowGap"];const d6=te({prop:"gridColumn"}),g6=te({prop:"gridRow"}),p6=te({prop:"gridAutoFlow"}),m6=te({prop:"gridAutoColumns"}),y6=te({prop:"gridAutoRows"}),v6=te({prop:"gridTemplateColumns"}),_6=te({prop:"gridTemplateRows"}),w6=te({prop:"gridTemplateAreas"}),E6=te({prop:"gridArea"});Cu(Mu,Iu,Ru,d6,g6,p6,m6,y6,v6,_6,w6,E6);function is(t,e){return e==="grey"?e:t}const T6=te({prop:"color",themeKey:"palette",transform:is}),x6=te({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:is}),b6=te({prop:"backgroundColor",themeKey:"palette",transform:is});Cu(T6,x6,b6);function Et(t){return t<=1&&t!==0?`${t*100}%`:t}const S6=te({prop:"width",transform:Et}),Pp=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,i,s;return{maxWidth:((r=t.theme)==null||(i=r.breakpoints)==null||(s=i.values)==null?void 0:s[n])||xp[n]||Et(n)}};return Hn(t,t.maxWidth,e)}return null};Pp.filterProps=["maxWidth"];const P6=te({prop:"minWidth",transform:Et}),A6=te({prop:"height",transform:Et}),C6=te({prop:"maxHeight",transform:Et}),L6=te({prop:"minHeight",transform:Et});te({prop:"size",cssProperty:"width",transform:Et});te({prop:"size",cssProperty:"height",transform:Et});const M6=te({prop:"boxSizing"});Cu(S6,Pp,P6,A6,C6,L6,M6);const I6={border:{themeKey:"borders",transform:mn},borderTop:{themeKey:"borders",transform:mn},borderRight:{themeKey:"borders",transform:mn},borderBottom:{themeKey:"borders",transform:mn},borderLeft:{themeKey:"borders",transform:mn},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Lu},color:{themeKey:"palette",transform:is},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:is},backgroundColor:{themeKey:"palette",transform:is},p:{style:Ee},pt:{style:Ee},pr:{style:Ee},pb:{style:Ee},pl:{style:Ee},px:{style:Ee},py:{style:Ee},padding:{style:Ee},paddingTop:{style:Ee},paddingRight:{style:Ee},paddingBottom:{style:Ee},paddingLeft:{style:Ee},paddingX:{style:Ee},paddingY:{style:Ee},paddingInline:{style:Ee},paddingInlineStart:{style:Ee},paddingInlineEnd:{style:Ee},paddingBlock:{style:Ee},paddingBlockStart:{style:Ee},paddingBlockEnd:{style:Ee},m:{style:we},mt:{style:we},mr:{style:we},mb:{style:we},ml:{style:we},mx:{style:we},my:{style:we},margin:{style:we},marginTop:{style:we},marginRight:{style:we},marginBottom:{style:we},marginLeft:{style:we},marginX:{style:we},marginY:{style:we},marginInline:{style:we},marginInlineStart:{style:we},marginInlineEnd:{style:we},marginBlock:{style:we},marginBlockStart:{style:we},marginBlockEnd:{style:we},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Mu},rowGap:{style:Ru},columnGap:{style:Iu},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Et},maxWidth:{style:Pp},minWidth:{transform:Et},height:{transform:Et},maxHeight:{transform:Et},minHeight:{transform:Et},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},Ap=I6;function R6(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function O6(t,e){return typeof t=="function"?t(e):t}function k6(){function t(n,r,i,s){const o={[n]:r,theme:i},a=s[n];if(!a)return{[n]:r};const{cssProperty:l=n,themeKey:c,transform:u,style:f}=a;if(r==null)return null;const h=Au(i,c)||{};return f?f(o):Hn(o,r,p=>{let m=Wc(h,u,p);return p===m&&typeof p=="string"&&(m=Wc(h,u,`${n}${p==="default"?"":OT(p)}`,p)),l===!1?m:{[l]:m}})}function e(n){var r;const{sx:i,theme:s={}}=n||{};if(!i)return null;const o=(r=s.unstable_sxConfig)!=null?r:Ap;function a(l){let c=l;if(typeof l=="function")c=l(s);else if(typeof l!="object")return l;if(!c)return null;const u=qz(s.breakpoints),f=Object.keys(u);let h=u;return Object.keys(c).forEach(d=>{const p=O6(c[d],s);if(p!=null)if(typeof p=="object")if(o[d])h=Po(h,t(d,p,s,o));else{const m=Hn({theme:s},p,T=>({[d]:T}));R6(m,p)?h[d]=e({sx:p,theme:s}):h=Po(h,m)}else h=Po(h,t(d,p,s,o))}),Zz(f,h)}return Array.isArray(i)?i.map(a):a(i)}return e}const GT=k6();GT.filterProps=["sx"];const WT=GT,N6=["values","unit","step"],F6=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>Le({},n,{[r.key]:r.val}),{})};function D6(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=Ps(t,N6),s=F6(e),o=Object.keys(s);function a(h){return`@media (min-width:${typeof e[h]=="number"?e[h]:h}${n})`}function l(h){return`@media (max-width:${(typeof e[h]=="number"?e[h]:h)-r/100}${n})`}function c(h,d){const p=o.indexOf(d);return`@media (min-width:${typeof e[h]=="number"?e[h]:h}${n}) and (max-width:${(p!==-1&&typeof e[o[p]]=="number"?e[o[p]]:d)-r/100}${n})`}function u(h){return o.indexOf(h)+1<o.length?c(h,o[o.indexOf(h)+1]):a(h)}function f(h){const d=o.indexOf(h);return d===0?a(o[1]):d===o.length-1?l(o[d]):c(h,o[o.indexOf(h)+1]).replace("@media","@media not all and")}return Le({keys:o,values:s,up:a,down:l,between:c,only:u,not:f,unit:n},i)}const z6={borderRadius:4},U6=z6;function B6(t=8){if(t.mui)return t;const e=VT({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(s=>{const o=e(s);return typeof o=="number"?`${o}px`:o}).join(" ");return n.mui=!0,n}const V6=["breakpoints","palette","spacing","shape"];function HT(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:s={}}=t,o=Ps(t,V6),a=D6(n),l=B6(i);let c=Nn({breakpoints:a,direction:"ltr",components:{},palette:Le({mode:"light"},r),spacing:l,shape:Le({},U6,s)},o);return c=e.reduce((u,f)=>Nn(u,f),c),c.unstable_sxConfig=Le({},Ap,o==null?void 0:o.unstable_sxConfig),c.unstable_sx=function(f){return WT({sx:f,theme:this})},c}const j6=J.createContext(null),$T=j6;function XT(){return J.useContext($T)}const G6=typeof Symbol=="function"&&Symbol.for,W6=G6?Symbol.for("mui.nested"):"__THEME_NESTED__";function H6(t,e){return typeof e=="function"?e(t):Le({},t,e)}function $6(t){const{children:e,theme:n}=t,r=XT(),i=J.useMemo(()=>{const s=r===null?n:H6(r,n);return s!=null&&(s[W6]=r!==null),s},[n,r]);return Zt($T.Provider,{value:i,children:e})}function X6(t){return Object.keys(t).length===0}function Y6(t=null){const e=XT();return!e||X6(e)?t:e}const q6=HT();function Z6(t=q6){return Y6(t)}function YT(t,e=0,n=1){return Math.min(Math.max(e,t),n)}function K6(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function ws(t){if(t.type)return t;if(t.charAt(0)==="#")return ws(K6(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(vs(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(vs(10,i))}else r=r.split(",");return r=r.map(s=>parseFloat(s)),{type:n,values:r,colorSpace:i}}function Cp(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,s)=>s<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function Q6(t){t=ws(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,s=r*Math.min(i,1-i),o=(c,u=(c+n/30)%12)=>i-s*Math.max(Math.min(u-3,9-u,1),-1);let a="rgb";const l=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return t.type==="hsla"&&(a+="a",l.push(e[3])),Cp({type:a,values:l})}function Wv(t){t=ws(t);let e=t.type==="hsl"||t.type==="hsla"?ws(Q6(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function J6(t,e){const n=Wv(t),r=Wv(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function e5(t,e){if(t=ws(t),e=YT(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return Cp(t)}function t5(t,e){if(t=ws(t),e=YT(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return Cp(t)}const n5={};function r5(t){const e=Z6();return Zt(Yz.Provider,{value:typeof e=="object"?e:n5,children:t.children})}function i5(t){const{children:e,theme:n}=t;return Zt($6,{theme:n,children:Zt(r5,{children:e})})}function s5(t,e){return Le({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}const o5={black:"#000",white:"#fff"},ia=o5,a5={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},l5=a5,c5={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},xi=c5,u5={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},bi=u5,f5={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},to=f5,h5={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Si=h5,d5={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Pi=d5,g5={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Ai=g5,p5=["mode","contrastThreshold","tonalOffset"],Hv={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:ia.white,default:ia.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Zf={text:{primary:ia.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:ia.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function $v(t,e,n,r){const i=r.light||r,s=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=t5(t.main,i):e==="dark"&&(t.dark=e5(t.main,s)))}function m5(t="light"){return t==="dark"?{main:Si[200],light:Si[50],dark:Si[400]}:{main:Si[700],light:Si[400],dark:Si[800]}}function y5(t="light"){return t==="dark"?{main:xi[200],light:xi[50],dark:xi[400]}:{main:xi[500],light:xi[300],dark:xi[700]}}function v5(t="light"){return t==="dark"?{main:bi[500],light:bi[300],dark:bi[700]}:{main:bi[700],light:bi[400],dark:bi[800]}}function _5(t="light"){return t==="dark"?{main:Pi[400],light:Pi[300],dark:Pi[700]}:{main:Pi[700],light:Pi[500],dark:Pi[900]}}function w5(t="light"){return t==="dark"?{main:Ai[400],light:Ai[300],dark:Ai[700]}:{main:Ai[800],light:Ai[500],dark:Ai[900]}}function E5(t="light"){return t==="dark"?{main:to[400],light:to[300],dark:to[700]}:{main:"#ed6c02",light:to[500],dark:to[900]}}function T5(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,i=Ps(t,p5),s=t.primary||m5(e),o=t.secondary||y5(e),a=t.error||v5(e),l=t.info||_5(e),c=t.success||w5(e),u=t.warning||E5(e);function f(m){return J6(m,Zf.text.primary)>=n?Zf.text.primary:Hv.text.primary}const h=({color:m,name:T,mainShade:v=500,lightShade:y=300,darkShade:w=700})=>{if(m=Le({},m),!m.main&&m[v]&&(m.main=m[v]),!m.hasOwnProperty("main"))throw new Error(vs(11,T?` (${T})`:"",v));if(typeof m.main!="string")throw new Error(vs(12,T?` (${T})`:"",JSON.stringify(m.main)));return $v(m,"light",y,r),$v(m,"dark",w,r),m.contrastText||(m.contrastText=f(m.main)),m},d={dark:Zf,light:Hv};return Nn(Le({common:Le({},ia),mode:e,primary:h({color:s,name:"primary"}),secondary:h({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:a,name:"error"}),warning:h({color:u,name:"warning"}),info:h({color:l,name:"info"}),success:h({color:c,name:"success"}),grey:l5,contrastThreshold:n,getContrastText:f,augmentColor:h,tonalOffset:r},d[e]),i)}const x5=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function b5(t){return Math.round(t*1e5)/1e5}const Xv={textTransform:"uppercase"},Yv='"Roboto", "Helvetica", "Arial", sans-serif';function S5(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=Yv,fontSize:i=14,fontWeightLight:s=300,fontWeightRegular:o=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:c=16,allVariants:u,pxToRem:f}=n,h=Ps(n,x5),d=i/14,p=f||(v=>`${v/c*d}rem`),m=(v,y,w,x,S)=>Le({fontFamily:r,fontWeight:v,fontSize:p(y),lineHeight:w},r===Yv?{letterSpacing:`${b5(x/y)}em`}:{},S,u),T={h1:m(s,96,1.167,-1.5),h2:m(s,60,1.2,-.5),h3:m(o,48,1.167,0),h4:m(o,34,1.235,.25),h5:m(o,24,1.334,0),h6:m(a,20,1.6,.15),subtitle1:m(o,16,1.75,.15),subtitle2:m(a,14,1.57,.1),body1:m(o,16,1.5,.15),body2:m(o,14,1.43,.15),button:m(a,14,1.75,.4,Xv),caption:m(o,12,1.66,.4),overline:m(o,12,2.66,1,Xv)};return Nn(Le({htmlFontSize:c,pxToRem:p,fontFamily:r,fontSize:i,fontWeightLight:s,fontWeightRegular:o,fontWeightMedium:a,fontWeightBold:l},T),h,{clone:!1})}const P5=.2,A5=.14,C5=.12;function he(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${P5})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${A5})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${C5})`].join(",")}const L5=["none",he(0,2,1,-1,0,1,1,0,0,1,3,0),he(0,3,1,-2,0,2,2,0,0,1,5,0),he(0,3,3,-2,0,3,4,0,0,1,8,0),he(0,2,4,-1,0,4,5,0,0,1,10,0),he(0,3,5,-1,0,5,8,0,0,1,14,0),he(0,3,5,-1,0,6,10,0,0,1,18,0),he(0,4,5,-2,0,7,10,1,0,2,16,1),he(0,5,5,-3,0,8,10,1,0,3,14,2),he(0,5,6,-3,0,9,12,1,0,3,16,2),he(0,6,6,-3,0,10,14,1,0,4,18,3),he(0,6,7,-4,0,11,15,1,0,4,20,3),he(0,7,8,-4,0,12,17,2,0,5,22,4),he(0,7,8,-4,0,13,19,2,0,5,24,4),he(0,7,9,-4,0,14,21,2,0,5,26,4),he(0,8,9,-5,0,15,22,2,0,6,28,5),he(0,8,10,-5,0,16,24,2,0,6,30,5),he(0,8,11,-5,0,17,26,2,0,6,32,5),he(0,9,11,-5,0,18,28,2,0,7,34,6),he(0,9,12,-6,0,19,29,2,0,7,36,6),he(0,10,13,-6,0,20,31,3,0,8,38,7),he(0,10,13,-6,0,21,33,3,0,8,40,7),he(0,10,14,-6,0,22,35,3,0,8,42,7),he(0,11,14,-7,0,23,36,3,0,9,44,8),he(0,11,15,-7,0,24,38,3,0,9,46,8)],M5=L5,I5=["duration","easing","delay"],R5={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},O5={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function qv(t){return`${Math.round(t)}ms`}function k5(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function N5(t){const e=Le({},R5,t.easing),n=Le({},O5,t.duration);return Le({getAutoHeightDuration:k5,create:(i=["all"],s={})=>{const{duration:o=n.standard,easing:a=e.easeInOut,delay:l=0}=s;return Ps(s,I5),(Array.isArray(i)?i:[i]).map(c=>`${c} ${typeof o=="string"?o:qv(o)} ${a} ${typeof l=="string"?l:qv(l)}`).join(",")}},t,{easing:e,duration:n})}const F5={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},D5=F5,z5=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function U5(t={},...e){const{mixins:n={},palette:r={},transitions:i={},typography:s={}}=t,o=Ps(t,z5);if(t.vars)throw new Error(vs(18));const a=T5(r),l=HT(t);let c=Nn(l,{mixins:s5(l.breakpoints,n),palette:a,shadows:M5.slice(),typography:S5(a,s),transitions:N5(i),zIndex:Le({},D5)});return c=Nn(c,o),c=e.reduce((u,f)=>Nn(u,f),c),c.unstable_sxConfig=Le({},Ap,o==null?void 0:o.unstable_sxConfig),c.unstable_sx=function(f){return WT({sx:f,theme:this})},c}function B5(){const t=U5({palette:{primary:{main:IT.HEX},secondary:{main:mz.HEX}}});return Zt("div",{className:"App",children:Zt(i5,{theme:t,children:Zt(vz,{})})})}Qf.createRoot(document.getElementById("root")).render(Zt(Vx.StrictMode,{children:Zt(B5,{})}));
